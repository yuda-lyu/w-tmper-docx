/*!
 * w-tmper-docx v1.0.2
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs")):"function"==typeof define&&define.amd?define(["fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-tmper-docx"]=e(t.fs)}(this,function(t){"use strict";var e=Array.isArray,r="object"==typeof global&&global&&global.Object===Object&&global,n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")(),a=i.Symbol,o=Object.prototype,s=o.hasOwnProperty,l=o.toString,u=a?a.toStringTag:void 0;var c=Object.prototype.toString;var f=a?a.toStringTag:void 0;function p(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":f&&f in Object(t)?function(t){var e=s.call(t,u),r=t[u];try{t[u]=void 0;var n=!0}catch(t){}var i=l.call(t);return n&&(e?t[u]=r:delete t[u]),i}(t):function(t){return c.call(t)}(t)}function h(t){return"symbol"==typeof t||function(t){return null!=t&&"object"==typeof t}(t)&&"[object Symbol]"==p(t)}var d=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function g(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var v,y=i["__core-js_shared__"],b=(v=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"";var w=Function.prototype.toString;var E=/^\[object .+?Constructor\]$/,x=Function.prototype,_=Object.prototype,T=x.toString,N=_.hasOwnProperty,S=RegExp("^"+T.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function O(t){if(!g(t)||(e=t,b&&b in e))return!1;var e,r=function(t){if(!g(t))return!1;var e=p(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)?S:E;return r.test(function(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function A(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return O(r)?r:void 0}var C=A(Object,"create");var I=Object.prototype.hasOwnProperty;var D=Object.prototype.hasOwnProperty;function k(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function P(t,e){return t===e||t!=t&&e!=e}function R(t,e){for(var r=t.length;r--;)if(P(t[r][0],e))return r;return-1}k.prototype.clear=function(){this.__data__=C?C(null):{},this.size=0},k.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},k.prototype.get=function(t){var e=this.__data__;if(C){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return I.call(e,t)?e[t]:void 0},k.prototype.has=function(t){var e=this.__data__;return C?void 0!==e[t]:D.call(e,t)},k.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=C&&void 0===e?"__lodash_hash_undefined__":e,this};var L=Array.prototype.splice;function M(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}M.prototype.clear=function(){this.__data__=[],this.size=0},M.prototype.delete=function(t){var e=this.__data__,r=R(e,t);return!(r<0)&&(r==e.length-1?e.pop():L.call(e,r,1),--this.size,!0)},M.prototype.get=function(t){var e=this.__data__,r=R(e,t);return r<0?void 0:e[r][1]},M.prototype.has=function(t){return R(this.__data__,t)>-1},M.prototype.set=function(t,e){var r=this.__data__,n=R(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var U=A(i,"Map");function z(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function j(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}j.prototype.clear=function(){this.size=0,this.__data__={hash:new k,map:new(U||M),string:new k}},j.prototype.delete=function(t){var e=z(this,t).delete(t);return this.size-=e?1:0,e},j.prototype.get=function(t){return z(this,t).get(t)},j.prototype.has=function(t){return z(this,t).has(t)},j.prototype.set=function(t,e){var r=z(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function F(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=t.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(F.Cache||j),r}F.Cache=j;var B,q,H,V=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,X=/\\(\\)?/g,G=(B=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(V,function(t,r,n,i){e.push(n?i.replace(X,"$1"):r||t)}),e},q=F(B,function(t){return 500===H.size&&H.clear(),t}),H=q.cache,q),Z=G;var Y=a?a.prototype:void 0,$=Y?Y.toString:void 0;function W(t){if("string"==typeof t)return t;if(e(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}(t,W)+"";if(h(t))return $?$.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}function Q(t,r){return e(t)?t:function(t,r){if(e(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!h(t))||m.test(t)||!d.test(t)||null!=r&&t in Object(r)}(t,r)?[t]:Z(function(t){return null==t?"":W(t)}(t))}function K(t){if("string"==typeof t||h(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function J(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=Q(e,t)).length;null!=t&&r<n;)t=t[K(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function tt(t){return!(!function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)||""===t)}function et(t){let e=!1;if(tt(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(function(t){return t!=t}(t))return!1;e=!0}return e}var rt=/\s/;var nt=/^\s+/;function it(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}(t)+1).replace(nt,""):t}var at=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,st=/^0o[0-7]+$/i,lt=parseInt;var ut=1/0;function ct(t){return t?(t=function(t){if("number"==typeof t)return t;if(h(t))return NaN;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=it(t);var r=ot.test(t);return r||st.test(t)?lt(t.slice(2),r?2:8):at.test(t)?NaN:+t}(t))===ut||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function ft(t){if(!et(t))return 0;return ct(t)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function pt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ht={exports:{}},dt={},mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";dt.encode=function(t){for(var e,r,n,i,a,o,s,l="",u=0;u<t.length;)i=(e=t.charCodeAt(u++))>>2,a=(3&e)<<4|(r=t.charCodeAt(u++))>>4,o=(15&r)<<2|(n=t.charCodeAt(u++))>>6,s=63&n,isNaN(r)?o=s=64:isNaN(n)&&(s=64),l=l+mt.charAt(i)+mt.charAt(a)+mt.charAt(o)+mt.charAt(s);return l},dt.decode=function(t){var e,r,n,i,a,o,s="",l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)e=mt.indexOf(t.charAt(l++))<<2|(i=mt.indexOf(t.charAt(l++)))>>4,r=(15&i)<<4|(a=mt.indexOf(t.charAt(l++)))>>2,n=(3&a)<<6|(o=mt.indexOf(t.charAt(l++))),s+=String.fromCharCode(e),64!==a&&(s+=String.fromCharCode(r)),64!==o&&(s+=String.fromCharCode(n));return s};var gt={};if(gt.base64=!0,gt.array=!0,gt.string=!0,gt.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,gt.nodebuffer="undefined"!=typeof Buffer,gt.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)gt.blob=!1;else{var vt=new ArrayBuffer(0);try{gt.blob=0===new Blob([vt],{type:"application/zip"}).size}catch(df){try{var yt=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);yt.append(vt),gt.blob=0===yt.getBlob("application/zip").size}catch(mf){gt.blob=!1}}}var bt,wt,Et,xt={},_t={},Tt={},Nt={exports:{}};function St(){return bt||(bt=1,function(t,e){!function(t){function e(t){for(var e=t.length;--e>=0;)t[e]=0}var r=256,n=286,i=30,a=15,o=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),s=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),l=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),u=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=new Array(576);e(c);var f=new Array(60);e(f);var p=new Array(512);e(p);var h=new Array(256);e(h);var d=new Array(29);e(d);var m,g,v,y=new Array(i);function b(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}e(y);var E=function(t){return t<256?p[t]:p[256+(t>>>7)]},x=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},_=function(t,e,r){t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,x(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},T=function(t,e,r){_(t,r[2*e],r[2*e+1])},N=function(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},S=function(t,e,r){var n,i,o=new Array(16),s=0;for(n=1;n<=a;n++)s=s+r[n-1]<<1,o[n]=s;for(i=0;i<=e;i++){var l=t[2*i+1];0!==l&&(t[2*i]=N(o[l]++,l))}},O=function(t){var e;for(e=0;e<n;e++)t.dyn_ltree[2*e]=0;for(e=0;e<i;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},A=function(t){t.bi_valid>8?x(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},C=function(t,e,r,n){var i=2*e,a=2*r;return t[i]<t[a]||t[i]===t[a]&&n[e]<=n[r]},I=function(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&C(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!C(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},D=function(t,e,n){var i,a,l,u,c=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+c++],i+=(255&t.pending_buf[t.sym_buf+c++])<<8,a=t.pending_buf[t.sym_buf+c++],0===i?T(t,a,e):(l=h[a],T(t,l+r+1,e),0!==(u=o[l])&&(a-=d[l],_(t,a,u)),i--,l=E(i),T(t,l,n),0!==(u=s[l])&&(i-=y[l],_(t,i,u)))}while(c<t.sym_next);T(t,256,e)},k=function(t,e){var r,n,i,o=e.dyn_tree,s=e.stat_desc.static_tree,l=e.stat_desc.has_stree,u=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(t.heap[++t.heap_len]=c=r,t.depth[r]=0):o[2*r+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[i]=0,t.opt_len--,l&&(t.static_len-=s[2*i+1]);for(e.max_code=c,r=t.heap_len>>1;r>=1;r--)I(t,o,r);i=u;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],I(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,o[2*i]=o[2*r]+o[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,o[2*r+1]=o[2*n+1]=i,t.heap[1]=i++,I(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,o,s,l,u=e.dyn_tree,c=e.max_code,f=e.stat_desc.static_tree,p=e.stat_desc.has_stree,h=e.stat_desc.extra_bits,d=e.stat_desc.extra_base,m=e.stat_desc.max_length,g=0;for(o=0;o<=a;o++)t.bl_count[o]=0;for(u[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<573;r++)(o=u[2*u[2*(n=t.heap[r])+1]+1]+1)>m&&(o=m,g++),u[2*n+1]=o,n>c||(t.bl_count[o]++,s=0,n>=d&&(s=h[n-d]),l=u[2*n],t.opt_len+=l*(o+s),p&&(t.static_len+=l*(f[2*n+1]+s)));if(0!==g){do{for(o=m-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[m]--,g-=2}while(g>0);for(o=m;0!==o;o--)for(n=t.bl_count[o];0!==n;)(i=t.heap[--r])>c||(u[2*i+1]!==o&&(t.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(t,e),S(o,c,t.bl_count)},P=function(t,e,r){var n,i,a=-1,o=e[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=e[2*(n+1)+1],++s<l&&i===o||(s<u?t.bl_tree[2*i]+=s:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,s=0,a=i,0===o?(l=138,u=3):i===o?(l=6,u=3):(l=7,u=4))},R=function(t,e,r){var n,i,a=-1,o=e[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),n=0;n<=r;n++)if(i=o,o=e[2*(n+1)+1],!(++s<l&&i===o)){if(s<u)do{T(t,i,t.bl_tree)}while(0!=--s);else 0!==i?(i!==a&&(T(t,i,t.bl_tree),s--),T(t,16,t.bl_tree),_(t,s-3,2)):s<=10?(T(t,17,t.bl_tree),_(t,s-3,3)):(T(t,18,t.bl_tree),_(t,s-11,7));s=0,a=i,0===o?(l=138,u=3):i===o?(l=6,u=3):(l=7,u=4)}},L=!1,M=function(t,e,r,n){_(t,0+(n?1:0),3),A(t),x(t,r),x(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},U=function(t,e,n,i){var a,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<r;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),k(t,t.l_desc),k(t,t.d_desc),s=function(t){var e;for(P(t,t.dyn_ltree,t.l_desc.max_code),P(t,t.dyn_dtree,t.d_desc.max_code),k(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*u[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),a=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=a&&(a=o)):a=o=n+5,n+4<=a&&-1!==e?M(t,e,n,i):4===t.strategy||o===a?(_(t,2+(i?1:0),3),D(t,c,f)):(_(t,4+(i?1:0),3),function(t,e,r,n){var i;for(_(t,e-257,5),_(t,r-1,5),_(t,n-4,4),i=0;i<n;i++)_(t,t.bl_tree[2*u[i]+1],3);R(t,t.dyn_ltree,e-1),R(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),D(t,t.dyn_ltree,t.dyn_dtree)),O(t),i&&A(t)},z={_tr_init:function(t){L||(function(){var t,e,r,u,w,E=new Array(16);for(r=0,u=0;u<28;u++)for(d[u]=r,t=0;t<1<<o[u];t++)h[r++]=u;for(h[r-1]=u,w=0,u=0;u<16;u++)for(y[u]=w,t=0;t<1<<s[u];t++)p[w++]=u;for(w>>=7;u<i;u++)for(y[u]=w<<7,t=0;t<1<<s[u]-7;t++)p[256+w++]=u;for(e=0;e<=a;e++)E[e]=0;for(t=0;t<=143;)c[2*t+1]=8,t++,E[8]++;for(;t<=255;)c[2*t+1]=9,t++,E[9]++;for(;t<=279;)c[2*t+1]=7,t++,E[7]++;for(;t<=287;)c[2*t+1]=8,t++,E[8]++;for(S(c,287,E),t=0;t<i;t++)f[2*t+1]=5,f[2*t]=N(t,5);m=new b(c,o,257,n,a),g=new b(f,s,0,i,a),v=new b(new Array(0),l,0,19,7)}(),L=!0),t.l_desc=new w(t.dyn_ltree,m),t.d_desc=new w(t.dyn_dtree,g),t.bl_desc=new w(t.bl_tree,v),t.bi_buf=0,t.bi_valid=0,O(t)},_tr_stored_block:M,_tr_flush_block:U,_tr_tally:function(t,e,n){return t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=n,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(h[n]+r+1)]++,t.dyn_dtree[2*E(e)]++),t.sym_next===t.sym_end},_tr_align:function(t){_(t,2,3),T(t,256,c),function(t){16===t.bi_valid?(x(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},j=function(t,e,r,n){for(var i=65535&t,a=t>>>16&65535,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{a=a+(i=i+e[n++]|0)|0}while(--o);i%=65521,a%=65521}return i|a<<16},F=new Uint32Array(function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}()),B=function(t,e,r,n){var i=F,a=n+r;t^=-1;for(var o=n;o<a;o++)t=t>>>8^i[255&(t^e[o])];return-1^t},q={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},H={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},V=z._tr_init,X=z._tr_stored_block,G=z._tr_flush_block,Z=z._tr_tally,Y=z._tr_align,$=H.Z_NO_FLUSH,W=H.Z_PARTIAL_FLUSH,Q=H.Z_FULL_FLUSH,K=H.Z_FINISH,J=H.Z_BLOCK,tt=H.Z_OK,et=H.Z_STREAM_END,rt=H.Z_STREAM_ERROR,nt=H.Z_DATA_ERROR,it=H.Z_BUF_ERROR,at=H.Z_DEFAULT_COMPRESSION,ot=H.Z_FILTERED,st=H.Z_HUFFMAN_ONLY,lt=H.Z_RLE,ut=H.Z_FIXED,ct=H.Z_DEFAULT_STRATEGY,ft=H.Z_UNKNOWN,pt=H.Z_DEFLATED,ht=258,dt=262,mt=42,gt=113,vt=666,yt=function(t,e){return t.msg=q[e],e},bt=function(t){return 2*t-(t>4?9:0)},wt=function(t){for(var e=t.length;--e>=0;)t[e]=0},Et=function(t){var e,r,n,i=t.w_size;n=e=t.hash_size;do{r=t.head[--n],t.head[n]=r>=i?r-i:0}while(--e);n=e=i;do{r=t.prev[--n],t.prev[n]=r>=i?r-i:0}while(--e)},xt=function(t,e,r){return(e<<t.hash_shift^r)&t.hash_mask},_t=function(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},Tt=function(t,e){G(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,_t(t.strm)},Nt=function(t,e){t.pending_buf[t.pending++]=e},St=function(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Ot=function(t,e,r,n){var i=t.avail_in;return i>n&&(i=n),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),1===t.state.wrap?t.adler=j(t.adler,e,i,r):2===t.state.wrap&&(t.adler=B(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},At=function(t,e){var r,n,i=t.max_chain_length,a=t.strstart,o=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-dt?t.strstart-(t.w_size-dt):0,u=t.window,c=t.w_mask,f=t.prev,p=t.strstart+ht,h=u[a+o-1],d=u[a+o];t.prev_length>=t.good_match&&(i>>=2),s>t.lookahead&&(s=t.lookahead);do{if(u[(r=e)+o]===d&&u[r+o-1]===h&&u[r]===u[a]&&u[++r]===u[a+1]){a+=2,r++;do{}while(u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&u[++a]===u[++r]&&a<p);if(n=ht-(p-a),a=p-ht,n>o){if(t.match_start=e,o=n,n>=s)break;h=u[a+o-1],d=u[a+o]}}}while((e=f[e&c])>l&&0!=--i);return o<=t.lookahead?o:t.lookahead},Ct=function(t){var e,r,n,i=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=i+(i-dt)&&(t.window.set(t.window.subarray(i,i+i-r),0),t.match_start-=i,t.strstart-=i,t.block_start-=i,t.insert>t.strstart&&(t.insert=t.strstart),Et(t),r+=i),0===t.strm.avail_in)break;if(e=Ot(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=e,t.lookahead+t.insert>=3)for(n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=xt(t,t.ins_h,t.window[n+1]);t.insert&&(t.ins_h=xt(t,t.ins_h,t.window[n+3-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<dt&&0!==t.strm.avail_in)},It=function(t,e){var r,n,i,a=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,s=t.strm.avail_in;do{if(r=65535,i=t.bi_valid+42>>3,t.strm.avail_out<i)break;if(i=t.strm.avail_out-i,r>(n=t.strstart-t.block_start)+t.strm.avail_in&&(r=n+t.strm.avail_in),r>i&&(r=i),r<a&&(0===r&&e!==K||e===$||r!==n+t.strm.avail_in))break;o=e===K&&r===n+t.strm.avail_in?1:0,X(t,0,0,o),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,_t(t.strm),n&&(n>r&&(n=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+n),t.strm.next_out),t.strm.next_out+=n,t.strm.avail_out-=n,t.strm.total_out+=n,t.block_start+=n,r-=n),r&&(Ot(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===o);return(s-=t.strm.avail_in)&&(s>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=s&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-s,t.strm.next_in),t.strstart),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:e!==$&&e!==K&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(i=t.window_size-t.strstart,t.strm.avail_in>i&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,i+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),i>t.strm.avail_in&&(i=t.strm.avail_in),i&&(Ot(t.strm,t.window,t.strstart,i),t.strstart+=i,t.insert+=i>t.w_size-t.insert?t.w_size-t.insert:i),t.high_water<t.strstart&&(t.high_water=t.strstart),i=t.bi_valid+42>>3,a=(i=t.pending_buf_size-i>65535?65535:t.pending_buf_size-i)>t.w_size?t.w_size:i,((n=t.strstart-t.block_start)>=a||(n||e===K)&&e!==$&&0===t.strm.avail_in&&n<=i)&&(r=n>i?i:n,o=e===K&&0===t.strm.avail_in&&r===n?1:0,X(t,t.block_start,r,o),t.block_start+=r,_t(t.strm)),o?3:1)},Dt=function(t,e){for(var r,n;;){if(t.lookahead<dt){if(Ct(t),t.lookahead<dt&&e===$)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-dt&&(t.match_length=At(t,r)),t.match_length>=3)if(n=Z(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=xt(t,t.ins_h,t.window[t.strstart+1]);else n=Z(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Tt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===K?(Tt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Tt(t,!1),0===t.strm.avail_out)?1:2},kt=function(t,e){for(var r,n,i;;){if(t.lookahead<dt){if(Ct(t),t.lookahead<dt&&e===$)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-dt&&(t.match_length=At(t,r),t.match_length<=5&&(t.strategy===ot||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=Z(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=xt(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Tt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=Z(t,0,t.window[t.strstart-1]))&&Tt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=Z(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===K?(Tt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Tt(t,!1),0===t.strm.avail_out)?1:2};function Pt(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}var Rt=[new Pt(0,0,0,0,It),new Pt(4,4,8,4,Dt),new Pt(4,5,16,8,Dt),new Pt(4,6,32,32,Dt),new Pt(4,4,16,16,kt),new Pt(8,16,32,32,kt),new Pt(8,16,128,128,kt),new Pt(8,32,128,256,kt),new Pt(32,128,258,1024,kt),new Pt(32,258,258,4096,kt)];function Lt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=pt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),wt(this.dyn_ltree),wt(this.dyn_dtree),wt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),wt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),wt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Mt=function(t){if(!t)return 1;var e=t.state;return!e||e.strm!==t||e.status!==mt&&57!==e.status&&69!==e.status&&73!==e.status&&91!==e.status&&103!==e.status&&e.status!==gt&&e.status!==vt?1:0},Ut=function(t){if(Mt(t))return yt(t,rt);t.total_in=t.total_out=0,t.data_type=ft;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?57:e.wrap?mt:gt,t.adler=2===e.wrap?0:1,e.last_flush=-2,V(e),tt},zt=function(t){var e,r=Ut(t);return r===tt&&((e=t.state).window_size=2*e.w_size,wt(e.head),e.max_lazy_match=Rt[e.level].max_lazy,e.good_match=Rt[e.level].good_length,e.nice_match=Rt[e.level].nice_length,e.max_chain_length=Rt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),r},jt=function(t,e,r,n,i,a){if(!t)return rt;var o=1;if(e===at&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),i<1||i>9||r!==pt||n<8||n>15||e<0||e>9||a<0||a>ut||8===n&&1!==o)return yt(t,rt);8===n&&(n=9);var s=new Lt;return t.state=s,s.strm=t,s.status=mt,s.wrap=o,s.gzhead=null,s.w_bits=n,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=i+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<i+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.sym_buf=s.lit_bufsize,s.sym_end=3*(s.lit_bufsize-1),s.level=e,s.strategy=a,s.method=r,zt(t)},Ft={deflateInit:function(t,e){return jt(t,e,pt,15,8,ct)},deflateInit2:jt,deflateReset:zt,deflateResetKeep:Ut,deflateSetHeader:function(t,e){return Mt(t)||2!==t.state.wrap?rt:(t.state.gzhead=e,tt)},deflate:function(t,e){if(Mt(t)||e>J||e<0)return t?yt(t,rt):rt;var r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===vt&&e!==K)return yt(t,0===t.avail_out?it:rt);var n=r.last_flush;if(r.last_flush=e,0!==r.pending){if(_t(t),0===t.avail_out)return r.last_flush=-1,tt}else if(0===t.avail_in&&bt(e)<=bt(n)&&e!==K)return yt(t,it);if(r.status===vt&&0!==t.avail_in)return yt(t,it);if(r.status===mt&&0===r.wrap&&(r.status=gt),r.status===mt){var i=pt+(r.w_bits-8<<4)<<8;if(i|=(r.strategy>=st||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(i|=32),St(r,i+=31-i%31),0!==r.strstart&&(St(r,t.adler>>>16),St(r,65535&t.adler)),t.adler=1,r.status=gt,_t(t),0!==r.pending)return r.last_flush=-1,tt}if(57===r.status)if(t.adler=0,Nt(r,31),Nt(r,139),Nt(r,8),r.gzhead)Nt(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Nt(r,255&r.gzhead.time),Nt(r,r.gzhead.time>>8&255),Nt(r,r.gzhead.time>>16&255),Nt(r,r.gzhead.time>>24&255),Nt(r,9===r.level?2:r.strategy>=st||r.level<2?4:0),Nt(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Nt(r,255&r.gzhead.extra.length),Nt(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=B(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Nt(r,0),Nt(r,0),Nt(r,0),Nt(r,0),Nt(r,0),Nt(r,9===r.level?2:r.strategy>=st||r.level<2?4:0),Nt(r,3),r.status=gt,_t(t),0!==r.pending)return r.last_flush=-1,tt;if(69===r.status){if(r.gzhead.extra){for(var a=r.pending,o=(65535&r.gzhead.extra.length)-r.gzindex;r.pending+o>r.pending_buf_size;){var s=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+s),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(t.adler=B(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=s,_t(t),0!==r.pending)return r.last_flush=-1,tt;a=0,o-=s}var l=new Uint8Array(r.gzhead.extra);r.pending_buf.set(l.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending+=o,r.gzhead.hcrc&&r.pending>a&&(t.adler=B(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){var u,c=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>c&&(t.adler=B(t.adler,r.pending_buf,r.pending-c,c)),_t(t),0!==r.pending)return r.last_flush=-1,tt;c=0}u=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Nt(r,u)}while(0!==u);r.gzhead.hcrc&&r.pending>c&&(t.adler=B(t.adler,r.pending_buf,r.pending-c,c)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){var f,p=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>p&&(t.adler=B(t.adler,r.pending_buf,r.pending-p,p)),_t(t),0!==r.pending)return r.last_flush=-1,tt;p=0}f=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Nt(r,f)}while(0!==f);r.gzhead.hcrc&&r.pending>p&&(t.adler=B(t.adler,r.pending_buf,r.pending-p,p))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(_t(t),0!==r.pending))return r.last_flush=-1,tt;Nt(r,255&t.adler),Nt(r,t.adler>>8&255),t.adler=0}if(r.status=gt,_t(t),0!==r.pending)return r.last_flush=-1,tt}if(0!==t.avail_in||0!==r.lookahead||e!==$&&r.status!==vt){var h=0===r.level?It(r,e):r.strategy===st?function(t,e){for(var r;;){if(0===t.lookahead&&(Ct(t),0===t.lookahead)){if(e===$)return 1;break}if(t.match_length=0,r=Z(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Tt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===K?(Tt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Tt(t,!1),0===t.strm.avail_out)?1:2}(r,e):r.strategy===lt?function(t,e){for(var r,n,i,a,o=t.window;;){if(t.lookahead<=ht){if(Ct(t),t.lookahead<=ht&&e===$)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=o[i=t.strstart-1])===o[++i]&&n===o[++i]&&n===o[++i]){a=t.strstart+ht;do{}while(n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&n===o[++i]&&i<a);t.match_length=ht-(a-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=Z(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=Z(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Tt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===K?(Tt(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Tt(t,!1),0===t.strm.avail_out)?1:2}(r,e):Rt[r.level].func(r,e);if(3!==h&&4!==h||(r.status=vt),1===h||3===h)return 0===t.avail_out&&(r.last_flush=-1),tt;if(2===h&&(e===W?Y(r):e!==J&&(X(r,0,0,!1),e===Q&&(wt(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),_t(t),0===t.avail_out))return r.last_flush=-1,tt}return e!==K?tt:r.wrap<=0?et:(2===r.wrap?(Nt(r,255&t.adler),Nt(r,t.adler>>8&255),Nt(r,t.adler>>16&255),Nt(r,t.adler>>24&255),Nt(r,255&t.total_in),Nt(r,t.total_in>>8&255),Nt(r,t.total_in>>16&255),Nt(r,t.total_in>>24&255)):(St(r,t.adler>>>16),St(r,65535&t.adler)),_t(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?tt:et)},deflateEnd:function(t){if(Mt(t))return rt;var e=t.state.status;return t.state=null,e===gt?yt(t,nt):tt},deflateSetDictionary:function(t,e){var r=e.length;if(Mt(t))return rt;var n=t.state,i=n.wrap;if(2===i||1===i&&n.status!==mt||n.lookahead)return rt;if(1===i&&(t.adler=j(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){0===i&&(wt(n.head),n.strstart=0,n.block_start=0,n.insert=0);var a=new Uint8Array(n.w_size);a.set(e.subarray(r-n.w_size,r),0),e=a,r=n.w_size}var o=t.avail_in,s=t.next_in,l=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Ct(n);n.lookahead>=3;){var u=n.strstart,c=n.lookahead-2;do{n.ins_h=xt(n,n.ins_h,n.window[u+3-1]),n.prev[u&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=u,u++}while(--c);n.strstart=u,n.lookahead=2,Ct(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=s,t.input=l,t.avail_in=o,n.wrap=i,tt},deflateInfo:"pako deflate (from Nodeca project)"};function Bt(t){return Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bt(t)}var qt=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Ht=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!==Bt(r))throw new TypeError(r+"must be non-object");for(var n in r)qt(r,n)&&(t[n]=r[n])}}return t},Vt=function(t){for(var e=0,r=0,n=t.length;r<n;r++)e+=t[r].length;for(var i=new Uint8Array(e),a=0,o=0,s=t.length;a<s;a++){var l=t[a];i.set(l,o),o+=l.length}return i},Xt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Xt=!1}for(var Gt=new Uint8Array(256),Zt=0;Zt<256;Zt++)Gt[Zt]=Zt>=252?6:Zt>=248?5:Zt>=240?4:Zt>=224?3:Zt>=192?2:1;Gt[254]=Gt[254]=1;var Yt=function(t){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);var e,r,n,i,a,o=t.length,s=0;for(i=0;i<o;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<o&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),s+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(s),a=0,i=0;a<s;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<o&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|63&r):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e},$t=function(t,e){var r,n,i=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));var a=new Array(2*i);for(n=0,r=0;r<i;){var o=t[r++];if(o<128)a[n++]=o;else{var s=Gt[o];if(s>4)a[n++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&r<i;)o=o<<6|63&t[r++],s--;s>1?a[n++]=65533:o<65536?a[n++]=o:(o-=65536,a[n++]=55296|o>>10&1023,a[n++]=56320|1023&o)}}}return function(t,e){if(e<65534&&t.subarray&&Xt)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r}(a,n)},Wt=function(t,e){(e=e||t.length)>t.length&&(e=t.length);for(var r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+Gt[t[r]]>e?r:e},Qt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Kt=Object.prototype.toString,Jt=H.Z_NO_FLUSH,te=H.Z_SYNC_FLUSH,ee=H.Z_FULL_FLUSH,re=H.Z_FINISH,ne=H.Z_OK,ie=H.Z_STREAM_END,ae=H.Z_DEFAULT_COMPRESSION,oe=H.Z_DEFAULT_STRATEGY,se=H.Z_DEFLATED;function le(t){this.options=Ht({level:ae,method:se,chunkSize:16384,windowBits:15,memLevel:8,strategy:oe},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qt,this.strm.avail_out=0;var r=Ft.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==ne)throw new Error(q[r]);if(e.header&&Ft.deflateSetHeader(this.strm,e.header),e.dictionary){var n;if(n="string"==typeof e.dictionary?Yt(e.dictionary):"[object ArrayBuffer]"===Kt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=Ft.deflateSetDictionary(this.strm,n))!==ne)throw new Error(q[r]);this._dict_set=!0}}function ue(t,e){var r=new le(e);if(r.push(t,!0),r.err)throw r.msg||q[r.err];return r.result}le.prototype.push=function(t,e){var r,n,i=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(n=e===~~e?e:!0===e?re:Jt,"string"==typeof t?i.input=Yt(t):"[object ArrayBuffer]"===Kt.call(t)?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(n===te||n===ee)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if((r=Ft.deflate(i,n))===ie)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=Ft.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===ne;if(0!==i.avail_out){if(n>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},le.prototype.onData=function(t){this.chunks.push(t)},le.prototype.onEnd=function(t){t===ne&&(this.result=Vt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var ce={Deflate:le,deflate:ue,deflateRaw:function(t,e){return(e=e||{}).raw=!0,ue(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,ue(t,e)},constants:H},fe=16209,pe=function(t,e){var r,n,i,a,o,s,l,u,c,f,p,h,d,m,g,v,y,b,w,E,x,_,T,N,S=t.state;r=t.next_in,T=t.input,n=r+(t.avail_in-5),i=t.next_out,N=t.output,a=i-(e-t.avail_out),o=i+(t.avail_out-257),s=S.dmax,l=S.wsize,u=S.whave,c=S.wnext,f=S.window,p=S.hold,h=S.bits,d=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,v=(1<<S.distbits)-1;t:do{h<15&&(p+=T[r++]<<h,h+=8,p+=T[r++]<<h,h+=8),y=d[p&g];e:for(;;){if(p>>>=b=y>>>24,h-=b,0==(b=y>>>16&255))N[i++]=65535&y;else{if(!(16&b)){if(!(64&b)){y=d[(65535&y)+(p&(1<<b)-1)];continue e}if(32&b){S.mode=16191;break t}t.msg="invalid literal/length code",S.mode=fe;break t}w=65535&y,(b&=15)&&(h<b&&(p+=T[r++]<<h,h+=8),w+=p&(1<<b)-1,p>>>=b,h-=b),h<15&&(p+=T[r++]<<h,h+=8,p+=T[r++]<<h,h+=8),y=m[p&v];r:for(;;){if(p>>>=b=y>>>24,h-=b,!(16&(b=y>>>16&255))){if(!(64&b)){y=m[(65535&y)+(p&(1<<b)-1)];continue r}t.msg="invalid distance code",S.mode=fe;break t}if(E=65535&y,h<(b&=15)&&(p+=T[r++]<<h,(h+=8)<b&&(p+=T[r++]<<h,h+=8)),(E+=p&(1<<b)-1)>s){t.msg="invalid distance too far back",S.mode=fe;break t}if(p>>>=b,h-=b,E>(b=i-a)){if((b=E-b)>u&&S.sane){t.msg="invalid distance too far back",S.mode=fe;break t}if(x=0,_=f,0===c){if(x+=l-b,b<w){w-=b;do{N[i++]=f[x++]}while(--b);x=i-E,_=N}}else if(c<b){if(x+=l+c-b,(b-=c)<w){w-=b;do{N[i++]=f[x++]}while(--b);if(x=0,c<w){w-=b=c;do{N[i++]=f[x++]}while(--b);x=i-E,_=N}}}else if(x+=c-b,b<w){w-=b;do{N[i++]=f[x++]}while(--b);x=i-E,_=N}for(;w>2;)N[i++]=_[x++],N[i++]=_[x++],N[i++]=_[x++],w-=3;w&&(N[i++]=_[x++],w>1&&(N[i++]=_[x++]))}else{x=i-E;do{N[i++]=N[x++],N[i++]=N[x++],N[i++]=N[x++],w-=3}while(w>2);w&&(N[i++]=N[x++],w>1&&(N[i++]=N[x++]))}break}}break}}while(r<n&&i<o);r-=w=h>>3,p&=(1<<(h-=w<<3))-1,t.next_in=r,t.next_out=i,t.avail_in=r<n?n-r+5:5-(r-n),t.avail_out=i<o?o-i+257:257-(i-o),S.hold=p,S.bits=h},he=15,de=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),me=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ge=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ve=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ye=function(t,e,r,n,i,a,o,s){var l,u,c,f,p,h,d,m,g,v=s.bits,y=0,b=0,w=0,E=0,x=0,_=0,T=0,N=0,S=0,O=0,A=null,C=new Uint16Array(16),I=new Uint16Array(16),D=null;for(y=0;y<=he;y++)C[y]=0;for(b=0;b<n;b++)C[e[r+b]]++;for(x=v,E=he;E>=1&&0===C[E];E--);if(x>E&&(x=E),0===E)return i[a++]=20971520,i[a++]=20971520,s.bits=1,0;for(w=1;w<E&&0===C[w];w++);for(x<w&&(x=w),N=1,y=1;y<=he;y++)if(N<<=1,(N-=C[y])<0)return-1;if(N>0&&(0===t||1!==E))return-1;for(I[1]=0,y=1;y<he;y++)I[y+1]=I[y]+C[y];for(b=0;b<n;b++)0!==e[r+b]&&(o[I[e[r+b]]++]=b);if(0===t?(A=D=o,h=20):1===t?(A=de,D=me,h=257):(A=ge,D=ve,h=0),O=0,b=0,y=w,p=a,_=x,T=0,c=-1,f=(S=1<<x)-1,1===t&&S>852||2===t&&S>592)return 1;for(;;){d=y-T,o[b]+1<h?(m=0,g=o[b]):o[b]>=h?(m=D[o[b]-h],g=A[o[b]-h]):(m=96,g=0),l=1<<y-T,w=u=1<<_;do{i[p+(O>>T)+(u-=l)]=d<<24|m<<16|g}while(0!==u);for(l=1<<y-1;O&l;)l>>=1;if(0!==l?(O&=l-1,O+=l):O=0,b++,0==--C[y]){if(y===E)break;y=e[r+o[b]]}if(y>x&&(O&f)!==c){for(0===T&&(T=x),p+=w,N=1<<(_=y-T);_+T<E&&!((N-=C[_+T])<=0);)_++,N<<=1;if(S+=1<<_,1===t&&S>852||2===t&&S>592)return 1;i[c=O&f]=x<<24|_<<16|p-a}}return 0!==O&&(i[p+O]=y-T<<24|64<<16),s.bits=x,0},be=H.Z_FINISH,we=H.Z_BLOCK,Ee=H.Z_TREES,xe=H.Z_OK,_e=H.Z_STREAM_END,Te=H.Z_NEED_DICT,Ne=H.Z_STREAM_ERROR,Se=H.Z_DATA_ERROR,Oe=H.Z_MEM_ERROR,Ae=H.Z_BUF_ERROR,Ce=H.Z_DEFLATED,Ie=16180,De=16190,ke=16191,Pe=16192,Re=16194,Le=16199,Me=16200,Ue=16206,ze=16209,je=function(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)};function Fe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var Be,qe,He=function(t){if(!t)return 1;var e=t.state;return!e||e.strm!==t||e.mode<Ie||e.mode>16211?1:0},Ve=function(t){if(He(t))return Ne;var e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=Ie,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,xe},Xe=function(t){if(He(t))return Ne;var e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ve(t)},Ge=function(t,e){var r;if(He(t))return Ne;var n=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?Ne:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Xe(t))},Ze=function(t,e){if(!t)return Ne;var r=new Fe;t.state=r,r.strm=t,r.window=null,r.mode=Ie;var n=Ge(t,e);return n!==xe&&(t.state=null),n},Ye=!0,$e=function(t){if(Ye){Be=new Int32Array(512),qe=new Int32Array(32);for(var e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(ye(1,t.lens,0,288,Be,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;ye(2,t.lens,0,32,qe,0,t.work,{bits:5}),Ye=!1}t.lencode=Be,t.lenbits=9,t.distcode=qe,t.distbits=5},We=function(t,e,r,n){var i,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(e.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):((i=a.wsize-a.wnext)>n&&(i=n),a.window.set(e.subarray(r-n,r-n+i),a.wnext),(n-=i)?(a.window.set(e.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},Qe={inflateReset:Xe,inflateReset2:Ge,inflateResetKeep:Ve,inflateInit:function(t){return Ze(t,15)},inflateInit2:Ze,inflate:function(t,e){var r,n,i,a,o,s,l,u,c,f,p,h,d,m,g,v,y,b,w,E,x,_,T,N,S=0,O=new Uint8Array(4),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(He(t)||!t.output||!t.input&&0!==t.avail_in)return Ne;(r=t.state).mode===ke&&(r.mode=Pe),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,u=r.hold,c=r.bits,f=s,p=l,_=xe;t:for(;;)switch(r.mode){case Ie:if(0===r.wrap){r.mode=Pe;break}for(;c<16;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(2&r.wrap&&35615===u){0===r.wbits&&(r.wbits=15),r.check=0,O[0]=255&u,O[1]=u>>>8&255,r.check=B(r.check,O,2,0),u=0,c=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=ze;break}if((15&u)!==Ce){t.msg="unknown compression method",r.mode=ze;break}if(c-=4,x=8+(15&(u>>>=4)),0===r.wbits&&(r.wbits=x),x>15||x>r.wbits){t.msg="invalid window size",r.mode=ze;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&u?16189:ke,u=0,c=0;break;case 16181:for(;c<16;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(r.flags=u,(255&r.flags)!==Ce){t.msg="unknown compression method",r.mode=ze;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=ze;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&4&r.wrap&&(O[0]=255&u,O[1]=u>>>8&255,r.check=B(r.check,O,2,0)),u=0,c=0,r.mode=16182;case 16182:for(;c<32;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.head&&(r.head.time=u),512&r.flags&&4&r.wrap&&(O[0]=255&u,O[1]=u>>>8&255,O[2]=u>>>16&255,O[3]=u>>>24&255,r.check=B(r.check,O,4,0)),u=0,c=0,r.mode=16183;case 16183:for(;c<16;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&4&r.wrap&&(O[0]=255&u,O[1]=u>>>8&255,r.check=B(r.check,O,2,0)),u=0,c=0,r.mode=16184;case 16184:if(1024&r.flags){for(;c<16;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&4&r.wrap&&(O[0]=255&u,O[1]=u>>>8&255,r.check=B(r.check,O,2,0)),u=0,c=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),x)),512&r.flags&&4&r.wrap&&(r.check=B(r.check,n,h,a)),s-=h,a+=h,r.length-=h),r.length))break t;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===s)break t;h=0;do{x=n[a+h++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x))}while(x&&h<s);if(512&r.flags&&4&r.wrap&&(r.check=B(r.check,n,h,a)),s-=h,a+=h,x)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===s)break t;h=0;do{x=n[a+h++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x))}while(x&&h<s);if(512&r.flags&&4&r.wrap&&(r.check=B(r.check,n,h,a)),s-=h,a+=h,x)break t}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;c<16;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(4&r.wrap&&u!==(65535&r.check)){t.msg="header crc mismatch",r.mode=ze;break}u=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ke;break;case 16189:for(;c<32;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}t.adler=r.check=je(u),u=0,c=0,r.mode=De;case De:if(0===r.havedict)return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,r.hold=u,r.bits=c,Te;t.adler=r.check=1,r.mode=ke;case ke:if(e===we||e===Ee)break t;case Pe:if(r.last){u>>>=7&c,c-=7&c,r.mode=Ue;break}for(;c<3;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}switch(r.last=1&u,c-=1,3&(u>>>=1)){case 0:r.mode=16193;break;case 1:if($e(r),r.mode=Le,e===Ee){u>>>=2,c-=2;break t}break;case 2:r.mode=16196;break;case 3:t.msg="invalid block type",r.mode=ze}u>>>=2,c-=2;break;case 16193:for(u>>>=7&c,c-=7&c;c<32;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ze;break}if(r.length=65535&u,u=0,c=0,r.mode=Re,e===Ee)break t;case Re:r.mode=16195;case 16195:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break t;i.set(n.subarray(a,a+h),o),s-=h,a+=h,l-=h,o+=h,r.length-=h;break}r.mode=ke;break;case 16196:for(;c<14;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(r.nlen=257+(31&u),u>>>=5,c-=5,r.ndist=1+(31&u),u>>>=5,c-=5,r.ncode=4+(15&u),u>>>=4,c-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ze;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.lens[A[r.have++]]=7&u,u>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,T={bits:r.lenbits},_=ye(0,r.lens,0,19,r.lencode,0,r.work,T),r.lenbits=T.bits,_){t.msg="invalid code lengths set",r.mode=ze;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;v=(S=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&S,!((g=S>>>24)<=c);){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(y<16)u>>>=g,c-=g,r.lens[r.have++]=y;else{if(16===y){for(N=g+2;c<N;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(u>>>=g,c-=g,0===r.have){t.msg="invalid bit length repeat",r.mode=ze;break}x=r.lens[r.have-1],h=3+(3&u),u>>>=2,c-=2}else if(17===y){for(N=g+3;c<N;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}c-=g,x=0,h=3+(7&(u>>>=g)),u>>>=3,c-=3}else{for(N=g+7;c<N;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}c-=g,x=0,h=11+(127&(u>>>=g)),u>>>=7,c-=7}if(r.have+h>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ze;break}for(;h--;)r.lens[r.have++]=x}}if(r.mode===ze)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=ze;break}if(r.lenbits=9,T={bits:r.lenbits},_=ye(1,r.lens,0,r.nlen,r.lencode,0,r.work,T),r.lenbits=T.bits,_){t.msg="invalid literal/lengths set",r.mode=ze;break}if(r.distbits=6,r.distcode=r.distdyn,T={bits:r.distbits},_=ye(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,T),r.distbits=T.bits,_){t.msg="invalid distances set",r.mode=ze;break}if(r.mode=Le,e===Ee)break t;case Le:r.mode=Me;case Me:if(s>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,r.hold=u,r.bits=c,pe(t,p),o=t.next_out,i=t.output,l=t.avail_out,a=t.next_in,n=t.input,s=t.avail_in,u=r.hold,c=r.bits,r.mode===ke&&(r.back=-1);break}for(r.back=0;v=(S=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,y=65535&S,!((g=S>>>24)<=c);){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(v&&!(240&v)){for(b=g,w=v,E=y;v=(S=r.lencode[E+((u&(1<<b+w)-1)>>b)])>>>16&255,y=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,r.length=y,0===v){r.mode=16205;break}if(32&v){r.back=-1,r.mode=ke;break}if(64&v){t.msg="invalid literal/length code",r.mode=ze;break}r.extra=15&v,r.mode=16201;case 16201:if(r.extra){for(N=r.extra;c<N;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;v=(S=r.distcode[u&(1<<r.distbits)-1])>>>16&255,y=65535&S,!((g=S>>>24)<=c);){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(!(240&v)){for(b=g,w=v,E=y;v=(S=r.distcode[E+((u&(1<<b+w)-1)>>b)])>>>16&255,y=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}u>>>=b,c-=b,r.back+=b}if(u>>>=g,c-=g,r.back+=g,64&v){t.msg="invalid distance code",r.mode=ze;break}r.offset=y,r.extra=15&v,r.mode=16203;case 16203:if(r.extra){for(N=r.extra;c<N;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ze;break}r.mode=16204;case 16204:if(0===l)break t;if(h=p-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ze;break}h>r.wnext?(h-=r.wnext,d=r.wsize-h):d=r.wnext-h,h>r.length&&(h=r.length),m=r.window}else m=i,d=o-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do{i[o++]=m[d++]}while(--h);0===r.length&&(r.mode=Me);break;case 16205:if(0===l)break t;i[o++]=r.length,l--,r.mode=Me;break;case Ue:if(r.wrap){for(;c<32;){if(0===s)break t;s--,u|=n[a++]<<c,c+=8}if(p-=l,t.total_out+=p,r.total+=p,4&r.wrap&&p&&(t.adler=r.check=r.flags?B(r.check,i,p,o-p):j(r.check,i,p,o-p)),p=l,4&r.wrap&&(r.flags?u:je(u))!==r.check){t.msg="incorrect data check",r.mode=ze;break}u=0,c=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break t;s--,u+=n[a++]<<c,c+=8}if(4&r.wrap&&u!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=ze;break}u=0,c=0}r.mode=16208;case 16208:_=_e;break t;case ze:_=Se;break t;case 16210:return Oe;default:return Ne}return t.next_out=o,t.avail_out=l,t.next_in=a,t.avail_in=s,r.hold=u,r.bits=c,(r.wsize||p!==t.avail_out&&r.mode<ze&&(r.mode<Ue||e!==be))&&We(t,t.output,t.next_out,p-t.avail_out),f-=t.avail_in,p-=t.avail_out,t.total_in+=f,t.total_out+=p,r.total+=p,4&r.wrap&&p&&(t.adler=r.check=r.flags?B(r.check,i,p,t.next_out-p):j(r.check,i,p,t.next_out-p)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ke?128:0)+(r.mode===Le||r.mode===Re?256:0),(0===f&&0===p||e===be)&&_===xe&&(_=Ae),_},inflateEnd:function(t){if(He(t))return Ne;var e=t.state;return e.window&&(e.window=null),t.state=null,xe},inflateGetHeader:function(t,e){if(He(t))return Ne;var r=t.state;return 2&r.wrap?(r.head=e,e.done=!1,xe):Ne},inflateSetDictionary:function(t,e){var r,n=e.length;return He(t)||0!==(r=t.state).wrap&&r.mode!==De?Ne:r.mode===De&&j(1,e,n,0)!==r.check?Se:We(t,e,n,n)?(r.mode=16210,Oe):(r.havedict=1,xe)},inflateInfo:"pako inflate (from Nodeca project)"},Ke=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Je=Object.prototype.toString,tr=H.Z_NO_FLUSH,er=H.Z_FINISH,rr=H.Z_OK,nr=H.Z_STREAM_END,ir=H.Z_NEED_DICT,ar=H.Z_STREAM_ERROR,or=H.Z_DATA_ERROR,sr=H.Z_MEM_ERROR;function lr(t){this.options=Ht({chunkSize:65536,windowBits:15,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&!(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Qt,this.strm.avail_out=0;var r=Qe.inflateInit2(this.strm,e.windowBits);if(r!==rr)throw new Error(q[r]);if(this.header=new Ke,Qe.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Yt(e.dictionary):"[object ArrayBuffer]"===Je.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Qe.inflateSetDictionary(this.strm,e.dictionary))!==rr))throw new Error(q[r])}function ur(t,e){var r=new lr(e);if(r.push(t),r.err)throw r.msg||q[r.err];return r.result}lr.prototype.push=function(t,e){var r,n,i,a=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=e===~~e?e:!0===e?er:tr,"[object ArrayBuffer]"===Je.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(o),a.next_out=0,a.avail_out=o),(r=Qe.inflate(a,n))===ir&&s&&((r=Qe.inflateSetDictionary(a,s))===rr?r=Qe.inflate(a,n):r===or&&(r=ir));a.avail_in>0&&r===nr&&a.state.wrap>0&&0!==t[a.next_in];)Qe.inflateReset(a),r=Qe.inflate(a,n);switch(r){case ar:case or:case ir:case sr:return this.onEnd(r),this.ended=!0,!1}if(i=a.avail_out,a.next_out&&(0===a.avail_out||r===nr))if("string"===this.options.to){var l=Wt(a.output,a.next_out),u=a.next_out-l,c=$t(a.output,l);a.next_out=u,a.avail_out=o-u,u&&a.output.set(a.output.subarray(l,l+u),0),this.onData(c)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(r!==rr||0!==i){if(r===nr)return r=Qe.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},lr.prototype.onData=function(t){this.chunks.push(t)},lr.prototype.onEnd=function(t){t===rr&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Vt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var cr={Inflate:lr,inflate:ur,inflateRaw:function(t,e){return(e=e||{}).raw=!0,ur(t,e)},ungzip:ur,constants:H},fr=ce.Deflate,pr=ce.deflate,hr=ce.deflateRaw,dr=ce.gzip,mr=cr.Inflate,gr=cr.inflate,vr=cr.inflateRaw,yr=cr.ungzip,br=H,wr={Deflate:fr,deflate:pr,deflateRaw:hr,gzip:dr,Inflate:mr,inflate:gr,inflateRaw:vr,ungzip:yr,constants:br};t.Deflate=fr,t.Inflate=mr,t.constants=br,t.default=wr,t.deflate=pr,t.deflateRaw=hr,t.gzip=dr,t.inflate=gr,t.inflateRaw=vr,t.ungzip=yr,Object.defineProperty(t,"__esModule",{value:!0})}(e)}(0,Nt.exports)),Nt.exports}function Ot(){return Et||(Et=1,_t.STORE={magic:"\0\0",compress:function(t){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},_t.DEFLATE=function(){if(wt)return Tt;wt=1;var t="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,e=St();return Tt.uncompressInputType=t?"uint8array":"array",Tt.compressInputType=t?"uint8array":"array",Tt.magic="\b\0",Tt.compress=function(t,r){return e.deflateRaw(t,{level:r.level||-1})},Tt.uncompress=function(t){return e.inflateRaw(t)},Tt}()),_t}var At={exports:{}};At.exports=function(t,e){return"number"==typeof t?Buffer.alloc(t):Buffer.from(t,e)},At.exports.test=function(t){return Buffer.isBuffer(t)};var Ct=At.exports;!function(t){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r=gt,n=Ot(),i=Ct;function a(t){return t}function o(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}function s(e){var r=65536,n=[],a=e.length,o=t.getTypeOf(e),s=0,l=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,i(0))}}catch(t){l=!1}if(!l){for(var u="",c=0;c<e.length;c++)u+=String.fromCharCode(e[c]);return u}for(;s<a&&r>1;)try{"array"===o||"nodebuffer"===o?n.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+r,a)))):n.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+r,a)))),s+=r}catch(t){r=Math.floor(r/2)}return n.join("")}function l(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}t.string2binary=function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(255&t.charCodeAt(r));return e},t.arrayBuffer2Blob=function(e,r){t.checkSupport("blob"),r=r||"application/zip";try{return new Blob([e],{type:r})}catch(t){try{var n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return n.append(e),n.getBlob(r)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},t.applyFromCharCode=s;var u={};u.string={string:a,array:function(t){return o(t,new Array(t.length))},arraybuffer:function(t){return u.string.uint8array(t).buffer},uint8array:function(t){return o(t,new Uint8Array(t.length))},nodebuffer:function(t){return o(t,i(t.length))}},u.array={string:s,array:a,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return i(t)}},u.arraybuffer={string:function(t){return s(new Uint8Array(t))},array:function(t){return l(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:a,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return i(new Uint8Array(t))}},u.uint8array={string:s,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:a,nodebuffer:function(t){return i(t)}},u.nodebuffer={string:s,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return u.nodebuffer.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:a},t.transformTo=function(e,r){if(r||(r=""),!e)return r;t.checkSupport(e);var n=t.getTypeOf(r);return u[n][e](r)},t.getTypeOf=function(t){if(null!=t){if("string"==typeof t)return"string";var n=Object.prototype.toString.call(t);if("[object Array]"===n)return"array";if(r.nodebuffer&&i.test(t))return"nodebuffer";if(r.uint8array&&"[object Uint8Array]"===n)return"uint8array";if(r.arraybuffer&&"[object ArrayBuffer]"===n)return"arraybuffer";if("[object Promise]"===n)throw new Error("Cannot read data from a promise, you probably are running new PizZip(data) with a promise");if("object"===e(t)&&"function"==typeof t.file)throw new Error("Cannot read data from a pizzip instance, you probably are running new PizZip(zip) with a zipinstance");if("[object Date]"===n)throw new Error("Cannot read data from a Date, you probably are running new PizZip(data) with a date");if("object"===e(t)&&null==t.crc32)throw new Error("Unsupported data given to new PizZip(data) (object given)")}},t.checkSupport=function(t){if(!r[t.toLowerCase()])throw new Error(t+" is not supported by this browser")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(t){var e,r,n="";for(r=0;r<(t||"").length;r++)n+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return n},t.findCompression=function(t){for(var e in n)if(n.hasOwnProperty(e)&&n[e].magic===t)return n[e];return null},t.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},t.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r}}(xt);var It=xt,Dt=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],kt={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},Pt={};function Rt(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}Pt.base64=!1,Pt.binary=!1,Pt.dir=!1,Pt.createFolders=!1,Pt.date=null,Pt.compression=null,Pt.compressionOptions=null,Pt.comment=null,Pt.unixPermissions=null,Pt.dosPermissions=null,Rt.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};for(var Lt=Rt,Mt={},Ut=xt,zt=gt,jt=Ct,Ft=new Array(256),Bt=0;Bt<256;Bt++)Ft[Bt]=Bt>=252?6:Bt>=248?5:Bt>=240?4:Bt>=224?3:Bt>=192?2:1;function qt(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+Ft[t[r]]>e?r:e}function Ht(t){var e,r,n,i,a=t.length,o=new Array(2*a);for(r=0,e=0;e<a;)if((n=t[e++])<128)o[r++]=n;else if((i=Ft[n])>4)o[r++]=65533,e+=i-1;else{for(n&=2===i?31:3===i?15:7;i>1&&e<a;)n=n<<6|63&t[e++],i--;i>1?o[r++]=65533:n<65536?o[r++]=n:(n-=65536,o[r++]=55296|n>>10&1023,o[r++]=56320|1023&n)}return o.length!==r&&(o.subarray?o=o.subarray(0,r):o.length=r),Ut.applyFromCharCode(o)}Ft[254]=Ft[254]=1,Mt.utf8encode=function(t){return zt.nodebuffer?jt(t,"utf-8"):function(t){var e,r,n,i,a,o=0,s=t.length;for(i=0;i<s;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(e=zt.uint8array?new Uint8Array(o):new Array(o),a=0,i=0;a<o;i++)55296==(64512&(r=t.charCodeAt(i)))&&i+1<s&&56320==(64512&(n=t.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?e[a++]=r:r<2048?(e[a++]=192|r>>>6,e[a++]=128|63&r):r<65536?(e[a++]=224|r>>>12,e[a++]=128|r>>>6&63,e[a++]=128|63&r):(e[a++]=240|r>>>18,e[a++]=128|r>>>12&63,e[a++]=128|r>>>6&63,e[a++]=128|63&r);return e}(t)},Mt.utf8decode=function(t){if(zt.nodebuffer)return Ut.transformTo("nodebuffer",t).toString("utf-8");for(var e=[],r=(t=Ut.transformTo(zt.uint8array?"uint8array":"array",t)).length,n=0;n<r;){var i=qt(t,Math.min(n+65536,r));zt.uint8array?e.push(Ht(t.subarray(n,i))):e.push(Ht(t.slice(n,i))),n=i}return e.join("")};var Vt=xt;function Xt(){this.data=[]}Xt.prototype={append:function(t){t=Vt.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}};var Gt=Xt,Zt=xt;function Yt(t){this.data=new Uint8Array(t),this.index=0}Yt.prototype={append:function(t){0!==t.length&&(t=Zt.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}};var $t=Yt;function Wt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Qt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Kt=gt,Jt=xt,te=function(t,e){if(void 0===t||!t.length)return 0;var r="string"!==It.getTypeOf(t);void 0===e&&(e=0);var n=0;e^=-1;for(var i=0,a=t.length;i<a;i++)n=r?t[i]:t.charCodeAt(i),e=e>>>8^Dt[255&(e^n)];return-1^e},ee=kt,re=Pt,ne=dt,ie=Ot(),ae=Lt,oe=Ct,se=Mt,le=Gt,ue=$t;function ce(t){if(t._data instanceof ae&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===Jt.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data}function fe(t){var e=ce(t);return"string"===Jt.getTypeOf(e)?!t.options.binary&&Kt.nodebuffer?oe(e,"utf-8"):t.asBinary():e}var pe={load:function(){throw new Error("Load method is not defined. Is the file pizzip-load.js included ?")},filter:function(t){var e,r,n,i,a=[];for(e in this.files)this.files.hasOwnProperty(e)&&(i=new de((n=this.files[e]).name,n._data,Jt.extend(n.options)),r=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(r,i)&&a.push(i));return a},file:function(t,e,r){if(1===arguments.length){if(Jt.isRegExp(t)){var n=t;return this.filter(function(t,e){return!e.dir&&n.test(t)})}return this.filter(function(e,r){return!r.dir&&e===t})[0]||null}return t=this.root+t,ge.call(this,t,e,r),this},folder:function(t){if(!t)return this;if(Jt.isRegExp(t))return this.filter(function(e,r){return r.dir&&t.test(e)});var e=this.root+t,r=ye.call(this,e),n=this.shallowClone();return n.root=r.name,n},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter(function(e,r){return r.name.slice(0,t.length)===t}),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(t){t=Jt.extend(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:se.utf8encode}),Jt.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,r,n=[],i=Jt.transformTo("string",t.encodeFileName(t.comment||this.comment||"")),a=0,o=0,s=[];for(var l in t.fileOrder instanceof Array&&(s=t.fileOrder),this.files)-1===s.indexOf(l)&&s.push(l);"function"==typeof t.fileOrder&&(s=t.fileOrder(this.files));var u,c=Wt(s);try{for(c.s();!(u=c.n()).done;){var f=u.value;if(this.files.hasOwnProperty(f)){var p=this.files[f],h=p.options.compression||t.compression.toUpperCase(),d=ie[h];if(!d)throw new Error(h+" is not a valid compression method !");var m=p.options.compressionOptions||t.compressionOptions||{},g=be.call(this,p,d,m),v=we.call(this,f,p,g,a,t.platform,t.encodeFileName);a+=v.fileRecord.length+g.compressedSize,o+=v.dirRecord.length,n.push(v)}}}catch(t){c.e(t)}finally{c.f()}var y;y=ee.CENTRAL_DIRECTORY_END+"\0\0\0\0"+me(n.length,2)+me(n.length,2)+me(o,4)+me(a,4)+me(i.length,2)+i;var b=t.type.toLowerCase();for(e="uint8array"===b||"arraybuffer"===b||"blob"===b||"nodebuffer"===b?new ue(a+o+y.length):new le(a+o+y.length),r=0;r<n.length;r++)e.append(n[r].fileRecord),e.append(n[r].compressedObject.compressedContent);for(r=0;r<n.length;r++)e.append(n[r].dirRecord);e.append(y);var w=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return Jt.transformTo(t.type.toLowerCase(),w);case"blob":return Jt.arrayBuffer2Blob(Jt.transformTo("arraybuffer",w),t.mimeType);case"base64":return t.base64?ne.encode(w):w;default:return w}},crc32:function(t,e){return te(t,e)},utf8encode:function(t){return Jt.transformTo("string",se.utf8encode(t))},utf8decode:function(t){return se.utf8decode(t)}};function he(t){var e=ce(this);return null==e?"":(this.options.base64&&(e=ne.decode(e)),e=t&&this.options.binary?pe.utf8decode(e):Jt.transformTo("string",e),t||this.options.binary||(e=Jt.transformTo("string",pe.utf8encode(e))),e)}function de(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}}function me(t,e){var r,n="";for(r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n}function ge(t,e,r){var n,i=Jt.getTypeOf(e);if("string"==typeof(r=function(t){return!0!==(t=t||{}).base64||null!==t.binary&&void 0!==t.binary||(t.binary=!0),(t=Jt.extend(t,re)).date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t}(r)).unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(t=ve(t)),r.createFolders&&(n=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""}(t))&&ye.call(this,n,!0),r.dir||null==e)r.base64=!1,r.binary=!1,e=null,i=null;else if("string"===i)r.binary&&!r.base64&&!0!==r.optimizedBinaryString&&(e=Jt.string2binary(e));else{if(r.base64=!1,r.binary=!0,!(i||e instanceof ae))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===i&&(e=Jt.transformTo("uint8array",e))}var a=new de(t,e,r);return this.files[t]=a,a}function ve(t){return"/"!==t.slice(-1)&&(t+="/"),t}function ye(t,e){return e=void 0!==e&&e,t=ve(t),this.files[t]||ge.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]}function be(t,e,r){var n,i=new ae;return t._data instanceof ae?(i.uncompressedSize=t._data.uncompressedSize,i.crc32=t._data.crc32,0===i.uncompressedSize||t.dir?(e=ie.STORE,i.compressedContent="",i.crc32=0):t._data.compressionMethod===e.magic?i.compressedContent=t._data.getCompressedContent():(n=t._data.getContent(),i.compressedContent=e.compress(Jt.transformTo(e.compressInputType,n),r))):((n=fe(t))&&0!==n.length&&!t.dir||(e=ie.STORE,n=""),i.uncompressedSize=n.length,i.crc32=te(n),i.compressedContent=e.compress(Jt.transformTo(e.compressInputType,n),r)),i.compressedSize=i.compressedContent.length,i.compressionMethod=e.magic,i}function we(t,e,r,n,i,a){var o,s,l,u,c=a!==se.utf8encode,f=Jt.transformTo("string",a(e.name)),p=Jt.transformTo("string",se.utf8encode(e.name)),h=e.comment||"",d=Jt.transformTo("string",a(h)),m=Jt.transformTo("string",se.utf8encode(h)),g=p.length!==e.name.length,v=m.length!==h.length,y=e.options,b="",w="",E="";l=e._initialMetadata.dir!==e.dir?e.dir:y.dir,u=e._initialMetadata.date!==e.date?e.date:y.date;var x=0,_=0;l&&(x|=16),"UNIX"===i?(_=798,x|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(e.unixPermissions,l)):(_=20,x|=63&(e.dosPermissions||0)),o=u.getHours(),o<<=6,o|=u.getMinutes(),o<<=5,o|=u.getSeconds()/2,s=u.getFullYear()-1980,s<<=4,s|=u.getMonth()+1,s<<=5,s|=u.getDate(),g&&(w=me(1,1)+me(te(f),4)+p,b+="up"+me(w.length,2)+w),v&&(E=me(1,1)+me(this.crc32(d),4)+m,b+="uc"+me(E.length,2)+E);var T="";return T+="\n\0",T+=c||!g&&!v?"\0\0":"\0\b",T+=r.compressionMethod,T+=me(o,2),T+=me(s,2),T+=me(r.crc32,4),T+=me(r.compressedSize,4),T+=me(r.uncompressedSize,4),T+=me(f.length,2),T+=me(b.length,2),{fileRecord:ee.LOCAL_FILE_HEADER+T+f+b,dirRecord:ee.CENTRAL_FILE_HEADER+me(_,2)+T+me(d.length,2)+"\0\0\0\0"+me(x,4)+me(n,4)+f+b+d,compressedObject:r}}de.prototype={asText:function(){return he.call(this,!0)},asBinary:function(){return he.call(this,!1)},asNodeBuffer:function(){var t=fe(this);return Jt.transformTo("nodebuffer",t)},asUint8Array:function(){var t=fe(this);return Jt.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var Ee=pe,xe=xt;function _e(){this.data=null,this.length=0,this.index=0,this.zero=0}_e.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return xe.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}};var Te=_e,Ne=Te,Se=xt;function Oe(t,e){this.data=t,e||(this.data=Se.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}Oe.prototype=new Ne,Oe.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},Oe.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},Oe.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var Ae=Oe,Ce=Te;function Ie(t){if(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0;for(var e=0;e<this.data.length;e++)t[e]&=t[e]}}Ie.prototype=new Ce,Ie.prototype.byteAt=function(t){return this.data[this.zero+t]},Ie.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===e&&this.data[a+1]===r&&this.data[a+2]===n&&this.data[a+3]===i)return a-this.zero;return-1},Ie.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var De=Ie,ke=De;function Pe(t){t&&(this.data=t,this.length=this.data.length,this.index=0,this.zero=0)}Pe.prototype=new ke,Pe.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var Re=Pe,Le=Re;function Me(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0}Me.prototype=new Le,Me.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e};var Ue=Me,ze=Ae,je=xt,Fe=Lt,Be=Ee,qe=gt;function He(t,e){this.options=t,this.loadOptions=e}He.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},prepareCompressedContent:function(t,e,r){return function(){var n=t.index;t.setIndex(e);var i=t.readData(r);return t.setIndex(n),i}},prepareContent:function(t,e,r,n,i){return function(){var t=je.transformTo(n.uncompressInputType,this.getCompressedContent()),e=n.uncompress(t);if(e.length!==i)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){t.skip(22),this.fileNameLength=t.readInt(2);var e=t.readInt(2);if(this.fileName=t.readData(this.fileNameLength),t.skip(e),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");var r=je.findCompression(this.compressionMethod);if(null===r)throw new Error("Corrupted zip : compression "+je.pretty(this.compressionMethod)+" unknown (inner file : "+je.transformTo("string",this.fileName)+")");if(this.decompressed=new Fe,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,r),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,r,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=je.transformTo("string",this.decompressed.getContent()),Be.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readData(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=new ze(this.extraFields[1].value);this.uncompressedSize===je.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===je.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===je.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===je.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var e,r,n,i=t.index;for(this.extraFields=this.extraFields||{};t.index<i+this.extraFieldsLength;)e=t.readInt(2),r=t.readInt(2),n=t.readString(r),this.extraFields[e]={id:e,length:r,value:n}},handleUTF8:function(){var t=qe.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=Be.utf8decode(this.fileName),this.fileCommentStr=Be.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=je.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=je.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new ze(t.value);return 1!==e.readInt(1)||Be.crc32(this.fileName)!==e.readInt(4)?null:Be.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new ze(t.value);return 1!==e.readInt(1)||Be.crc32(this.fileComment)!==e.readInt(4)?null:Be.utf8decode(e.readString(t.length-5))}return null}};var Ve=Ae,Xe=Ue,Ge=Re,Ze=De,Ye=xt,$e=kt,We=He,Qe=gt;function Ke(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}Ke.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+Ye.pretty(e)+", expected "+Ye.pretty(t)+")")},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var n=this.reader.readString(4)===e;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=Qe.uint8array?"uint8array":"array",r=Ye.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,n=this.zip64EndOfCentralSize-44;0<n;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature($e.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===$e.CENTRAL_FILE_HEADER;)(t=new We({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature($e.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,$e.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ?"):new Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature($e.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===Ye.MAX_VALUE_16BITS||this.diskWithCentralDirStart===Ye.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===Ye.MAX_VALUE_16BITS||this.centralDirRecords===Ye.MAX_VALUE_16BITS||this.centralDirSize===Ye.MAX_VALUE_32BITS||this.centralDirOffset===Ye.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature($e.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature($e.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,$e.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature($e.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature($e.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=e-r;if(n>0)this.isSignature(e,$e.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){var e=Ye.getTypeOf(t);if(Ye.checkSupport(e),"string"!==e||Qe.uint8array)if("nodebuffer"===e)this.reader=new Xe(t);else if(Qe.uint8array)this.reader=new Ge(Ye.transformTo("uint8array",t));else{if(!Qe.array)throw new Error("Unexpected error: unsupported type '"+e+"'");this.reader=new Ze(Ye.transformTo("array",t))}else this.reader=new Ve(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var Je=dt,tr=Mt,er=xt,rr=Ke,nr=function(t,e){var r,n;(e=er.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:tr.utf8decode})).base64&&(t=Je.decode(t));var i=new rr(t,e),a=i.files;for(r=0;r<a.length;r++)n=a[r],this.file(n.fileNameStr,n.decompressed,{binary:!0,optimizedBinaryString:!0,date:n.date,dir:n.dir,comment:n.fileCommentStr.length?n.fileCommentStr:null,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions,createFolders:e.createFolders});return i.zipComment.length&&(this.comment=i.zipComment),this},ir={},ar=xt;ir.string2binary=function(t){return ar.string2binary(t)},ir.string2Uint8Array=function(t){return ar.transformTo("uint8array",t)},ir.uint8Array2String=function(t){return ar.transformTo("string",t)},ir.string2Blob=function(t){var e=ar.transformTo("arraybuffer",t);return ar.arrayBuffer2Blob(e)},ir.arrayBuffer2Blob=function(t){return ar.arrayBuffer2Blob(t)},ir.transformTo=function(t,e){return ar.transformTo(t,e)},ir.getTypeOf=function(t){return ar.getTypeOf(t)},ir.checkSupport=function(t){return ar.checkSupport(t)},ir.MAX_VALUE_16BITS=ar.MAX_VALUE_16BITS,ir.MAX_VALUE_32BITS=ar.MAX_VALUE_32BITS,ir.pretty=function(t){return ar.pretty(t)},ir.findCompression=function(t){return ar.findCompression(t)},ir.isRegExp=function(t){return ar.isRegExp(t)},function(t){var e=dt;function r(t,e){if(!(this instanceof r))return new r(t,e);this.files={},this.comment=null,this.root="",t&&this.load(t,e),this.clone=function(){var t=this,e=new r;return Object.keys(this.files).forEach(function(r){e.file(r,t.files[r].asUint8Array())}),e},this.shallowClone=function(){var t=new r;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}r.prototype=Ee,r.prototype.load=nr,r.support=gt,r.defaults=Pt,r.utils=ir,r.base64={encode:function(t){return e.encode(t)},decode:function(t){return e.decode(t)}},r.compressions=Ot(),t.exports=r,t.exports.default=r}(ht);var or=pt(ht.exports),sr={exports:{}},lr={},ur={};function cr(t,e){return void 0===e&&(e=Object),e&&"function"==typeof e.getOwnPropertyDescriptors&&(t=e.create(null,e.getOwnPropertyDescriptors(t))),e&&"function"==typeof e.freeze?e.freeze(t):t}function fr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var pr=cr({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0});var hr=cr({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});var dr=cr({script:!1,style:!1,textarea:!0,title:!0});function mr(t){return t===gr.HTML}var gr=cr({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),vr=Object.keys(gr).map(function(t){return gr[t]});var yr=cr({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});ur.assign=function(t,e){if(null===t||"object"!=typeof t)throw new TypeError("target is not an object");for(var r in e)fr(e,r)&&(t[r]=e[r]);return t},ur.find=function(t,e,r){if(void 0===r&&(r=Array.prototype),t&&"function"==typeof r.find)return r.find.call(t,e);for(var n=0;n<t.length;n++)if(fr(t,n)){var i=t[n];if(e.call(void 0,i,n,t))return i}},ur.freeze=cr,ur.HTML_BOOLEAN_ATTRIBUTES=pr,ur.HTML_RAW_TEXT_ELEMENTS=dr,ur.HTML_VOID_ELEMENTS=hr,ur.hasDefaultHTMLNamespace=function(t){return mr(t)||t===gr.XML_XHTML_APPLICATION},ur.hasOwn=fr,ur.isHTMLBooleanAttribute=function(t){return fr(pr,t.toLowerCase())},ur.isHTMLRawTextElement=function(t){var e=t.toLowerCase();return fr(dr,e)&&!dr[e]},ur.isHTMLEscapableRawTextElement=function(t){var e=t.toLowerCase();return fr(dr,e)&&dr[e]},ur.isHTMLMimeType=mr,ur.isHTMLVoidElement=function(t){return fr(hr,t.toLowerCase())},ur.isValidMimeType=function(t){return vr.indexOf(t)>-1},ur.MIME_TYPE=gr,ur.NAMESPACE=yr;var br={};function wr(t,e){t.prototype=Object.create(Error.prototype,{constructor:{value:t},name:{value:t.name,enumerable:!0,writable:e}})}var Er=ur.freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),xr=Object.keys(Er);function _r(t){return"number"==typeof t&&t>=1&&t<=25}function Tr(t,e){var r;_r(t)?(this.name=xr[t],this.message=e||""):(this.message=t,this.name="string"==typeof(r=e)&&r.substring(r.length-Er.Error.length)===Er.Error?e:Er.Error),Error.captureStackTrace&&Error.captureStackTrace(this,Tr)}wr(Tr,!0),Object.defineProperties(Tr.prototype,{code:{enumerable:!0,get:function(){var t=xr.indexOf(this.name);return _r(t)?t:0}}});for(var Nr={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},Sr=Object.entries(Nr),Or=0;Or<Sr.length;Or++){Tr[Sr[Or][0]]=Sr[Or][1]}function Ar(t,e){this.message=t,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Ar)}wr(Ar),br.DOMException=Tr,br.DOMExceptionName=Er,br.ExceptionCode=Nr,br.ParseError=Ar;var Cr={},Ir={};function Dr(t){try{"function"!=typeof t&&(t=RegExp);var e=new t("","u").exec("");return!!e&&2===e[0].length}catch(t){}return!1}var kr=Dr();function Pr(t){if("["!==t.source[0])throw new Error(t+" can not be used with chars");return t.source.slice(1,t.source.lastIndexOf("]"))}function Rr(t,e){if("["!==t.source[0])throw new Error("/"+t.source+"/ can not be used with chars_without");if(!e||"string"!=typeof e)throw new Error(JSON.stringify(e)+" is not a valid search");if(-1===t.source.indexOf(e))throw new Error('"'+e+'" is not is /'+t.source+"/");if("-"===e&&1!==t.source.indexOf(e))throw new Error('"'+e+'" is not at the first postion of /'+t.source+"/");return new RegExp(t.source.replace(e,""),kr?"u":"")}function Lr(t){var e=this;return new RegExp(Array.prototype.slice.call(arguments).map(function(t){var r="string"==typeof t;if(r&&void 0===e&&"|"===t)throw new Error("use regg instead of reg to wrap expressions with `|`!");return r?t:t.source}).join(""),kr?"mu":"m")}function Mr(t){if(0===arguments.length)throw new Error("no parameters provided");return Lr.apply(Mr,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var Ur=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;kr&&(Ur=Lr("[",Pr(Ur),"\\u{10000}-\\u{10FFFF}","]"));var zr=/[\x20\x09\x0D\x0A]/,jr=Pr(zr),Fr=Lr(zr,"+"),Br=Lr(zr,"*"),qr=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;kr&&(qr=Lr("[",Pr(qr),"\\u{10000}-\\u{10FFFF}","]"));var Hr=Lr("[",Pr(qr),Pr(/[-.0-9\xB7]/),Pr(/[\u0300-\u036F\u203F-\u2040]/),"]"),Vr=Lr(qr,Hr,"*"),Xr=Lr(Hr,"+"),Gr=Lr("&",Vr,";"),Zr=Mr(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),Yr=Mr(Gr,"|",Zr),$r=Lr("%",Vr,";"),Wr=Mr(Lr('"',Mr(/[^%&"]/,"|",$r,"|",Yr),"*",'"'),"|",Lr("'",Mr(/[^%&']/,"|",$r,"|",Yr),"*","'")),Qr=Mr('"',Mr(/[^<&"]/,"|",Yr),"*",'"',"|","'",Mr(/[^<&']/,"|",Yr),"*","'"),Kr=Lr(Rr(qr,":"),Rr(Hr,":"),"*"),Jr=Lr(Kr,Mr(":",Kr),"?"),tn=Lr("^",Jr,"$"),en=Lr("(",Jr,")"),rn=Mr(/"[^"]*"|'[^']*'/),nn=Lr(/^<\?/,"(",Vr,")",Mr(Fr,"(",Ur,"*?)"),"?",/\?>/),an=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,on=Mr('"',an,'*"',"|","'",Rr(an,"'"),"*'"),sn="\x3c!--",ln=Lr(sn,Mr(Rr(Ur,"-"),"|",Lr("-",Rr(Ur,"-"))),"*","--\x3e"),un="#PCDATA",cn=Mr(Lr(/\(/,Br,un,Mr(Br,/\|/,Br,Jr),"*",Br,/\)\*/),"|",Lr(/\(/,Br,un,Br,/\)/)),fn=Mr("EMPTY","|","ANY","|",cn,"|",Lr(/\([^>]+\)/,/[?*+]?/)),pn=Lr("<!ELEMENT",Fr,Mr(Jr,"|",$r),Fr,Mr(fn,"|",$r),Br,">"),hn=Lr("NOTATION",Fr,/\(/,Br,Vr,Mr(Br,/\|/,Br,Vr),"*",Br,/\)/),dn=Lr(/\(/,Br,Xr,Mr(Br,/\|/,Br,Xr),"*",Br,/\)/),mn=Mr(hn,"|",dn),gn=Mr(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",mn),vn=Mr(/#REQUIRED|#IMPLIED/,"|",Mr(Mr("#FIXED",Fr),"?",Qr)),yn=Lr("<!ATTLIST",Fr,Vr,Mr(Fr,Vr,Fr,gn,Fr,vn),"*",Br,">"),bn="about:legacy-compat",wn=Mr('"'+bn+'"',"|","'"+bn+"'"),En="SYSTEM",xn="PUBLIC",_n=Mr(Mr(En,Fr,rn),"|",Mr(xn,Fr,on,Fr,rn)),Tn=Lr("^",Mr(Mr(En,Fr,"(?<SystemLiteralOnly>",rn,")"),"|",Mr(xn,Fr,"(?<PubidLiteral>",on,")",Fr,"(?<SystemLiteral>",rn,")"))),Nn=Mr(Fr,"NDATA",Fr,Vr),Sn="<!ENTITY",On=Lr(Sn,Fr,Vr,Fr,Mr(Wr,"|",Mr(_n,Nn,"?")),Br,">"),An=Mr(Wr,"|",_n),Cn=Mr(On,"|",Lr(Sn,Fr,"%",Fr,Vr,Fr,An,Br,">")),In=Lr(xn,Fr,on),Dn=Lr("<!NOTATION",Fr,Vr,Fr,Mr(_n,"|",In),Br,">"),kn=Lr(Br,"=",Br),Pn=/1[.]\d+/,Rn=Lr(Fr,"version",kn,Mr("'",Pn,"'","|",'"',Pn,'"')),Ln=/[A-Za-z][-A-Za-z0-9._]*/,Mn=Lr(/^<\?xml/,Rn,Mr(Fr,"encoding",kn,Mr('"',Ln,'"',"|","'",Ln,"'")),"?",Mr(Fr,"standalone",kn,Mr("'",Mr("yes","|","no"),"'","|",'"',Mr("yes","|","no"),'"')),"?",Br,/\?>/),Un=Lr(Ur,"*?",/\]\]>/),zn=Lr(/<!\[CDATA\[/,Un);Ir.chars=Pr,Ir.chars_without=Rr,Ir.detectUnicodeSupport=Dr,Ir.reg=Lr,Ir.regg=Mr,Ir.ABOUT_LEGACY_COMPAT=bn,Ir.ABOUT_LEGACY_COMPAT_SystemLiteral=wn,Ir.AttlistDecl=yn,Ir.CDATA_START="<![CDATA[",Ir.CDATA_END="]]>",Ir.CDSect=zn,Ir.Char=Ur,Ir.Comment=ln,Ir.COMMENT_START=sn,Ir.COMMENT_END="--\x3e",Ir.DOCTYPE_DECL_START="<!DOCTYPE",Ir.elementdecl=pn,Ir.EntityDecl=Cn,Ir.EntityValue=Wr,Ir.ExternalID=_n,Ir.ExternalID_match=Tn,Ir.Name=Vr,Ir.NotationDecl=Dn,Ir.Reference=Yr,Ir.PEReference=$r,Ir.PI=nn,Ir.PUBLIC=xn,Ir.PubidLiteral=on,Ir.QName=Jr,Ir.QName_exact=tn,Ir.QName_group=en,Ir.S=Fr,Ir.SChar_s=jr,Ir.S_OPT=Br,Ir.SYSTEM=En,Ir.SystemLiteral=rn,Ir.UNICODE_REPLACEMENT_CHARACTER="",Ir.UNICODE_SUPPORT=kr,Ir.XMLDecl=Mn;var jn=ur,Fn=jn.find,Bn=jn.hasDefaultHTMLNamespace,qn=jn.hasOwn,Hn=jn.isHTMLMimeType,Vn=jn.isHTMLRawTextElement,Xn=jn.isHTMLVoidElement,Gn=jn.MIME_TYPE,Zn=jn.NAMESPACE,Yn=Symbol(),$n=br,Wn=$n.DOMException,Qn=$n.DOMExceptionName,Kn=Ir;function Jn(t){if(t!==Yn)throw new TypeError("Illegal constructor")}function ti(t){return""!==t}function ei(t,e){return qn(t,e)||(t[e]=!0),t}function ri(t){if(!t)return[];var e=function(t){return t?t.split(/[\t\n\f\r ]+/).filter(ti):[]}(t);return Object.keys(e.reduce(ei,{}))}function ni(t){if(!Kn.QName_exact.test(t))throw new Wn(Wn.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+t+'"')}function ii(t,e){ni(e),t=t||null;var r=null,n=e;if(e.indexOf(":")>=0){var i=e.split(":");r=i[0],n=i[1]}if(null!==r&&null===t)throw new Wn(Wn.NAMESPACE_ERR,"prefix is non-null and namespace is null");if("xml"===r&&t!==jn.NAMESPACE.XML)throw new Wn(Wn.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if(("xmlns"===r||"xmlns"===e)&&t!==jn.NAMESPACE.XMLNS)throw new Wn(Wn.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(t===jn.NAMESPACE.XMLNS&&"xmlns"!==r&&"xmlns"!==e)throw new Wn(Wn.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[t,r,n]}function ai(t,e){for(var r in t)qn(t,r)&&(e[r]=t[r])}function oi(t,e){var r=t.prototype;if(!(r instanceof e)){function n(){}n.prototype=e.prototype,ai(r,n=new n),t.prototype=r=n}r.constructor!=t&&("function"!=typeof t&&console.error("unknown Class:"+t),r.constructor=t)}var si={},li=si.ELEMENT_NODE=1,ui=si.ATTRIBUTE_NODE=2,ci=si.TEXT_NODE=3,fi=si.CDATA_SECTION_NODE=4,pi=si.ENTITY_REFERENCE_NODE=5,hi=si.ENTITY_NODE=6,di=si.PROCESSING_INSTRUCTION_NODE=7,mi=si.COMMENT_NODE=8,gi=si.DOCUMENT_NODE=9,vi=si.DOCUMENT_TYPE_NODE=10,yi=si.DOCUMENT_FRAGMENT_NODE=11,bi=si.NOTATION_NODE=12,wi=jn.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function Ei(t,e){if(e.length<t.length)return Ei(e,t);var r=null;for(var n in t){if(t[n]!==e[n])return r;r=t[n]}return r}function xi(t){return t.guid||(t.guid=Math.random()),t.guid}function _i(){}function Ti(t,e){this._node=t,this._refresh=e,Ni(this)}function Ni(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!==e){var r=t._refresh(t._node);if(pa(t,"length",r.length),!t.$$length||r.length<t.$$length)for(var n=r.length;n in t;n++)qn(t,n)&&delete t[n];ai(r,t),t._inc=e}}function Si(){}function Oi(t,e){for(var r=0;r<t.length;){if(t[r]===e)return r;r++}}function Ai(t,e,r,n){if(n?e[Oi(e,n)]=r:(e[e.length]=r,e.length++),t){r.ownerElement=t;var i=t.ownerDocument;i&&(n&&Li(i,t,n),function(t,e,r){t&&t._inc++;var n=r.namespaceURI;n===Zn.XMLNS&&(e._nsMap[r.prefix?r.localName:""]=r.value)}(i,t,r))}}function Ci(t,e,r){var n=Oi(e,r);if(n>=0){for(var i=e.length-1;n<=i;)e[n]=e[++n];if(e.length=i,t){var a=t.ownerDocument;a&&Li(a,t,r),r.ownerElement=null}}}function Ii(){}function Di(t){Jn(t)}function ki(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function Pi(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(Pi(t,e))return!0}while(t=t.nextSibling)}function Ri(t,e){Jn(t);var r=e||{};this.ownerDocument=this,this.contentType=r.contentType||Gn.XML_APPLICATION,this.type=Hn(this.contentType)?"html":"xml"}function Li(t,e,r,n){t&&t._inc++,r.namespaceURI===Zn.XMLNS&&delete e._nsMap[r.prefix?r.localName:""]}function Mi(t,e,r){if(t&&t._inc){t._inc++;var n=e.childNodes;if(r&&!r.nextSibling)n[n.length++]=r;else{for(var i=e.firstChild,a=0;i;)n[a++]=i,i=i.nextSibling;n.length=a,delete n[n.length]}}}function Ui(t,e){if(t!==e.parentNode)throw new Wn(Wn.NOT_FOUND_ERR,"child's parent is not parent");var r=e.previousSibling,n=e.nextSibling;return r?r.nextSibling=n:t.firstChild=n,n?n.previousSibling=r:t.lastChild=r,Mi(t.ownerDocument,t),e.parentNode=null,e.previousSibling=null,e.nextSibling=null,e}function zi(t){return t&&t.nodeType===Di.DOCUMENT_TYPE_NODE}function ji(t){return t&&t.nodeType===Di.ELEMENT_NODE}function Fi(t){return t&&t.nodeType===Di.TEXT_NODE}function Bi(t,e){var r=t.childNodes||[];if(Fn(r,ji)||zi(e))return!1;var n=Fn(r,zi);return!(e&&n&&r.indexOf(n)>r.indexOf(e))}function qi(t,e){var r=t.childNodes||[];if(Fn(r,function(t){return ji(t)&&t!==e}))return!1;var n=Fn(r,zi);return!(e&&n&&r.indexOf(n)>r.indexOf(e))}function Hi(t,e,r){if(!function(t){return t&&(t.nodeType===Di.DOCUMENT_NODE||t.nodeType===Di.DOCUMENT_FRAGMENT_NODE||t.nodeType===Di.ELEMENT_NODE)}(t))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+t.nodeType);if(r&&r.parentNode!==t)throw new Wn(Wn.NOT_FOUND_ERR,"child not in parent");if(!function(t){return t&&(t.nodeType===Di.CDATA_SECTION_NODE||t.nodeType===Di.COMMENT_NODE||t.nodeType===Di.DOCUMENT_FRAGMENT_NODE||t.nodeType===Di.DOCUMENT_TYPE_NODE||t.nodeType===Di.ELEMENT_NODE||t.nodeType===Di.PROCESSING_INSTRUCTION_NODE||t.nodeType===Di.TEXT_NODE)}(e)||zi(e)&&t.nodeType!==Di.DOCUMENT_NODE)throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Unexpected node type "+e.nodeType+" for parent node type "+t.nodeType)}function Vi(t,e,r){var n=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===Di.DOCUMENT_FRAGMENT_NODE){var a=i.filter(ji);if(a.length>1||Fn(i,Fi))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!Bi(t,r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(ji(e)&&!Bi(t,r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(zi(e)){if(Fn(n,zi))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var o=Fn(n,ji);if(r&&n.indexOf(o)<n.indexOf(r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!r&&o)throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function Xi(t,e,r){var n=t.childNodes||[],i=e.childNodes||[];if(e.nodeType===Di.DOCUMENT_FRAGMENT_NODE){var a=i.filter(ji);if(a.length>1||Fn(i,Fi))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!qi(t,r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(ji(e)&&!qi(t,r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(zi(e)){function s(t){return zi(t)&&t!==r}if(Fn(n,s))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var o=Fn(n,ji);if(r&&n.indexOf(o)<n.indexOf(r))throw new Wn(Wn.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function Gi(t,e,r,n){Hi(t,e,r),t.nodeType===Di.DOCUMENT_NODE&&(n||Vi)(t,e,r);var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===yi){var a=e.firstChild;if(null==a)return e;var o=e.lastChild}else a=o=e;var s=r?r.previousSibling:t.lastChild;a.previousSibling=s,o.nextSibling=r,s?s.nextSibling=a:t.firstChild=a,null==r?t.lastChild=o:r.previousSibling=o;do{a.parentNode=t}while(a!==o&&(a=a.nextSibling));return Mi(t.ownerDocument||t,t,e),e.nodeType==yi&&(e.firstChild=e.lastChild=null),e}function Zi(t){Jn(t),this._nsMap=Object.create(null)}function Yi(t){Jn(t),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}function $i(t){Jn(t)}function Wi(t){Jn(t)}function Qi(t){Jn(t)}function Ki(t){Jn(t)}function Ji(t){Jn(t)}function ta(t){Jn(t)}function ea(t){Jn(t)}function ra(t){Jn(t)}function na(t){Jn(t)}function ia(t){Jn(t)}function aa(){}function oa(t){var e=[],r=this.nodeType===gi&&this.documentElement||this,n=r.prefix,i=r.namespaceURI;if(i&&null==n&&null==(n=r.lookupPrefix(i)))var a=[{namespace:i,prefix:null}];return ua(this,e,t,a),e.join("")}function sa(t,e,r){var n=t.prefix||"",i=t.namespaceURI;if(!i)return!1;if("xml"===n&&i===Zn.XML||i===Zn.XMLNS)return!1;for(var a=r.length;a--;){var o=r[a];if(o.prefix===n)return o.namespace!==i}return!0}function la(t,e,r){t.push(" ",e,'="',r.replace(/[<>&"\t\n\r]/g,ki),'"')}function ua(t,e,r,n){n||(n=[]);var i="html"===(t.nodeType===gi?t:t.ownerDocument).type;if(r){if(!(t=r(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case li:var a=t.attributes,o=a.length,s=t.firstChild,l=t.tagName,u=l;if(!i&&!t.prefix&&t.namespaceURI){for(var c,f=0;f<a.length;f++)if("xmlns"===a.item(f).name){c=a.item(f).value;break}if(!c)for(var p=n.length-1;p>=0;p--){if(""===(h=n[p]).prefix&&h.namespace===t.namespaceURI){c=h.namespace;break}}if(c!==t.namespaceURI)for(p=n.length-1;p>=0;p--){var h;if((h=n[p]).namespace===t.namespaceURI){h.prefix&&(u=h.prefix+":"+l);break}}}e.push("<",u);for(var d=0;d<o;d++){"xmlns"==(m=a.item(d)).prefix?n.push({prefix:m.localName,namespace:m.value}):"xmlns"==m.nodeName&&n.push({prefix:"",namespace:m.value})}for(d=0;d<o;d++){var m,g,v;if(sa(m=a.item(d),0,n))la(e,(g=m.prefix||"")?"xmlns:"+g:"xmlns",v=m.namespaceURI),n.push({prefix:g,namespace:v});ua(m,e,r,n)}if(l===u&&sa(t,0,n))la(e,(g=t.prefix||"")?"xmlns:"+g:"xmlns",v=t.namespaceURI),n.push({prefix:g,namespace:v});var y=!s;if(y&&(i||t.namespaceURI===Zn.HTML)&&(y=Xn(l)),y)e.push("/>");else{if(e.push(">"),i&&Vn(l))for(;s;)s.data?e.push(s.data):ua(s,e,r,n.slice()),s=s.nextSibling;else for(;s;)ua(s,e,r,n.slice()),s=s.nextSibling;e.push("</",u,">")}return;case gi:case yi:for(s=t.firstChild;s;)ua(s,e,r,n.slice()),s=s.nextSibling;return;case ui:return la(e,t.name,t.value);case ci:return e.push(t.data.replace(/[<&>]/g,ki));case fi:return e.push(Kn.CDATA_START,t.data,Kn.CDATA_END);case mi:return e.push(Kn.COMMENT_START,t.data,Kn.COMMENT_END);case vi:var b=t.publicId,w=t.systemId;return e.push(Kn.DOCTYPE_DECL_START," ",t.name),b?(e.push(" ",Kn.PUBLIC," ",b),w&&"."!==w&&e.push(" ",w)):w&&"."!==w&&e.push(" ",Kn.SYSTEM," ",w),t.internalSubset&&e.push(" [",t.internalSubset,"]"),void e.push(">");case di:return e.push("<?",t.target," ",t.data,"?>");case pi:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function ca(t,e,r){var n;switch(e.nodeType){case li:(n=e.cloneNode(!1)).ownerDocument=t;case yi:break;case ui:r=!0}if(n||(n=e.cloneNode(!1)),n.ownerDocument=t,n.parentNode=null,r)for(var i=e.firstChild;i;)n.appendChild(ca(t,i,r)),i=i.nextSibling;return n}function fa(t,e,r){var n=new e.constructor(Yn);for(var i in e)if(qn(e,i)){var a=e[i];"object"!=typeof a&&a!=n[i]&&(n[i]=a)}switch(e.childNodes&&(n.childNodes=new _i),n.ownerDocument=t,n.nodeType){case li:var o=e.attributes,s=n.attributes=new Si,l=o.length;s._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(fa(t,o.item(u),!0));break;case ui:r=!0}if(r)for(var c=e.firstChild;c;)n.appendChild(fa(t,c,r)),c=c.nextSibling;return n}function pa(t,e,r){t[e]=r}_i.prototype={length:0,item:function(t){return t>=0&&t<this.length?this[t]:null},toString:function(t){for(var e=[],r=0;r<this.length;r++)ua(this[r],e,t);return e.join("")},filter:function(t){return Array.prototype.filter.call(this,t)},indexOf:function(t){return Array.prototype.indexOf.call(this,t)}},_i.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){return e<t.length?{value:t[e++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},Ti.prototype.item=function(t){return Ni(this),this[t]||null},oi(Ti,_i),Si.prototype={length:0,item:_i.prototype.item,getNamedItem:function(t){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase());for(var e=0;e<this.length;){var r=this[e];if(r.nodeName===t)return r;e++}return null},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!==this._ownerElement)throw new Wn(Wn.INUSE_ATTRIBUTE_ERR);var r=this.getNamedItemNS(t.namespaceURI,t.localName);return r===t?t:(Ai(this._ownerElement,this,t,r),r)},setNamedItemNS:function(t){return this.setNamedItem(t)},removeNamedItem:function(t){var e=this.getNamedItem(t);if(!e)throw new Wn(Wn.NOT_FOUND_ERR,t);return Ci(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var r=this.getNamedItemNS(t,e);if(!r)throw new Wn(Wn.NOT_FOUND_ERR,t?t+" : "+e:e);return Ci(this._ownerElement,this,r),r},getNamedItemNS:function(t,e){t||(t=null);for(var r=0;r<this.length;){var n=this[r];if(n.localName===e&&n.namespaceURI===t)return n;r++}return null}},Si.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){return e<t.length?{value:t[e++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},Ii.prototype={hasFeature:function(t,e){return!0},createDocument:function(t,e,r){var n=Gn.XML_APPLICATION;t===Zn.HTML?n=Gn.XML_XHTML_APPLICATION:t===Zn.SVG&&(n=Gn.XML_SVG_IMAGE);var i=new Ri(Yn,{contentType:n});if(i.implementation=this,i.childNodes=new _i,i.doctype=r||null,r&&i.appendChild(r),e){var a=i.createElementNS(t,e);i.appendChild(a)}return i},createDocumentType:function(t,e,r,n){ni(t);var i=new Ji(Yn);return i.name=t,i.nodeName=t,i.publicId=e||"",i.systemId=r||"",i.internalSubset=n||"",i.childNodes=new _i,i},createHTMLDocument:function(t){var e=new Ri(Yn,{contentType:Gn.HTML});if(e.implementation=this,e.childNodes=new _i,!1!==t){e.doctype=this.createDocumentType("html"),e.doctype.ownerDocument=e,e.appendChild(e.doctype);var r=e.createElement("html");e.appendChild(r);var n=e.createElement("head");if(r.appendChild(n),"string"==typeof t){var i=e.createElement("title");i.appendChild(e.createTextNode(t)),n.appendChild(i)}r.appendChild(e.createElement("body"))}return e}},Di.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var t=this.getRootNode();return t&&t.nodeType===t.DOCUMENT_NODE},contains:function(t){if(!t)return!1;var e=t;do{if(this===e)return!0;e=t.parentNode}while(e);return!1},getRootNode:function(t){var e=this;do{if(!e.parentNode)return e;e=e.parentNode}while(e)},isEqualNode:function(t){if(!t)return!1;if(this.nodeType!==t.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==t.name)return!1;if(this.publicId!==t.publicId)return!1;if(this.systemId!==t.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==t.namespaceURI)return!1;if(this.prefix!==t.prefix)return!1;if(this.localName!==t.localName)return!1;if(this.attributes.length!==t.attributes.length)return!1;for(var e=0;e<this.attributes.length;e++){var r=this.attributes.item(e);if(!r.isEqualNode(t.getAttributeNodeNS(r.namespaceURI,r.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==t.namespaceURI)return!1;if(this.localName!==t.localName)return!1;if(this.value!==t.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==t.target||this.data!==t.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==t.data)return!1}if(this.childNodes.length!==t.childNodes.length)return!1;for(e=0;e<this.childNodes.length;e++)if(!this.childNodes[e].isEqualNode(t.childNodes[e]))return!1;return!0},isSameNode:function(t){return this===t},insertBefore:function(t,e){return Gi(this,t,e)},replaceChild:function(t,e){Gi(this,t,e,Xi),e&&this.removeChild(e)},removeChild:function(t){return Ui(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return fa(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==ci&&t.nodeType==ci?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},lookupPrefix:function(t){for(var e=this;e;){var r=e._nsMap;if(r)for(var n in r)if(qn(r,n)&&r[n]===t)return n;e=e.nodeType==ui?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var r=e._nsMap;if(r&&qn(r,t))return r[t];e=e.nodeType==ui?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)},compareDocumentPosition:function(t){if(this===t)return 0;var e=t,r=this,n=null,i=null;if(e instanceof Yi&&(e=(n=e).ownerElement),r instanceof Yi&&(r=(i=r).ownerElement,n&&e&&r===e))for(var a,o=0;a=r.attributes[o];o++){if(a===n)return wi.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+wi.DOCUMENT_POSITION_PRECEDING;if(a===i)return wi.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+wi.DOCUMENT_POSITION_FOLLOWING}if(!e||!r||r.ownerDocument!==e.ownerDocument)return wi.DOCUMENT_POSITION_DISCONNECTED+wi.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(xi(r.ownerDocument)>xi(e.ownerDocument)?wi.DOCUMENT_POSITION_FOLLOWING:wi.DOCUMENT_POSITION_PRECEDING);if(i&&e===r)return wi.DOCUMENT_POSITION_CONTAINS+wi.DOCUMENT_POSITION_PRECEDING;if(n&&e===r)return wi.DOCUMENT_POSITION_CONTAINED_BY+wi.DOCUMENT_POSITION_FOLLOWING;for(var s=[],l=e.parentNode;l;){if(!i&&l===r)return wi.DOCUMENT_POSITION_CONTAINED_BY+wi.DOCUMENT_POSITION_FOLLOWING;s.push(l),l=l.parentNode}s.reverse();for(var u=[],c=r.parentNode;c;){if(!n&&c===e)return wi.DOCUMENT_POSITION_CONTAINS+wi.DOCUMENT_POSITION_PRECEDING;u.push(c),c=c.parentNode}u.reverse();var f=Ei(s,u);for(var p in f.childNodes){var h=f.childNodes[p];if(h===r)return wi.DOCUMENT_POSITION_FOLLOWING;if(h===e)return wi.DOCUMENT_POSITION_PRECEDING;if(u.indexOf(h)>=0)return wi.DOCUMENT_POSITION_FOLLOWING;if(s.indexOf(h)>=0)return wi.DOCUMENT_POSITION_PRECEDING}return 0}},ai(si,Di),ai(si,Di.prototype),ai(wi,Di),ai(wi,Di.prototype),Ri.prototype={implementation:null,nodeName:"#document",nodeType:gi,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType===yi){for(var r=t.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,e),r=n}return t}return Gi(this,t,e),t.ownerDocument=this,null===this.documentElement&&t.nodeType===li&&(this.documentElement=t),t},removeChild:function(t){var e=Ui(this,t);return e===this.documentElement&&(this.documentElement=null),e},replaceChild:function(t,e){Gi(this,t,e,Xi),t.ownerDocument=this,e&&this.removeChild(e),ji(t)&&(this.documentElement=t)},importNode:function(t,e){return ca(this,t,e)},getElementById:function(t){var e=null;return Pi(this.documentElement,function(r){if(r.nodeType==li&&r.getAttribute("id")==t)return e=r,!0}),e},createElement:function(t){var e=new Zi(Yn);return e.ownerDocument=this,"html"===this.type&&(t=t.toLowerCase()),Bn(this.contentType)&&(e.namespaceURI=Zn.HTML),e.nodeName=t,e.tagName=t,e.localName=t,e.childNodes=new _i,(e.attributes=new Si)._ownerElement=e,e},createDocumentFragment:function(){var t=new na(Yn);return t.ownerDocument=this,t.childNodes=new _i,t},createTextNode:function(t){var e=new Wi(Yn);return e.ownerDocument=this,e.childNodes=new _i,e.appendData(t),e},createComment:function(t){var e=new Qi(Yn);return e.ownerDocument=this,e.childNodes=new _i,e.appendData(t),e},createCDATASection:function(t){var e=new Ki(Yn);return e.ownerDocument=this,e.childNodes=new _i,e.appendData(t),e},createProcessingInstruction:function(t,e){var r=new ia(Yn);return r.ownerDocument=this,r.childNodes=new _i,r.nodeName=r.target=t,r.nodeValue=r.data=e,r},createAttribute:function(t){if(!Kn.QName_exact.test(t))throw new Wn(Wn.INVALID_CHARACTER_ERR,'invalid character in name "'+t+'"');return"html"===this.type&&(t=t.toLowerCase()),this._createAttribute(t)},_createAttribute:function(t){var e=new Yi(Yn);return e.ownerDocument=this,e.childNodes=new _i,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){if(!Kn.Name.test(t))throw new Wn(Wn.INVALID_CHARACTER_ERR,'not a valid xml name "'+t+'"');if("html"===this.type)throw new Wn("document is an html document",Qn.NotSupportedError);var e=new ra(Yn);return e.ownerDocument=this,e.childNodes=new _i,e.nodeName=t,e},createElementNS:function(t,e){var r=ii(t,e),n=new Zi(Yn),i=n.attributes=new Si;return n.childNodes=new _i,n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],i._ownerElement=n,n},createAttributeNS:function(t,e){var r=ii(t,e),n=new Yi(Yn);return n.ownerDocument=this,n.childNodes=new _i,n.nodeName=e,n.name=e,n.specified=!0,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],n}},oi(Ri,Di),Zi.prototype={nodeType:li,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return"html"===this.ownerDocument.type&&this.namespaceURI===Zn.HTML},hasAttributes:function(){return!(!this.attributes||!this.attributes.length)},hasAttribute:function(t){return!!this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e?e.value:null},getAttributeNode:function(t){return this._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase()),this.attributes.getNamedItem(t)},setAttribute:function(t,e){this._isInHTMLDocumentAndNamespace()&&(t=t.toLowerCase());var r=this.getAttributeNode(t);r?r.value=r.nodeValue=""+e:((r=this.ownerDocument._createAttribute(t)).value=r.nodeValue=""+e,this.setAttributeNode(r))},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);return r?r.value:null},setAttributeNS:function(t,e,r){var n=ii(t,e)[2],i=this.getAttributeNodeNS(t,n);i?i.value=i.nodeValue=""+r:((i=this.ownerDocument.createAttributeNS(t,e)).value=i.nodeValue=""+r,this.setAttributeNode(i))},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByClassName:function(t){var e=ri(t);return new Ti(this,function(r){var n=[];return e.length>0&&Pi(r,function(i){if(i!==r&&i.nodeType===li){var a=i.getAttribute("class");if(a){var o=t===a;if(!o){var s=ri(a);o=e.every((l=s,function(t){return l&&-1!==l.indexOf(t)}))}o&&n.push(i)}}var l}),n})},getElementsByTagName:function(t){var e="html"===(this.nodeType===gi?this:this.ownerDocument).type,r=t.toLowerCase();return new Ti(this,function(n){var i=[];return Pi(n,function(a){a!==n&&a.nodeType===li&&(("*"===t||a.getQualifiedName()===(e&&a.namespaceURI===Zn.HTML?r:t))&&i.push(a))}),i})},getElementsByTagNameNS:function(t,e){return new Ti(this,function(r){var n=[];return Pi(r,function(i){i===r||i.nodeType!==li||"*"!==t&&i.namespaceURI!==t||"*"!==e&&i.localName!=e||n.push(i)}),n})}},Ri.prototype.getElementsByClassName=Zi.prototype.getElementsByClassName,Ri.prototype.getElementsByTagName=Zi.prototype.getElementsByTagName,Ri.prototype.getElementsByTagNameNS=Zi.prototype.getElementsByTagNameNS,oi(Zi,Di),Yi.prototype.nodeType=ui,oi(Yi,Di),$i.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,r){r=this.data.substring(0,t)+r+this.data.substring(t+e),this.nodeValue=this.data=r,this.length=r.length}},oi($i,Di),Wi.prototype={nodeName:"#text",nodeType:ci,splitText:function(t){var e=this.data,r=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},oi(Wi,$i),Qi.prototype={nodeName:"#comment",nodeType:mi},oi(Qi,$i),Ki.prototype={nodeName:"#cdata-section",nodeType:fi},oi(Ki,Wi),Ji.prototype.nodeType=vi,oi(Ji,Di),ta.prototype.nodeType=bi,oi(ta,Di),ea.prototype.nodeType=hi,oi(ea,Di),ra.prototype.nodeType=pi,oi(ra,Di),na.prototype.nodeName="#document-fragment",na.prototype.nodeType=yi,oi(na,Di),ia.prototype.nodeType=di,oi(ia,$i),aa.prototype.serializeToString=function(t,e){return oa.call(t,e)},Di.prototype.toString=oa;try{if(Object.defineProperty){function gf(t){switch(t.nodeType){case li:case yi:var e=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&e.push(gf(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}}Object.defineProperty(Ti.prototype,"length",{get:function(){return Ni(this),this.$$length}}),Object.defineProperty(Di.prototype,"textContent",{get:function(){return gf(this)},set:function(t){switch(this.nodeType){case li:case yi:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),pa=function(t,e,r){t["$$"+e]=r}}}catch(vf){}Cr._updateLiveList=Ni,Cr.Attr=Yi,Cr.CDATASection=Ki,Cr.CharacterData=$i,Cr.Comment=Qi,Cr.Document=Ri,Cr.DocumentFragment=na,Cr.DocumentType=Ji,Cr.DOMImplementation=Ii,Cr.Element=Zi,Cr.Entity=ea,Cr.EntityReference=ra,Cr.LiveNodeList=Ti,Cr.NamedNodeMap=Si,Cr.Node=Di,Cr.NodeList=_i,Cr.Notation=ta,Cr.Text=Wi,Cr.ProcessingInstruction=ia,Cr.XMLSerializer=aa;var ha={},da={};!function(t){var e=ur.freeze;t.XML_ENTITIES=e({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=e({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),t.entityMap=t.HTML_ENTITIES}(da);var ma={},ga=ur,va=Ir,ya=br,ba=ga.isHTMLEscapableRawTextElement,wa=ga.isHTMLMimeType,Ea=ga.isHTMLRawTextElement,xa=ga.hasOwn,_a=ga.NAMESPACE,Ta=ya.ParseError,Na=ya.DOMException;function Sa(){}Sa.prototype={parse:function(t,e,r){var n=this.domBuilder;n.startDocument(),ka(e,e=Object.create(null)),function(t,e,r,n,i){var a=wa(n.mimeType);t.indexOf(va.UNICODE_REPLACEMENT_CHARACTER)>=0&&i.warning("Unicode replacement character detected, source encoding issues?");function o(t){if(t>65535){var e=55296+((t-=65536)>>10),r=56320+(1023&t);return String.fromCharCode(e,r)}return String.fromCharCode(t)}function s(t){var e=";"===t[t.length-1]?t:t+";";if(!a&&e!==t)return i.error("EntityRef: expecting ;"),t;var n=va.Reference.exec(e);if(!n||n[0].length!==e.length)return i.error("entity not matching Reference production: "+t),t;var s=e.slice(1,-1);return xa(r,s)?r[s]:"#"===s.charAt(0)?o(parseInt(s.substring(1).replace("x","0x"))):(i.error("entity not found:"+t),t)}function l(e){if(e>g){var r=t.substring(g,e).replace(Oa,s);p&&h(g),n.characters(r,0,e-g),g=e}}var u=0,c=0,f=/\r\n?|\n|$/g,p=n.locator;function h(e,r){for(;e>=c&&(r=f.exec(t));)u=c,c=r.index+r[0].length,p.lineNumber++;p.columnNumber=e-u+1}var d=[{currentNSMap:e}],m=[],g=0;for(;;){try{var v=t.indexOf("<",g);if(v<0){if(!a&&m.length>0)return i.fatalError("unclosed xml tag(s): "+m.join(", "));if(!t.substring(g).match(/^\s*$/)){var y=n.doc,b=y.createTextNode(t.substring(g));if(y.documentElement)return i.error("Extra content at the end of the document");y.appendChild(b),n.currentElement=b}return}if(v>g){var w=t.substring(g,v);a||0!==m.length||(w=w.replace(new RegExp(va.S_OPT.source,"g"),""))&&i.error("Unexpected content outside root element: '"+w+"'"),l(v)}switch(t.charAt(v+1)){case"/":var E=t.indexOf(">",v+2),x=t.substring(v+2,E>0?E:void 0);if(!x)return i.fatalError("end tag name missing");var _=E>0&&va.reg("^",va.QName_group,va.S_OPT,"$").exec(x);if(!_)return i.fatalError('end tag name contains invalid characters: "'+x+'"');if(!n.currentElement&&!n.doc.documentElement)return;var T=m[m.length-1]||n.currentElement.tagName||n.doc.documentElement.tagName||"";if(T!==_[1]){var N=_[1].toLowerCase();if(!a||T.toLowerCase()!==N)return i.fatalError('Opening and ending tag mismatch: "'+T+'" != "'+x+'"')}var S=d.pop();m.pop();var O=S.localNSMap;if(n.endElement(S.uri,S.localName,T),O)for(var A in O)xa(O,A)&&n.endPrefixMapping(A);E++;break;case"?":p&&h(v),E=La(t,v,n,i);break;case"!":p&&h(v),E=Ra(t,v,n,i,a);break;default:p&&h(v);var C=new Ma,I=d[d.length-1].currentNSMap,D=(E=Ca(t,v,C,I,s,i,a),C.length);if(C.closed||(a&&ga.isHTMLVoidElement(C.tagName)?C.closed=!0:m.push(C.tagName)),p&&D){for(var k=Aa(p,{}),P=0;P<D;P++){var R=C[P];h(R.offset),R.locator=Aa(p,{})}n.locator=k,Ia(C,n,I)&&d.push(C),n.locator=p}else Ia(C,n,I)&&d.push(C);a&&!C.closed?E=Da(t,E,C.tagName,s,n):E++}}catch(t){if(t instanceof Ta)throw t;if(t instanceof Na)throw new Ta(t.name+": "+t.message,n.locator,t);i.error("element parse error: "+t),E=-1}E>g?g=E:l(Math.max(v,g)+1)}}(t,e,r,n,this.errorHandler),n.endDocument()}};var Oa=/&#?\w+;?/g;function Aa(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function Ca(t,e,r,n,i,a,o){function s(t,e,n){return xa(r.attributeNames,t)?a.fatalError("Attribute "+t+" redefined"):!o&&e.indexOf("<")>=0?a.fatalError("Unescaped '<' not allowed in attributes values"):void r.addValue(t,e.replace(/[\t\n\r]/g," ").replace(Oa,i),n)}for(var l,u=++e,c=0;;){var f=t.charAt(u);switch(f){case"=":if(1===c)l=t.slice(e,u),c=3;else{if(2!==c)throw new Error("attribute equal must after attrName");c=3}break;case"'":case'"':if(3===c||1===c){if(1===c&&(a.warning('attribute value must after "="'),l=t.slice(e,u)),e=u+1,!((u=t.indexOf(f,e))>0))throw new Error("attribute value no end '"+f+"' match");s(l,p=t.slice(e,u),e-1),c=5}else{if(4!=c)throw new Error('attribute value must after "="');s(l,p=t.slice(e,u),e),a.warning('attribute "'+l+'" missed start quot('+f+")!!"),e=u+1,c=5}break;case"/":switch(c){case 0:r.setTagName(t.slice(e,u));case 5:case 6:case 7:c=7,r.closed=!0;case 4:case 1:break;case 2:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==c&&r.setTagName(t.slice(e,u)),u;case">":switch(c){case 0:r.setTagName(t.slice(e,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(p=t.slice(e,u)).slice(-1)&&(r.closed=!0,p=p.slice(0,-1));case 2:2===c&&(p=l),4==c?(a.warning('attribute "'+p+'" missed quot(")!'),s(l,p,e)):(o||a.warning('attribute "'+p+'" missed value!! "'+p+'" instead!!'),s(p,p,e));break;case 3:if(!o)return a.fatalError("AttValue: ' or \" expected")}return u;case"":f=" ";default:if(f<=" ")switch(c){case 0:r.setTagName(t.slice(e,u)),c=6;break;case 1:l=t.slice(e,u),c=2;break;case 4:var p=t.slice(e,u);a.warning('attribute "'+p+'" missed quot(")!!'),s(l,p,e);case 5:c=6}else switch(c){case 2:o||a.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),s(l,l,e),e=u,c=1;break;case 5:a.warning('attribute space is required"'+l+'"!!');case 6:c=1,e=u;break;case 3:c=4,e=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function Ia(t,e,r){for(var n=t.tagName,i=null,a=t.length;a--;){var o=t[a],s=o.qName,l=o.value;if((p=s.indexOf(":"))>0)var u=o.prefix=s.slice(0,p),c=s.slice(p+1),f="xmlns"===u&&c;else c=s,u=null,f="xmlns"===s&&"";o.localName=c,!1!==f&&(null==i&&(i=Object.create(null),ka(r,r=Object.create(null))),r[f]=i[f]=l,o.uri=_a.XMLNS,e.startPrefixMapping(f,l))}for(a=t.length;a--;)(o=t[a]).prefix&&("xml"===o.prefix&&(o.uri=_a.XML),"xmlns"!==o.prefix&&(o.uri=r[o.prefix]));var p;(p=n.indexOf(":"))>0?(u=t.prefix=n.slice(0,p),c=t.localName=n.slice(p+1)):(u=null,c=t.localName=n);var h=t.uri=r[u||""];if(e.startElement(h,c,n,t),!t.closed)return t.currentNSMap=r,t.localNSMap=i,!0;if(e.endElement(h,c,n),i)for(u in i)xa(i,u)&&e.endPrefixMapping(u)}function Da(t,e,r,n,i){var a=ba(r);if(a||Ea(r)){var o=t.indexOf("</"+r+">",e),s=t.substring(e+1,o);return a&&(s=s.replace(Oa,n)),i.characters(s,0,s.length),o}return e+1}function ka(t,e){for(var r in t)xa(t,r)&&(e[r]=t[r])}function Pa(t,e){var r=e;function n(e){return e=e||0,t.charAt(r+e)}function i(t){r+=t=t||1}function a(){return t.substring(r)}return{char:n,getIndex:function(){return r},getMatch:function(t){var e=va.reg("^",t).exec(a());return e?(i(e[0].length),e[0]):null},getSource:function(){return t},skip:i,skipBlanks:function(){for(var e=0;r<t.length;){var a=n();if(" "!==a&&"\n"!==a&&"\t"!==a&&"\r"!==a)return e;e++,i()}return-1},substringFromIndex:a,substringStartsWith:function(e){return t.substring(r,r+e.length)===e},substringStartsWithCaseInsensitive:function(e){return t.substring(r,r+e.length).toUpperCase()===e.toUpperCase()}}}function Ra(t,e,r,n,i){var a=Pa(t,e);switch(i?a.char(2).toUpperCase():a.char(2)){case"-":var o=a.getMatch(va.Comment);return o?(r.comment(o,va.COMMENT_START.length,o.length-va.COMMENT_START.length-va.COMMENT_END.length),a.getIndex()):n.fatalError("comment is not well-formed at position "+a.getIndex());case"[":var s=a.getMatch(va.CDSect);return s?i||r.currentElement?(r.startCDATA(),r.characters(s,va.CDATA_START.length,s.length-va.CDATA_START.length-va.CDATA_END.length),r.endCDATA(),a.getIndex()):n.fatalError("CDATA outside of element"):n.fatalError("Invalid CDATA starting at position "+e);case"D":if(r.doc&&r.doc.documentElement)return n.fatalError("Doctype not allowed inside or after documentElement at position "+a.getIndex());if(i?!a.substringStartsWithCaseInsensitive(va.DOCTYPE_DECL_START):!a.substringStartsWith(va.DOCTYPE_DECL_START))return n.fatalError("Expected "+va.DOCTYPE_DECL_START+" at position "+a.getIndex());if(a.skip(va.DOCTYPE_DECL_START.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+va.DOCTYPE_DECL_START+" at position "+a.getIndex());var l={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(l.name=a.getMatch(va.Name),!l.name)return n.fatalError("doctype name missing or contains unexpected characters at position "+a.getIndex());if(i&&"html"!==l.name.toLowerCase()&&n.warning("Unexpected DOCTYPE in HTML document at position "+a.getIndex()),a.skipBlanks(),a.substringStartsWith(va.PUBLIC)||a.substringStartsWith(va.SYSTEM)){var u=va.ExternalID_match.exec(a.substringFromIndex());if(!u)return n.fatalError("doctype external id is not well-formed at position "+a.getIndex());void 0!==u.groups.SystemLiteralOnly?l.systemId=u.groups.SystemLiteralOnly:(l.systemId=u.groups.SystemLiteral,l.publicId=u.groups.PubidLiteral),a.skip(u[0].length)}else if(i&&a.substringStartsWithCaseInsensitive(va.SYSTEM)){if(a.skip(va.SYSTEM.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+va.SYSTEM+" at position "+a.getIndex());if(l.systemId=a.getMatch(va.ABOUT_LEGACY_COMPAT_SystemLiteral),!l.systemId)return n.fatalError("Expected "+va.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+va.SYSTEM+" at position "+a.getIndex())}return i&&l.systemId&&!va.ABOUT_LEGACY_COMPAT_SystemLiteral.test(l.systemId)&&n.warning("Unexpected doctype.systemId in HTML document at position "+a.getIndex()),i||(a.skipBlanks(),l.internalSubset=function(t,e){function r(t,e){var r=va.PI.exec(t.substringFromIndex());return r?"xml"===r[1].toLowerCase()?e.fatalError("xml declaration is only allowed at the start of the document, but found at position "+t.getIndex()):(t.skip(r[0].length),r[0]):e.fatalError("processing instruction is not well-formed at position "+t.getIndex())}var n=t.getSource();if("["===t.char()){t.skip(1);for(var i=t.getIndex();t.getIndex()<n.length;){if(t.skipBlanks(),"]"===t.char()){var a=n.substring(i,t.getIndex());return t.skip(1),a}var o=null;if("<"===t.char()&&"!"===t.char(1))switch(t.char(2)){case"E":"L"===t.char(3)?o=t.getMatch(va.elementdecl):"N"===t.char(3)&&(o=t.getMatch(va.EntityDecl));break;case"A":o=t.getMatch(va.AttlistDecl);break;case"N":o=t.getMatch(va.NotationDecl);break;case"-":o=t.getMatch(va.Comment)}else if("<"===t.char()&&"?"===t.char(1))o=r(t,e);else{if("%"!==t.char())return e.fatalError("Error detected in Markup declaration");o=t.getMatch(va.PEReference)}if(!o)return e.fatalError("Error in internal subset at position "+t.getIndex())}return e.fatalError("doctype internal subset is not well-formed, missing ]")}}(a,n)),a.skipBlanks(),">"!==a.char()?n.fatalError("doctype not terminated with > at position "+a.getIndex()):(a.skip(1),r.startDTD(l.name,l.publicId,l.systemId,l.internalSubset),r.endDTD(),a.getIndex());default:return n.fatalError('Not well-formed XML starting with "<!" at position '+e)}}function La(t,e,r,n){var i=t.substring(e).match(va.PI);if(!i)return n.fatalError("Invalid processing instruction starting at position "+e);if("xml"===i[1].toLowerCase()){if(e>0)return n.fatalError("processing instruction at position "+e+" is an xml declaration which is only at the start of the document");if(!va.XMLDecl.test(t.substring(e)))return n.fatalError("xml declaration is not well-formed")}return r.processingInstruction(i[1],i[2]),e+i[0].length}function Ma(){this.attributeNames=Object.create(null)}Ma.prototype={setTagName:function(t){if(!va.QName_exact.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},addValue:function(t,e,r){if(!va.QName_exact.test(t))throw new Error("invalid attribute:"+t);this.attributeNames[t]=this.length,this[this.length++]={qName:t,value:e,offset:r}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},ma.XMLReader=Sa,ma.parseUtils=Pa,ma.parseDoctypeCommentOrCData=Ra;var Ua=ur,za=br,ja=da,Fa=ma,Ba=Cr.DOMImplementation,qa=Ua.hasDefaultHTMLNamespace,Ha=Ua.isHTMLMimeType,Va=Ua.isValidMimeType,Xa=Ua.MIME_TYPE,Ga=Ua.NAMESPACE,Za=za.ParseError,Ya=Fa.XMLReader;function $a(t){return t.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028\u2029]/g,"\n")}function Wa(t){if(void 0===(t=t||{}).locator&&(t.locator=!0),this.assign=t.assign||Ua.assign,this.domHandler=t.domHandler||Qa,this.onError=t.onError||t.errorHandler,t.errorHandler&&"function"!=typeof t.errorHandler)throw new TypeError("errorHandler object is no longer supported, switch to onError!");t.errorHandler&&t.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=t.normalizeLineEndings||$a,this.locator=!!t.locator,this.xmlns=this.assign(Object.create(null),t.xmlns)}function Qa(t){var e=t||{};this.mimeType=e.mimeType||Xa.XML_APPLICATION,this.defaultNamespace=e.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=e.onError}function Ka(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function Ja(t,e,r){return"string"==typeof t?t.substr(e,r):t.length>=e+r||e?new java.lang.String(t,e,r)+"":t}function to(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}Wa.prototype.parseFromString=function(t,e){if(!Va(e))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+e+'" is not valid.');var r=this.assign(Object.create(null),this.xmlns),n=ja.XML_ENTITIES,i=r[""]||null;qa(e)?(n=ja.HTML_ENTITIES,i=Ga.HTML):e===Xa.XML_SVG_IMAGE&&(i=Ga.SVG),r[""]=i,r.xml=r.xml||Ga.XML;var a=new this.domHandler({mimeType:e,defaultNamespace:i,onError:this.onError}),o=this.locator?{}:void 0;this.locator&&a.setDocumentLocator(o);var s=new Ya;return s.errorHandler=a,s.domBuilder=a,!Ua.isHTMLMimeType(e)&&"string"!=typeof t&&s.errorHandler.fatalError("source is not a string"),s.parse(this.normalizeLineEndings(String(t)),r,n),a.doc.documentElement||s.errorHandler.fatalError("missing root element"),a.doc},Qa.prototype={startDocument:function(){var t=new Ba;this.doc=Ha(this.mimeType)?t.createHTMLDocument(!1):t.createDocument(this.defaultNamespace,"")},startElement:function(t,e,r,n){var i=this.doc,a=i.createElementNS(t,r||e),o=n.length;to(this,a),this.currentElement=a,this.locator&&Ka(this.locator,a);for(var s=0;s<o;s++){t=n.getURI(s);var l=n.getValue(s),u=(r=n.getQName(s),i.createAttributeNS(t,r));this.locator&&Ka(n.getLocator(s),u),u.value=u.nodeValue=l,a.setAttributeNode(u)}},endElement:function(t,e,r){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var r=this.doc.createProcessingInstruction(t,e);this.locator&&Ka(this.locator,r),to(this,r)},ignorableWhitespace:function(t,e,r){},characters:function(t,e,r){if(t=Ja.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(t);else n=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(t)&&this.doc.appendChild(n),this.locator&&Ka(this.locator,n)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){t&&(t.lineNumber=0),this.locator=t},comment:function(t,e,r){t=Ja.apply(this,arguments);var n=this.doc.createComment(t);this.locator&&Ka(this.locator,n),to(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,r,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var a=i.createDocumentType(t,e,r,n);this.locator&&Ka(this.locator,a),to(this,a),this.doc.doctype=a}},reportError:function(t,e){if("function"==typeof this.onError)try{this.onError(t,e,this)}catch(r){throw new Za("Reporting "+t+' "'+e+'" caused '+r,this.locator)}else console.error("[xmldom "+t+"]\t"+e,function(t){if(t)return"\n@#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}(this.locator))},warning:function(t){this.reportError("warning",t)},error:function(t){this.reportError("error",t)},fatalError:function(t){throw this.reportError("fatalError",t),new Za(t,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){Qa.prototype[t]=function(){return null}}),ha.__DOMHandler=Qa,ha.DOMParser=Wa,ha.normalizeLineEndings=$a,ha.onErrorStopParsing=function(t){if("error"===t)throw"onErrorStopParsing"},ha.onWarningStopParsing=function(){throw"onWarningStopParsing"};var eo=ur;lr.assign=eo.assign,lr.hasDefaultHTMLNamespace=eo.hasDefaultHTMLNamespace,lr.isHTMLMimeType=eo.isHTMLMimeType,lr.isValidMimeType=eo.isValidMimeType,lr.MIME_TYPE=eo.MIME_TYPE,lr.NAMESPACE=eo.NAMESPACE;var ro=br;lr.DOMException=ro.DOMException,lr.DOMExceptionName=ro.DOMExceptionName,lr.ExceptionCode=ro.ExceptionCode,lr.ParseError=ro.ParseError;var no=Cr;lr.Attr=no.Attr,lr.CDATASection=no.CDATASection,lr.CharacterData=no.CharacterData,lr.Comment=no.Comment,lr.Document=no.Document,lr.DocumentFragment=no.DocumentFragment,lr.DocumentType=no.DocumentType,lr.DOMImplementation=no.DOMImplementation,lr.Element=no.Element,lr.Entity=no.Entity,lr.EntityReference=no.EntityReference,lr.LiveNodeList=no.LiveNodeList,lr.NamedNodeMap=no.NamedNodeMap,lr.Node=no.Node,lr.NodeList=no.NodeList,lr.Notation=no.Notation,lr.ProcessingInstruction=no.ProcessingInstruction,lr.Text=no.Text,lr.XMLSerializer=no.XMLSerializer;var io=ha;lr.DOMParser=io.DOMParser,lr.normalizeLineEndings=io.normalizeLineEndings,lr.onErrorStopParsing=io.onErrorStopParsing,lr.onWarningStopParsing=io.onWarningStopParsing;var ao,oo,so={last:function(t){return t[t.length-1]},first:function(t){return t[0]}};function lo(){if(oo)return ao;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function r(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}oo=1;var n=so.last,i=so.first;function a(t){this.name="GenericError",this.message=t,this.stack=new Error(t).stack}function o(t){this.name="TemplateError",this.message=t,this.stack=new Error(t).stack}function s(t){this.name="RenderingError",this.message=t,this.stack=new Error(t).stack}function l(t){this.name="ScopeParserError",this.message=t,this.stack=new Error(t).stack}function u(t){this.name="InternalError",this.properties={explanation:"InternalError"},this.message=t,this.stack=new Error(t).stack}function c(t){this.name="APIVersionError",this.properties={explanation:"APIVersionError"},this.message=t,this.stack=new Error(t).stack}return a.prototype=Error.prototype,o.prototype=new a,s.prototype=new a,l.prototype=new a,u.prototype=new a,c.prototype=new a,ao={XTError:a,XTTemplateError:o,XTInternalError:u,XTScopeParserError:l,XTAPIVersionError:c,RenderingError:s,XTRenderingError:s,getClosingTagNotMatchOpeningTag:function(t){var e=t.tags,r=new o("Closing tag does not match opening tag");return r.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'.concat(e[0].value,'" is closed by the tag "').concat(e[1].value,'"'),openingtag:i(e).value,offset:[i(e).offset,n(e).offset],closingtag:n(e).value},i(e).square&&(r.properties.square=[i(e).square,n(e).square]),r},getLoopPositionProducesInvalidXMLError:function(t){var e=t.tag,r=t.offset,n=new o('The position of the loop tags "'.concat(e,'" would produce invalid XML'));return n.properties={xtag:e,id:"loop_position_invalid",explanation:'The tags "'.concat(e,'" are misplaced in the document, for example one of them is in a table and the other one outside the table'),offset:r},n},getScopeCompilationError:function(t){var e=t.tag,r=t.rootError,n=t.offset,i=new l("Scope parser compilation failed");return i.properties={id:"scopeparser_compilation_failed",offset:n,xtag:e,explanation:'The scope parser for the tag "'.concat(e,'" failed to compile'),rootError:r},i},getScopeParserExecutionError:function(t){var e=t.tag,r=t.scope,n=t.error,i=t.offset,a=new l("Scope parser execution failed");return a.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag ".concat(e," failed to execute"),scope:r,offset:i,xtag:e,rootError:n},a},getUnclosedTagException:function(t){var e=new o("Unclosed tag");return e.properties={xtag:i(t.xtag.split(" ")).substr(1),id:"unclosed_tag",context:t.xtag,offset:t.offset,lIndex:t.lIndex,explanation:'The tag beginning with "'.concat(t.xtag.substr(0,10),'" is unclosed')},e},getUnopenedTagException:function(t){var e=new o("Unopened tag");return e.properties={xtag:n(t.xtag.split(" ")),id:"unopened_tag",context:t.xtag,offset:t.offset,lIndex:t.lIndex,explanation:'The tag beginning with "'.concat(t.xtag.substr(0,10),'" is unopened')},e},getUnmatchedLoopException:function(t){var e=t.location,r=t.offset,n=t.square,i="start"===e?"unclosed":"unopened",a=new o("".concat("start"===e?"Unclosed":"Unopened"," loop")),s=t.value;return a.properties={id:"".concat(i,"_loop"),explanation:'The loop with tag "'.concat(s,'" is ').concat(i),xtag:s,offset:r},n&&(a.properties.square=n),a},getDuplicateCloseTagException:function(t){var e=new o("Duplicate close tag, expected one close tag");return e.properties={xtag:i(t.xtag.split(" ")),id:"duplicate_close_tag",context:t.xtag,offset:t.offset,lIndex:t.lIndex,explanation:'The tag ending with "'.concat(t.xtag.substr(0,10),'" has duplicate close tags')},e},getDuplicateOpenTagException:function(t){var e=new o("Duplicate open tag, expected one open tag");return e.properties={xtag:i(t.xtag.split(" ")),id:"duplicate_open_tag",context:t.xtag,offset:t.offset,lIndex:t.lIndex,explanation:'The tag beginning with "'.concat(t.xtag.substr(0,10),'" has duplicate open tags')},e},getCorruptCharactersException:function(t){var e=t.tag,r=t.value,n=t.offset,i=new s("There are some XML corrupt characters");return i.properties={id:"invalid_xml_characters",xtag:e,value:r,offset:n,explanation:"There are some corrupt characters for the field ".concat(e)},i},getInvalidRawXMLValueException:function(t){var e=t.tag,r=t.value,n=t.offset,i=new s("Non string values are not allowed for rawXML tags");return i.properties={id:"invalid_raw_xml_value",xtag:e,value:r,offset:n,explanation:"The value of the raw tag : '".concat(e,"' is not a string")},i},getUnbalancedLoopException:function(t,e){var r=new o("Unbalanced loop tag"),n=e[0].part.value,i=e[1].part.value,a=t[0].part.value,s=t[1].part.value;return r.properties={id:"unbalanced_loop_tags",explanation:"Unbalanced loop tags {#".concat(n,"}{/").concat(i,"}{#").concat(a,"}{/").concat(s,"}"),offset:[e[0].part.offset,t[1].part.offset],lastPair:{left:e[0].part.value,right:e[1].part.value},pair:{left:t[0].part.value,right:t[1].part.value}},r},throwApiVersionError:function(t,n){var i=new c(t);throw i.properties=function(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach(function(e){r(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({id:"api_version_error"},n),i},throwFileTypeNotHandled:function(t){var e=new u('The filetype "'.concat(t,'" is not handled by docxtemplater'));throw e.properties={id:"filetype_not_handled",explanation:'The file you are trying to generate is of type "'.concat(t,'", but only docx and pptx formats are handled'),fileType:t},e},throwFileTypeNotIdentified:function(t){var e=Object.keys(t.files).slice(0,10),r="";r=0===e.length?"Empty zip file":"Zip file contains : ".concat(e.join(","));var n=new u("The filetype for this file could not be identified, is this file corrupted ? ".concat(r));throw n.properties={id:"filetype_not_identified",explanation:"The filetype for this file could not be identified, is this file corrupted ? ".concat(r)},n},throwMalformedXml:function(){var t=new u("Malformed xml");throw t.properties={explanation:"The template contains malformed xml",id:"malformed_xml"},t},throwMultiError:function(t){var e=new o("Multi error");throw e.properties={errors:t,id:"multi_error",explanation:"The template has multiple errors"},e},throwExpandNotFound:function(t){var e=t.part,r=e.value,n=e.offset,i=t.id,a=void 0===i?"raw_tag_outerxml_invalid":i,s=t.message,l=void 0===s?"Raw tag not in paragraph":s,u=t.part,c=t.explanation,f=void 0===c?'The tag "'.concat(r,'" is not inside a paragraph'):c;"function"==typeof f&&(f=f(u));var p=new o(l);throw p.properties={id:a,explanation:f,rootError:t.rootError,xtag:r,offset:n,postparsed:t.postparsed,expandTo:t.expandTo,index:t.index},p},throwRawTagShouldBeOnlyTextInParagraph:function(t){var e=new o("Raw tag should be the only text in paragraph"),r=t.part.value;throw e.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The raw tag "'.concat(r,'" should be the only text in this paragraph. This means that this tag should not be surrounded by any text or spaces.'),xtag:r,offset:t.part.offset,paragraphParts:t.paragraphParts},e},throwUnimplementedTagType:function(t,e){var r='Unimplemented tag type "'.concat(t.type,'"');t.module&&(r+=' "'.concat(t.module,'"'));var n=new o(r);throw n.properties={part:t,index:e,id:"unimplemented_tag_type"},n},throwXmlTagNotFound:function(t){var e=new o('No tag "'.concat(t.element,'" was found at the ').concat(t.position)),r=t.parsed[t.index];throw e.properties={id:"no_xml_tag_found_at_".concat(t.position),explanation:'No tag "'.concat(t.element,'" was found at the ').concat(t.position),offset:r.offset,part:r,parsed:t.parsed,index:t.index,element:t.element},e},throwXmlInvalid:function(t,e){var r=new o("An XML file has invalid xml");throw r.properties={id:"file_has_invalid_xml",content:t,offset:e,explanation:"The docx contains invalid XML, it is most likely corrupt"},r},throwResolveBeforeCompile:function(){var t=new u("You must run `.compile()` before running `.resolveData()`");throw t.properties={id:"resolve_before_compile",explanation:"You must run `.compile()` before running `.resolveData()`"},t},throwRenderInvalidTemplate:function(){var t=new u("You should not call .render on a document that had compilation errors");throw t.properties={id:"render_on_invalid_template",explanation:"You should not call .render on a document that had compilation errors"},t},throwRenderTwice:function(){var t=new u("You should not call .render twice on the same docxtemplater instance");throw t.properties={id:"render_twice",explanation:"You should not call .render twice on the same docxtemplater instance"},t}},ao}function uo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return co(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?co(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function co(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var fo=lr,po=fo.DOMParser,ho=fo.XMLSerializer,mo=lo().throwXmlTagNotFound,go=so.last,vo=so.first;function yo(t){return{get:function(e){return"."===t?e:e?e[t]:e}}}var bo={};var wo=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&apos;"]],Eo=wo.map(function(t){var e=uo(t,2),r=e[0],n=e[1];return{rstart:new RegExp(n,"g"),rend:new RegExp(r,"g"),start:n,end:r}});var xo=new RegExp(String.fromCharCode(160),"g");function _o(t,e){return t==="</"+e+">"}function To(t,e){return 0===t.indexOf("<"+e)&&-1!==[">"," ","/"].indexOf(t[e.length+1])}function No(t,e,r){"string"==typeof e&&(e=[e]);for(var n=1,i=r,a=t.length;i<a;i++)for(var o=t[i],s=0,l=e;s<l.length;s++){var u=l[s];if(_o(o.value,u)&&n--,To(o.value,u)&&n++,0===n)return i}return null}function So(t,e,r){"string"==typeof e&&(e=[e]);for(var n=1,i=r;i>=0;i--)for(var a=t[i],o=0,s=e;o<s.length;o++){var l=s[o];if(To(a.value,l)&&n--,_o(a.value,l)&&n++,0===n)return i}return null}var Oo=/[\x00-\x08\x0B\x0C\x0E-\x1F]/g;var Ao={endsWith:function(t,e){return-1!==t.indexOf(e,t.length-e.length)},startsWith:function(t,e){return t.substring(0,e.length)===e},isContent:function(t){var e=t.type,r=t.position;return"placeholder"===e||"content"===e&&"insidetag"===r},isParagraphStart:function(t){var e=t.type,r=t.tag,n=t.position;return-1!==["w:p","a:p","text:p"].indexOf(r)&&"tag"===e&&"start"===n},isParagraphEnd:function(t){var e=t.type,r=t.tag,n=t.position;return-1!==["w:p","a:p","text:p"].indexOf(r)&&"tag"===e&&"end"===n},isTagStart:function(t,e){var r=e.type,n=e.tag,i=e.position;return"tag"===r&&n===t&&("start"===i||"selfclosing"===i)},isTagEnd:function(t,e){var r=e.type,n=e.tag,i=e.position;return"tag"===r&&n===t&&"end"===i},isTextStart:function(t){var e=t.type,r=t.position;return t.text&&"tag"===e&&"start"===r},isTextEnd:function(t){var e=t.type,r=t.position;return t.text&&"tag"===e&&"end"===r},isStarting:To,isEnding:_o,isModule:function(t,e){var r=t.module,n=t.type;return e instanceof Array||(e=[e]),"placeholder"===n&&-1!==e.indexOf(r)},uniq:function(t){for(var e={},r=[],n=0,i=t.length;n<i;++n)e[t[n]]||(e[t[n]]=!0,r.push(t[n]));return r},getDuplicates:function(t){for(var e=[],r={},n=[],i=0,a=t.length;i<a;++i)r[t[i]]?e.push(t[i]):(r[t[i]]=!0,n.push(t[i]));return e},chunkBy:function(t,e){for(var r=[[]],n=0;n<t.length;n++){var i=t[n],a=r[r.length-1],o=e(i);"start"===o?r.push([i]):"end"===o?(a.push(i),r.push([])):a.push(i)}for(var s=[],l=0;l<r.length;l++){var u=r[l];u.length>0&&s.push(u)}return s},last:go,first:vo,xml2str:function(t){return(new ho).serializeToString(t).replace(/xmlns(:[a-z0-9]+)?="" ?/g,"")},str2xml:function(t){return 65279===t.charCodeAt(0)&&(t=t.substr(1)),(new po).parseFromString(t,"text/xml")},getRightOrNull:No,getRight:function(t,e,r){var n=No(t,e,r);if(null!==n)return n;mo({position:"right",element:e,parsed:t,index:r})},getLeftOrNull:So,getLeft:function(t,e,r){var n=So(t,e,r);if(null!==n)return n;mo({position:"left",element:e,parsed:t,index:r})},pregMatchAll:function(t,e){for(var r,n=[];null!=(r=t.exec(e));)n.push({array:r,offset:r.index});return n},convertSpaces:function(t){return t.replace(xo," ")},charMapRegexes:Eo,hasCorruptCharacters:function(t){return Oo.lastIndex=0,Oo.test(t)},removeCorruptCharacters:function(t){return"string"!=typeof t&&(t=String(t)),t.replace(Oo,"")},getDefaults:function(){return{errorLogging:"json",stripInvalidXMLChars:!1,paragraphLoop:!1,nullGetter:function(t){return t.module?"":"undefined"},xmlFileNames:["[Content_Types].xml"],parser:yo,linebreaks:!1,fileTypeConfig:null,delimiters:{start:"{",end:"}"},syntax:{changeDelimiterPrefix:"="}}},wordToUtf8:function(t){for(var e=Eo.length-1;e>=0;e--){var r=Eo[e];t=t.replace(r.rstart,r.end)}return t},utf8ToWord:function(t){var e,r;t=null!==(e=t)&&void 0!==e&&e.toString?t.toString():"";for(var n=0,i=Eo.length;n<i;n++)r=Eo[n],t=t.replace(r.rend,r.start);return t},concatArrays:function(t){for(var e=[],r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;i++){var a=n[i];e.push(a)}return e},pushArray:function(t,e){if(!e)return t;for(var r=0,n=e.length;r<n;r++)t.push(e[r]);return t},invertMap:function(t){var e={};for(var r in t){var n=t[r];e[n]||(e[n]=[]),e[n].push(r)}return e},charMap:wo,getSingleAttribute:function(t,e){var r=t.indexOf(" ".concat(e,'="'));if(-1===r)return null;var n=t.substr(r).search(/["']/)+r,i=t.substr(n+1).search(/["']/)+n;return t.substr(n+1,i-n)},setSingleAttribute:function(t,e,r){var n;if(bo[e]?n=bo[e]:(n=new RegExp("(<.* ".concat(e,'=")([^"]*)(".*)$')),bo[e]=n),n.test(t))return t.replace(n,"$1".concat(r,"$3"));var i=t.lastIndexOf("/>");return-1===i&&(i=t.lastIndexOf(">")),t.substr(0,i)+" ".concat(e,'="').concat(r,'"')+t.substr(i)},isWhiteSpace:function(t){return/^[ \n\r\t]+$/.test(t)},stableSort:function(t,e){return t.map(function(t,e){return{item:t,index:e}}).sort(function(t,r){return e(t.item,r.item)||t.index-r.index}).map(function(t){return t.item})}};function Co(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Io(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Io(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Io(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Do(t){return Do="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(t)}function ko(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Po(n.key),n)}}function Po(t){var e=function(t,e){if("object"!=Do(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Do(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==Do(e)?e:e+""}var Ro,Lo,Mo,Uo,zo,jo,Fo,Bo,qo,Ho,Vo,Xo,Go,Zo,Yo,$o,Wo,Qo,Ko,Jo,ts,es,rs,ns,is,as,os,ss,ls,us,cs,fs,ps,hs,ds,ms,gs,vs,ys,bs,ws,Es,xs,_s,Ts,Ns,Ss,Os,As,Cs,Is,Ds,ks,Ps,Rs=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e=t,n=[{key:"createSchema",value:function(e){return{validate:e,optional:function(){return t.createSchema(function(t){return void 0===t?{success:!0,value:t}:e(t)})},nullable:function(){return t.createSchema(function(t){return null==t?{success:!0,value:t}:e(t)})}}}},{key:"string",value:function(){return t.createSchema(function(t){return"string"!=typeof t?{success:!1,error:"Expected string, received ".concat(Do(t))}:{success:!0,value:t}})}},{key:"date",value:function(){return t.createSchema(function(t){return t instanceof Date?{success:!0,value:t}:{success:!1,error:"Expected date, received ".concat(Do(t))}})}},{key:"boolean",value:function(){return t.createSchema(function(t){return"boolean"!=typeof t?{success:!1,error:"Expected boolean, received ".concat(Do(t))}:{success:!0,value:t}})}},{key:"number",value:function(){return t.createSchema(function(t){return"number"!=typeof t?{success:!1,error:"Expected number, received ".concat(Do(t))}:{success:!0,value:t}})}},{key:"function",value:function(){return t.createSchema(function(t){return"function"!=typeof t?{success:!1,error:"Expected function, received ".concat(Do(t))}:{success:!0,value:t}})}},{key:"array",value:function(e){return t.createSchema(function(t){if(!Array.isArray(t))return{success:!1,error:"Expected array, received ".concat(Do(t))};for(var r=0;r<t.length;r++){var n=e.validate(t[r]);if(!n.success)return{success:!1,error:"".concat(n.error," at index ").concat(r)}}return{success:!0,value:t}})}},{key:"any",value:function(){return t.createSchema(function(t){return{success:!0,value:t}})}},{key:"isRegex",value:function(){return t.createSchema(function(t){return t instanceof RegExp?{success:!0,value:t}:{success:!1,error:"Expected RegExp, received ".concat(Do(t))}})}},{key:"union",value:function(e){return t.createSchema(function(t){for(var r=0;r<e.length;r++){var n=e[r].validate(t);if(n.success)return n}return{success:!1,error:"Value ".concat(t," does not match any schema in union")}})}},{key:"object",value:function(e){var r=t.createSchema(function(t){if(null===t||"object"!==Do(t))return{success:!1,error:"Expected object, received ".concat(Do(t))};for(var r=0,n=Object.entries(e);r<n.length;r++){var i=Co(n[r],2),a=i[0],o=i[1].validate(t[a]);if(!o.success)return{success:!1,error:"".concat(o.error," at ").concat(a)}}return{success:!0,value:t}});return r.strict=function(){return t.createSchema(function(t){var n=r.validate(t);if(!n.success)return n;var i=Object.keys(t).filter(function(t){return!(t in e)});return i.length>0?{success:!1,error:"Unexpected properties: ".concat(i.join(", "))}:n})},r}},{key:"record",value:function(e){return t.createSchema(function(t){if(null===t||"object"!==Do(t))return{success:!1,error:"Expected object, received ".concat(Do(t))};for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];if("string"!=typeof i)return{success:!1,error:"Expected string key, received ".concat(Do(i)," at ").concat(i)};var a=e.validate(t[i]);if(!a.success)return{success:!1,error:"".concat(a.error," at key ").concat(i)}}return{success:!0,value:t}})}}],(r=null)&&ko(e.prototype,r),n&&ko(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}(),Ls=Rs;function Ms(){if(jo)return zo;jo=1;var t=lo().XTInternalError;function e(){}function r(t){return t}return zo=function(n){var i={set:e,matchers:function(){return[]},parse:e,render:e,getTraits:e,getFileType:e,nullGetter:e,optionsTransformer:r,postrender:r,errorsTransformer:r,getRenderedMap:r,preparse:r,postparse:r,on:e,resolve:e,preResolve:e};if(Object.keys(i).every(function(t){return!n[t]})){var a=new t("This module cannot be wrapped, because it doesn't define any of the necessary functions");throw a.properties={id:"module_cannot_be_wrapped",explanation:"This module cannot be wrapped, because it doesn't define any of the necessary functions"},a}for(var o in i)n[o]||(n[o]=i[o]);return n},zo}function Us(){if(Bo)return Fo;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){s(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function s(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}Bo=1;var l=Ao.getRightOrNull,u=Ao.getRight,c=Ao.getLeft,f=Ao.getLeftOrNull,p=Ao.chunkBy,h=Ao.isTagStart,d=Ao.isTagEnd,m=Ao.isContent,g=Ao.last,v=Ao.first,y=lo(),b=y.XTTemplateError,w=y.throwExpandNotFound,E=y.getLoopPositionProducesInvalidXMLError;function x(t,e){return 0!==t.length&&0===g(t).substr(1).indexOf(e)}function _(t,e,r,n){var i=t.expandTo||n.expandTo;if(i){var a,s;try{s=c(r,i,e),a=u(r,i,e)}catch(a){var l=o({part:t,rootError:a,postparsed:r,expandTo:i,index:e},n.error);if(n.onError)if("ignore"===n.onError(l))return;w(l)}return[s,a]}}function T(t,e,n,i){var a=r(t,2),o=a[0],s=a[1],l=n.indexOf(e),u=n.slice(o,l),c=n.slice(l+1,s+1),f=i.getInner({postparse:i.postparse,index:l,part:e,leftParts:u,rightParts:c,left:o,right:s,postparsed:n});return f.length||(f.expanded=[u,c],f=[f]),{left:o,right:s,inner:f}}return Fo={expandToOne:function(t,n){var i=[];t.errors&&(i=t.errors,t=t.postparsed);for(var a=[],s=0,l=t.length;s<l;s++){var u=t[s];if("placeholder"===u.type&&u.module===n.moduleName&&!u.subparsed&&!u.expanded)try{var c=_(u,s,t,n);if(!c)continue;var f=r(c,2),p=f[0],h=f[1];a.push({left:p,right:h,part:u,i:s,leftPart:t[p],rightPart:t[h]})}catch(t){i.push(t)}}a.sort(function(t,e){return t.left===e.left?e.part.lIndex<t.part.lIndex?1:-1:e.left<t.left?1:-1});for(var d=-1,m=0,g=0,v=a.length;g<v;g++){var y,w=a[g];if(d=Math.max(d,g>0?a[g-1].right:0),!(w.left<d)){var E=void 0;try{E=T([w.left+m,w.right+m],w.part,t,n)}catch(e){if(n.onError)if("ignore"===n.onError(o({part:w.part,rootError:e,postparsed:t,expandOne:T},n.errors)))continue;if(!(e instanceof b))throw e;i.push(e)}E&&(m+=E.inner.length-(E.right+1-E.left),(y=t).splice.apply(y,[E.left,E.right+1-E.left].concat(e(E.inner))))}}return{postparsed:t,errors:i}},getExpandToDefault:function(t,e,r){var n=function(t){for(var e=[],r=0;r<t.length;r++){var n=t[r],i=n.position,a=n.value,o=n.tag;o&&("end"===i?x(e,o)?e.pop():e.push(a):"start"===i&&e.push(a))}return e}(t.slice(e[0].offset,e[1].offset));if(n.filter(function(t){return"/"===t[1]}).length!==n.filter(function(t){return"/"!==t[1]&&"/"!==t[t.length-2]}).length)return{error:E({tag:v(e).part.value,offset:[v(e).part.offset,g(e).part.offset]})};for(var i,a=function(){var i=r[o],a=i.contains,s=i.expand,u=i.onlyTextInTag;if(function(t,e){for(var r=0;r<e.length;r++)if(0===e[r].indexOf("<".concat(t)))return!0;return!1}(a,n)){if(u){var c=f(t,a,e[0].offset),y=l(t,a,e[1].offset);if(null===c||null===y)return 0;var b=p(t.slice(c,y),function(t){return h(a,t)?"start":d(a,t)?"end":null}),w=v(b),E=g(b),x=w.filter(m),_=E.filter(m);if(1!==x.length||1!==_.length)return 0}return{v:{value:s}}}},o=0;o<r.length;o++)if(0!==(i=a())&&i)return i.v;return{}}},Fo}function zs(){if(Ho)return qo;Ho=1;var t=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml","application/vnd.ms-word.template.macroEnabledTemplate.main+xml"],e={main:t,docx:["application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"].concat(t,["application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml"]),pptx:["application/vnd.openxmlformats-officedocument.presentationml.slide+xml","application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml","application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml","application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml","application/vnd.ms-excel.sheet.macroEnabled.main+xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"]};return qo=e}function js(){if(Xo)return Vo;Xo=1;return Vo={settingsContentType:"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",coreContentType:"application/vnd.openxmlformats-package.core-properties+xml",appContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml",customContentType:"application/vnd.openxmlformats-officedocument.custom-properties+xml",diagramDataContentType:"application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml",diagramDrawingContentType:"application/vnd.ms-office.drawingml.diagramDrawing+xml"}}function Fs(){if(Zo)return Go;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}Zo=1;var n=Ao.pushArray,i=Ms(),a=zs(),o=js(),s=[o.settingsContentType,o.coreContentType,o.appContentType,o.customContentType,o.diagramDataContentType,o.diagramDrawingContentType],l=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="Common"},r=[{key:"getFileType",value:function(t){var e=t.doc,r=e.invertedContentTypes;if(r){for(var i=0;i<s.length;i++){var o=s[i];r[o]&&n(e.targets,r[o])}for(var l,u=["docx","pptx","xlsx"],c=0;c<u.length;c++){for(var f=u[c],p=a[f],h=0;h<p.length;h++){var d=p[h];if(r[d])for(var m=0,g=r[d];m<g.length;m++){var v=g[m];e.relsTypes[v]&&-1===["http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument"].indexOf(e.relsTypes[v])||(l=f,-1===a.main.indexOf(d)&&d!==a.pptx[0]||e.textTarget||(e.textTarget=v),"xlsx"!==l&&e.targets.push(v))}}if(l)return l}return l}}}],r&&e(t.prototype,r),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,i}();return Go=function(){return i(new l)}}function Bs(){if($o)return Yo;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}$o=1;var n=lo().getScopeParserExecutionError,i=so.last,a=Ao.concatArrays;function o(t,e){for(var r,n=t.length>>>0,i=0;i<n;i++)if(r=t[i],e.call(this,r,i,t))return r}function s(t,e,r){var i,a,l=this,u=this.scopeList[r];if(this.root.finishedResolving){for(var c=this.resolved,f=function(){var t=l.scopeLindex[p];c=(c=o(c,function(e){return e.lIndex===t})).value[l.scopePathItem[p]]},p=this.resolveOffset,h=this.scopePath.length;p<h;p++)f();return o(c,function(t){return e.part.lIndex===t.lIndex}).value}a=this.cachedParsers&&e.part?this.cachedParsers[e.part.lIndex]?this.cachedParsers[e.part.lIndex]:this.cachedParsers[e.part.lIndex]=this.parser(t,{tag:e.part,scopePath:this.scopePath}):this.parser(t,{tag:e.part,scopePath:this.scopePath});try{i=a.get(u,this.getContext(e,r))}catch(r){throw n({tag:t,scope:u,error:r,offset:e.part.offset})}return null==i&&r>0?s.call(this,t,e,r-1):i}function l(t,e,r){var i,a=this,o=this.scopeList[r];return i=this.cachedParsers&&e.part?this.cachedParsers[e.part.lIndex]?this.cachedParsers[e.part.lIndex]:this.cachedParsers[e.part.lIndex]=this.parser(t,{tag:e.part,scopePath:this.scopePath}):this.parser(t,{tag:e.part,scopePath:this.scopePath}),Promise.resolve().then(function(){return i.get(o,a.getContext(e,r))}).catch(function(r){throw n({tag:t,scope:o,error:r,offset:e.part.offset})}).then(function(n){return null==n&&r>0?l.call(a,t,e,r-1):n})}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.root=e.root||this,this.resolveOffset=e.resolveOffset||0,this.scopePath=e.scopePath,this.scopePathItem=e.scopePathItem,this.scopePathLength=e.scopePathLength,this.scopeList=e.scopeList,this.scopeType="",this.scopeTypes=e.scopeTypes,this.scopeLindex=e.scopeLindex,this.parser=e.parser,this.resolved=e.resolved,this.cachedParsers=e.cachedParsers}return r=t,n=[{key:"loopOver",value:function(t,e,r,n){return this.loopOverValue(this.getValue(t,n),e,r)}},{key:"functorIfInverted",value:function(t,e,r,n,i){return t&&e(r,n,i),t}},{key:"isValueFalsy",value:function(t,e){return null==t||!t||"[object Array]"===e&&0===t.length}},{key:"loopOverValue",value:function(t,e,r){this.root.finishedResolving&&(r=!1);var n=Object.prototype.toString.call(t);if(this.isValueFalsy(t,n))return this.scopeType=!1,this.functorIfInverted(r,e,i(this.scopeList),0,1);if("[object Array]"===n){this.scopeType="array";for(var a=0;a<t.length;a++)this.functorIfInverted(!r,e,t[a],a,t.length);return!0}return"[object Object]"===n?(this.scopeType="object",this.functorIfInverted(!r,e,t,0,1)):this.functorIfInverted(!r,e,i(this.scopeList),0,1)}},{key:"getValue",value:function(t,e){var r=s.call(this,t,e,this.scopeList.length-1);return"function"==typeof r?r(this.scopeList[this.scopeList.length-1],this):r}},{key:"getValueAsync",value:function(t,e){var r=this;return l.call(this,t,e,this.scopeList.length-1).then(function(t){return"function"==typeof t?t(r.scopeList[r.scopeList.length-1],r):t})}},{key:"getContext",value:function(t,e){return{num:e,meta:t,scopeList:this.scopeList,resolved:this.resolved,scopePath:this.scopePath,scopeTypes:this.scopeTypes,scopePathItem:this.scopePathItem,scopePathLength:this.scopePathLength}}},{key:"createSubScopeManager",value:function(e,r,n,i,o){return new t({root:this.root,resolveOffset:this.resolveOffset,resolved:this.resolved,parser:this.parser,cachedParsers:this.cachedParsers,scopeTypes:a([this.scopeTypes,[this.scopeType]]),scopeList:a([this.scopeList,[e]]),scopePath:a([this.scopePath,[r]]),scopePathItem:a([this.scopePathItem,[n]]),scopePathLength:a([this.scopePathLength,[o]]),scopeLindex:a([this.scopeLindex,[i.lIndex]])})}}],n&&e(r.prototype,n),o&&e(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}();return Yo=function(t){return t.scopePath=[],t.scopePathItem=[],t.scopePathLength=[],t.scopeTypes=[],t.scopeLindex=[],t.scopeList=[t.tags],new u(t)}}function qs(){if(Qo)return Wo;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach(function(e){a(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function a(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}Qo=1;var o=lo(),s=o.getUnclosedTagException,l=o.getUnopenedTagException,u=o.getDuplicateOpenTagException,c=o.getDuplicateCloseTagException,f=o.throwMalformedXml,p=o.throwXmlInvalid,h=o.XTTemplateError,d=Ao.isTextStart,m=Ao.isTextEnd,g=Ao.wordToUtf8,v=Ao.pushArray;function y(t,e){return t[0]<=e.offset&&e.offset<t[1]}function b(t,e){return d(t)?(e&&f(),!0):m(t)?(e||f(),!1):e}function w(t){var e="",r=1,n=t.indexOf(" ");return"/"===t[t.length-2]?(e="selfclosing",-1===n&&(n=t.length-2)):"/"===t[1]?(r=2,e="end",-1===n&&(n=t.length-1)):(e="start",-1===n&&(n=t.length-1)),{tag:t.slice(r,n),position:e}}function E(t,e){return-1===t&&-1===e?0:t===e?1:-1===t||-1===e?e<t?2:3:t<e?2:3}function x(t){var r=t.split(" ");if(2!==r.length){var n=new h("New Delimiters cannot be parsed");throw n.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},n}var i=e(r,2),a=i[0],o=i[1];if(0===a.length||0===o.length){var s=new h("New Delimiters cannot be parsed");throw s.properties={id:"change_delimiters_invalid",explanation:"Cannot parser delimiters"},s}return[a,o]}function _(t,r,n){var a=t.map(function(t){return t.value}).join(""),o=function(t,r,n){var i=[],a=r.start,o=r.end,s=-1,l=!1;if(null==a&&null==o)return[];for(;;){var u=t.indexOf(a,s+1),c=t.indexOf(o,s+1),f=null,p=void 0,h=E(u,c);switch(1===h&&(h=l?3:2),h){case 0:return i;case 3:l=!1,s=c,f="end",p=o.length;break;case 2:l=!0,s=u,f="start",p=a.length}if(n.changeDelimiterPrefix&&2===h&&t[s+a.length]===n.changeDelimiterPrefix){i.push({offset:u,position:"start",length:a.length,changedelimiter:!0});var d=t.indexOf(n.changeDelimiterPrefix,s+a.length+1),m=t.indexOf(o,d+1);i.push({offset:m,position:"end",length:o.length,changedelimiter:!0});var g=e(x(t.substr(s+a.length+1,d-s-a.length-1)),2);a=g[0],o=g[1],s=m}else i.push({offset:s,position:f,length:p})}}(a,r,n),f=0,p=t.map(function(t){return{offset:(f+=t.value.length)-t.value.length,lIndex:t.lIndex}}),h=function(t,e,r){var n,a=[],o=!1,f={offset:0},p=t.reduce(function(t,p){var h=p.position,d=p.offset,m=f.offset,v=f.length;if(n=e.substr(m,d-m),o&&"start"===h){if(m+v===d&&(n=e.substr(m,d-m+v+4),!r.allowUnclosedTag))return a.push(u({xtag:n,offset:m})),f=p,t.push(i(i({},p),{},{error:!0})),t;if(!r.allowUnclosedTag)return a.push(s({xtag:g(n),offset:m})),f=p,t.push(i(i({},p),{},{error:!0})),t;t.pop()}return o||"end"!==h?(o="start"===h,f=p,t.push(p),t):r.allowUnopenedTag?t:m+v===d?(n=e.substr(m-4,d-m+v+4),a.push(c({xtag:n,offset:m})),f=p,t.push(i(i({},p),{},{error:!0})),t):(a.push(l({xtag:n,offset:d})),f=p,t.push(i(i({},p),{},{error:!0})),t)},[]);if(o){var h=f.offset;n=e.substr(h,e.length-h),r.allowUnclosedTag?p.pop():a.push(s({xtag:g(n),offset:h}))}return{delimiterWithErrors:p,errors:a}}(o,a,n),d=h.delimiterWithErrors,m=h.errors,v=0,b=0,w=p.map(function(e,r){for(var n=e.offset,i=[n,n+t[r].value.length],a=t[r].value,o=[];b<d.length&&y(i,d[b]);)o.push(d[b]),b++;var s=[],l=0;v>0&&(l=v,v=0);for(var u=0;u<o.length;u++){var c=o[u],f=a.substr(l,c.offset-n-l);if(c.changedelimiter)"start"===c.position?f.length>0&&s.push({type:"content",value:f}):l=c.offset-n+c.length;else{f.length>0&&(s.push({type:"content",value:f}),l+=f.length);var p={type:"delimiter",position:c.position,offset:l+n};s.push(p),l=c.offset-n+c.length}}v=l-a.length;var h=a.substr(l);return h.length>0&&s.push({type:"content",value:h}),s},this);return{parsed:w,errors:m}}function T(t){return"content"===t.type&&"insidetag"===t.position}return Wo={parseDelimiters:_,parse:function(t,e,r,n){!function(t,e){for(var r=!1,n=0;n<t.length;n++){var i=t[n];r=b(i,r),"content"===i.type&&(i.position=r?"insidetag":"outsidetag"),"text"!==e&&T(i)&&(i.value=i.value.replace(/>/g,"&gt;"))}}(t,n);for(var i=_(t.filter(T),e,r),a=i.parsed,o=i.errors,s=[],l=0,u=0,c=0;c<t.length;c++){var f=t[c];if(T(f)){for(var p=0,h=a[l];p<h.length;p++){var d=h[p];"content"===d.type&&(d.position="insidetag"),d.lIndex=u++}v(s,a[l]),l++}else f.lIndex=u++,s.push(f)}return{errors:o,lexed:s}},xmlparse:function(t,e){for(var r=function(t,e,r){for(var n=0,i=t.length,a={},o=0;o<e.length;o++)a[e[o]]=!0;for(var s=0;s<r.length;s++)a[r[s]]=!1;for(var l=[];n<i&&-1!==(n=t.indexOf("<",n));){var u=n,c=t.indexOf("<",n+1);(-1===(n=t.indexOf(">",n))||-1!==c&&n>c)&&p(t,u);var f=t.slice(u,n+1),h=w(f),d=h.tag,m=h.position,g=a[d];null!=g&&l.push({type:"tag",position:m,text:g,offset:u,value:f,tag:d})}return l}(t,e.text,e.other),n=0,i=[],a=0;a<r.length;a++){var o=r[a];t.length>n&&o.offset-n>0&&i.push({type:"content",value:t.substr(n,o.offset-n)}),n=o.offset+o.value.length,delete o.offset,i.push(o)}return t.length>n&&i.push({type:"content",value:t.substr(n)}),i}},Wo}function Hs(){if(Jo)return Ko;function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t){return"placeholder"===t.type}return Jo=1,Ko={getTags:function(e){var n={},i=[{items:e.filter(r),parents:[],path:[]}];function a(e,r,n){n.length&&i.push({items:n,parents:[].concat(t(r.parents),[e]),path:!1===e.dataBound||e.attrParsed||!e.value||e.attrParsed?t(r.path):[].concat(t(r.path),[e.value])})}function o(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=t,i=0;i<r;i++)n=n[e[i]];return n}function s(t,e){for(var r=e.length,n=0;n<e.length;n++){var i=e[n];("number"==typeof i.lIndex?i.lIndex:parseInt(i.lIndex.split("-")[0],10))>t.lIndex&&r--}return r}for(;i.length>0;)for(var l=i.pop(),u=o(n,l.path),c=0,f=l.items;c<f.length;c++){var p,h,d,m,g=f[c];if(g.attrParsed)for(var v in g.attrParsed)a(g,l,g.attrParsed[v].filter(r));else if(g.subparsed)!1!==g.dataBound&&((d=u)[m=g.value]||(d[m]={})),a(g,l,g.subparsed.filter(r));else if(g.cellParsed)for(var y=0,b=g.cellPostParsed;y<b.length;y++){var w=b[y];if("placeholder"===w.type){if("pro-xml-templating/xls-module-loop"===w.module)continue;if(w.subparsed){var E,x;(E=u)[x=w.value]||(E[x]={}),a(w,l,w.subparsed.filter(r))}else{var _,T,N=s(g,l.parents);(_=u=o(n,l.path,N))[T=w.value]||(_[T]={})}}}else!1!==g.dataBound&&((p=u)[h=g.value]||(p[h]={}))}return n},isPlaceholder:r},Ko}function Vs(){if(ns)return rs;ns=1;var t=Ao.pregMatchAll;return rs=function(e,r){var n={content:e},i=r.join("|"),a=new RegExp("(?:(<(?:".concat(i,")[^>]*>)([^<>]*)</(?:").concat(i,")>)|(<(?:").concat(i,")[^>]*/>)"),"g");return n.matches=t(a,n.content),n}}function Xs(){if(ss)return os;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach(function(e){n(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}ss=1;var o=Ao.wordToUtf8,s=Ao.pushArray,l=function(){if(as)return is;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}as=1;var e=new RegExp(String.fromCharCode(160),"g");function r(t){return t.replace(e," ")}return is={match:function(e,n){var i=t(e);return"string"===i?r(n.substr(0,e.length))===e:e instanceof RegExp?e.test(r(n)):"function"===i?!!e(n):void 0},getValue:function(e,n){var i=t(e);return"string"===i?r(n).substr(e.length):e instanceof RegExp?r(n).match(e)[1]:"function"===i?e(n):void 0},getValues:function(e,n){var i=t(e);return"string"===i?[n,r(n).substr(e.length)]:e instanceof RegExp?r(n).match(e):"function"===i?[n,e(n)]:void 0}}}(),u=l.match,c=l.getValue,f=l.getValues;function p(t,e){var n,a=e.modules,o=e.startOffset,l=e.lIndex;e.offset=o,e.match=u,e.getValue=c,e.getValues=f;var p=function(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];if(i.matchers){var a=i.matchers(e);if(!(a instanceof Array))throw new Error("module matcher returns a non array");s(r,a)}}return r}(a,e),h=function(t,e,n){for(var a=[],o=0;o<t.length;o++){var s=t[o],l=i(s,2),u=l[0],c=l[1],f=s[2]||{};if(n.match(u,e)){var p=n.getValues(u,e);if("function"==typeof f&&(f=f(p)),!f.value){var h=i(p,2);f.value=h[1]}a.push(r({type:"placeholder",prefix:u,module:c,onMatch:f.onMatch,priority:f.priority},f))}}return a}(p,t,e);if(h.length>0){for(var d=null,m=0;m<h.length;m++){var g=h[m];g.priority||(g.priority=-g.value.length),(!d||g.priority>d.priority)&&(d=g)}return d.offset=o,delete d.priority,d.endLindex=l,d.lIndex=l,d.raw=t,d.onMatch&&d.onMatch(d),delete d.onMatch,delete d.prefix,d}for(var v=0;v<a.length;v++){if(n=a[v].parse(t,e))return n.offset=o,n.endLindex=l,n.lIndex=l,n.raw=t,n}return{type:"placeholder",value:t,offset:o,endLindex:l,lIndex:l}}var h={preparse:function(t,e,r){function n(t,r){for(var n=0;n<e.length;n++){t=e[n].preparse(t,r)||t}return t}return n(t,r)},parse:function(t,e,n){var i,a=!1,l="",u=[],c=n.fileTypeConfig.droppedTagsInsidePlaceholder||[];return t.reduce(function(t,f){return"delimiter"===f.type?(a="start"===f.position,"end"===f.position&&(n.parse=function(t){return p(t,r(r(r({},n),f),{},{startOffset:i,modules:e}))},t.push(n.parse(o(l))),s(t,u),u=[]),"start"===f.position&&(u=[],i=f.offset),l="",t):a?"content"!==f.type||"insidetag"!==f.position?(-1!==c.indexOf(f.tag)||u.push(f),t):(l+=f.value,t):(t.push(f),t)},[])},postparse:function(t,e,n){function i(t,r){return e.map(function(e){return e.getTraits(t,r)})}var a=[];return{postparsed:function t(n,o){for(var l=n,u=0;u<e.length;u++){var c=e[u].postparse(l,r(r({},o),{},{postparse:function(e,n){return t(e,r(r({},o),n))},getTraits:i}));null!=c&&(c.errors?(s(a,c.errors),l=c.postparsed):l=c)}return l}(t,n),errors:a}}};return os=h}function Gs(){if(us)return ls;return us=1,ls=function(t,e){if(null==t.lIndex)return null;var r=e.scopeManager.scopePathItem;return t.parentPart&&(r=r.slice(0,r.length-1)),e.filePath+"@"+t.lIndex.toString()+"-"+r.join("-")}}function Zs(){if(ms)return ds;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach(function(e){n(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(e,r,n){return(r=function(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}ms=1;var i=Ao.pushArray,a=Gs();return ds=function(t){var e=[],n=t.baseNullGetter,o=t.compiled,s=t.scopeManager;t.nullGetter=function(t,e){return n(t,e||s)},t.resolved=e;var l=[];return Promise.all(o.filter(function(t){return-1===["content","tag"].indexOf(t.type)}).reduce(function(n,o){var u,c=function(t,e){for(var r=0,n=e.modules;r<n.length;r++){var i=n[r].resolve(t,e);if(i)return i}return!1}(o,r(r({},t),{},{resolvedId:a(o,t)}));if(c)u=c.then(function(t){e.push({tag:o.value,lIndex:o.lIndex,value:t})});else{if("placeholder"!==o.type)return;u=s.getValueAsync(o.value,{part:o}).then(function(e){return null==e?t.nullGetter(o):e}).then(function(t){return e.push({tag:o.value,lIndex:o.lIndex,value:t}),t})}return n.push(u.catch(function(t){t instanceof Array?i(l,t):l.push(t)})),n},[])).then(function(){return{errors:l,resolved:e}})},ds}function Ys(){if(vs)return gs;vs=1;var t=Ao.startsWith,e=Ao.endsWith,r=Ao.isStarting,n=Ao.isEnding,i=Ao.isWhiteSpace,a=zs();return gs=function(o,s){var l=s.fileTypeConfig.tagShouldContain||[],u="",c=-1;-1!==a.docx.indexOf(s.contentType)&&(o=function(r){for(var n="",a=0,o=r.length;a<o;a++){var s=r[a];i(s)||t(s,"<w:bookmarkEnd")||(e(n,"</w:tbl>")&&(t(s,"<w:p")||t(s,"<w:tbl")||t(s,"<w:sectPr")||(s="<w:p/>".concat(s))),n=s,r[a]=s)}return r}(o));for(var f=-1,p=0,h=l.length;p<h;p++)for(var d=l[p],m=d.tag,g=d.shouldContain,v=d.value,y=d.drop,b=d.dropParent,w=0,E=o.length;w<E;w++){var x=o[w];if(c===p){if(n(x,m))if(c=-1,b){for(var _=-1,T=f;T>0;T--)if(r(o[T],b)){_=T;break}for(var N=_;N<=o.length;N++){if(n(o[N],b)){o[N]="";break}o[N]=""}}else{for(var S=f;S<=w;S++)o[S]="";y||(o[w]=u+v+x)}u+=x;for(var O=0,A=g.length;O<A;O++){var C=g[O];if(r(x,C)){c=-1;break}}}-1===c&&r(x,m)&&-1===x.substr(1).indexOf("<")&&("/"===x[x.length-2]?o[w]="":(f=w,c=p,u=x))}return o},gs}function $s(){if(bs)return ys;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}bs=1;var n=Ao.pushArray,i=Ao.wordToUtf8,a=Ao.convertSpaces,o=Vs(),s=qs(),l=Xs(),u=function(){if(fs)return cs;fs=1;var t=lo(),e=t.throwUnimplementedTagType,r=t.XTScopeParserError,n=Ao.pushArray,i=Gs();function a(t,e){for(var r=0,n=e.modules;r<n.length;r++){var i=n[r].render(t,e);if(i)return i}return!1}return cs=function(t){var o=t.baseNullGetter,s=t.compiled,l=t.scopeManager;t.nullGetter=function(t,e){return o(t,e||l)};for(var u=[],c=[],f=0,p=s.length;f<p;f++){var h=s[f];t.index=f,t.resolvedId=i(h,t);var d=void 0;try{d=a(h,t)}catch(t){if(t instanceof r){u.push(t),c.push(h);continue}throw t}d?(d.errors&&n(u,d.errors),c.push(d)):"content"!==h.type&&"tag"!==h.type?e(h,f):c.push(h)}for(var m=[],g=0;g<c.length;g++){var v=c[g].value;v instanceof Array?n(m,v):v&&m.push(v)}return{errors:u,parts:m}},cs}(),c=function(){if(hs)return ps;function t(t){var e,r,n,i,a=0,o=t.length;for(n=0;n<o;n++)55296==(64512&(e=t.charCodeAt(n)))&&n+1<o&&56320==(64512&(r=t.charCodeAt(n+1)))&&(e=65536+(e-55296<<10)+(r-56320),n++),a+=e<128?1:e<2048?2:e<65536?3:4;var s=new Uint8Array(a);for(i=0,n=0;i<a;n++)55296==(64512&(e=t.charCodeAt(n)))&&n+1<o&&56320==(64512&(r=t.charCodeAt(n+1)))&&(e=65536+(e-55296<<10)+(r-56320),n++),e<128?s[i++]=e:e<2048?(s[i++]=192|e>>>6,s[i++]=128|63&e):e<65536?(s[i++]=224|e>>>12,s[i++]=128|e>>>6&63,s[i++]=128|63&e):(s[i++]=240|e>>>18,s[i++]=128|e>>>12&63,s[i++]=128|e>>>6&63,s[i++]=128|63&e);return s}return hs=1,ps=function(e,r){for(var n=0,i=r.modules;n<i.length;n++)e=i[n].postrender(e,r);for(var a=0,o=r.joinUncorrupt(e,r),s="",l=0,u=[],c=0,f=o.length;c<f;c++){var p=o[c];if(p.length+l>65536){var h=t(s);a+=h.length,u.push(h),s=""}s+=p,l+=p.length,delete o[c]}var d=t(s);a+=d.length,u.push(d);for(var m=new Uint8Array(a),g=0,v=0;v<u.length;v++){for(var y=u[v],b=0;b<y.length;++b)m[b+g]=y[b];g+=y.length}return m},ps}(),f=Zs(),p=Ys();return ys=function(){return t=function t(e,r){for(var n in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cachedParsers={},this.content=e,r)this[n]=r[n];this.setModules({inspect:{filePath:r.filePath}})},r=[{key:"resolveTags",value:function(t){var e=this;this.tags=t;var r=this.getOptions(),n=this.filePath;r.scopeManager=this.scopeManager,r.resolve=f;var i=[];return Promise.all(this.modules.map(function(t){return Promise.resolve(t.preResolve(r)).catch(function(t){i.push(t)})})).then(function(){if(0!==i.length)throw i;return f(r).then(function(t){var i=t.resolved,a=t.errors;if(0!==(a=a.map(function(t){var e;return t instanceof Error||(t=new Error(t)),(e=t).properties||(e.properties={}),t.properties.file=n,t})).length)throw a;return Promise.all(i).then(function(t){return r.scopeManager.root.finishedResolving=!0,r.scopeManager.resolved=t,e.setModules({inspect:{resolved:t,filePath:n}}),t})}).catch(function(t){throw e.errorChecker(t),t})})}},{key:"getFullText",value:function(){return function(t,e){var r=o(t,e).matches.map(function(t){return t.array[2]});return i(a(r.join("")))}(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function(t){for(var e=0,r=this.modules;e<r.length;e++)r[e].set(t)}},{key:"preparse",value:function(){this.allErrors=[],this.xmllexed=s.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray}),this.setModules({inspect:{filePath:this.filePath,xmllexed:this.xmllexed}});var t=s.parse(this.xmllexed,this.delimiters,this.syntax,this.fileType),e=t.lexed,r=t.errors;n(this.allErrors,r),this.lexed=e,this.setModules({inspect:{filePath:this.filePath,lexed:this.lexed}});var i=this.getOptions();this.lexed=l.preparse(this.lexed,this.modules,i)}},{key:"parse",value:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).noPostParse;this.setModules({inspect:{filePath:this.filePath}});var e=this.getOptions();return this.parsed=l.parse(this.lexed,this.modules,e),this.setModules({inspect:{filePath:this.filePath,parsed:this.parsed}}),t?this:this.postparse()}},{key:"postparse",value:function(){var t=this.getOptions(),e=l.postparse(this.parsed,this.modules,t),r=e.postparsed,i=e.errors;return this.postparsed=r,this.setModules({inspect:{filePath:this.filePath,postparsed:this.postparsed}}),n(this.allErrors,i),this.errorChecker(this.allErrors),this}},{key:"errorChecker",value:function(t){for(var e=0,r=t;e<r.length;e++){var n=r[e];n.properties||(n.properties={}),n.properties.file=this.filePath}for(var i=0,a=this.modules;i<a.length;i++)t=a[i].errorsTransformer(t)}},{key:"baseNullGetter",value:function(t,e){for(var r=null,n=0,i=this.modules;n<i.length;n++){var a=i[n];null==r&&(r=a.nullGetter(t,e,this))}return null!=r?r:this.nullGetter(t,e)}},{key:"getOptions",value:function(){return{compiled:this.postparsed,cachedParsers:this.cachedParsers,tags:this.tags,modules:this.modules,parser:this.parser,contentType:this.contentType,relsType:this.relsType,baseNullGetter:this.baseNullGetter.bind(this),filePath:this.filePath,fileTypeConfig:this.fileTypeConfig,fileType:this.fileType,linebreaks:this.linebreaks,stripInvalidXMLChars:this.stripInvalidXMLChars}}},{key:"render",value:function(t){this.filePath=t;var e=this.getOptions();e.resolved=this.scopeManager.resolved,e.scopeManager=this.scopeManager,e.render=u,e.joinUncorrupt=p;var r=u(e),n=r.errors,i=r.parts;return n.length>0?(this.allErrors=n,this.errorChecker(n),this):(this.content=c(i,e),this.setModules({inspect:{filePath:this.filePath,content:this.content}}),this)}}],r&&e(t.prototype,r),h&&e(t,h),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,h}(),ys}function Ws(){if(Es)return ws;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function r(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach(function(e){n(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}Es=1;var l=Ao.chunkBy,u=Ao.last,c=Ao.isParagraphStart,f=Ao.isModule,p=Ao.pushArray,h=Ao.isParagraphEnd,d=Ao.isContent,m=Ao.startsWith,g=Ao.isTagEnd,v=Ao.isTagStart,y=Ao.getSingleAttribute,b=Ao.setSingleAttribute,w=zs(),E=Ms(),x="loop";function _(t){var e=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("content"!==r.type)return r}return null}(t.subparsed);return null!=e&&"w:t"!==e.tag}function T(t){return t.hasPageBreak&&_(t)?'<w:p><w:r><w:br w:type="page"/></w:r></w:p>':""}function N(t){return t.some(function(t){return d(t)})?0:t.length}function S(t){var e=t.parts.length-1;"</w:p>"===t.parts[e]?t.parts.splice(e,0,'<w:r><w:br w:type="page"/></w:r>'):t.parts.push('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}function O(t){return t.some(function(t){return"w:br"===t.tag&&-1!==t.value.indexOf('w:type="page"')})}function A(t){return t.some(function(t){return"w:drawing"===t.tag})}var C=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="LoopModule",this.inXfrm=!1,this.totalSectPr=0,this.prefix={start:"#",end:"/",dash:/^-([^\s]+)\s(.+)/,inverted:"^"}},e=[{key:"optionsTransformer",value:function(t,e){return this.docxtemplater=e,t}},{key:"preparse",value:function(t,e){var r=e.contentType;-1!==w.main.indexOf(r)&&(this.sects=function(t){for(var e=!1,r=[],n=0;n<t.length;n++){var i=t[n];v("w:sectPr",i)&&(r.push([]),e=!0),e&&r[r.length-1].push(i),g("w:sectPr",i)&&(e=!1)}return r}(t))}},{key:"matchers",value:function(){var t=x;return[[this.prefix.start,t,{expandTo:"auto",location:"start",inverted:!1}],[this.prefix.inverted,t,{expandTo:"auto",location:"start",inverted:!0}],[this.prefix.end,t,{location:"end"}],[this.prefix.dash,t,function(t){var e=i(t,3);return{location:"start",inverted:!1,expandTo:e[1],value:e[2]}}]]}},{key:"getTraits",value:function(t,e){if("expandPair"===t){for(var r=[],n=0,i=e.length;n<i;n++){var a=e[n];f(a,x)&&null==a.subparsed&&r.push({part:a,offset:n})}return r}}},{key:"postparse",value:function(t,e){var r=e.basePart;if(r&&"docx"===this.docxtemplater.fileType&&t.length>0){r.sectPrCount=function(t){for(var e=!1,r=0,n=0;n<t.length;n++){var i=t[n];v("w:sectPr",i)&&(e=!0),e&&("w:headerReference"!==i.tag&&"w:footerReference"!==i.tag||(r++,e=!1)),g("w:sectPr",i)&&(e=!1)}return r}(t),this.totalSectPr+=r.sectPrCount;var n=this.sects;n.some(function(e,i){return r.lIndex<e[0].lIndex?(i+1<n.length&&n[i+1].some(function(t){return v("w:type",t)&&-1!==t.value.indexOf("continuous")})&&(r.addContinuousType=!0),!0):t[0].lIndex<e[0].lIndex&&e[0].lIndex<r.lIndex?(function(t){return t.some(function(t){return v("w:type",t)&&-1!==t.value.indexOf('w:val="nextPage"')})}(n[i])&&(r.addNextPage={index:i}),!0):void 0}),r.lastParagrapSectPr=function(t){for(var e=[],r=!1,n=t.length-1;n>=0;n--){var i=t[n];if(g("w:sectPr",i)&&(r=!0),v("w:sectPr",i)&&(e.unshift(i.value),r=!1),r&&e.unshift(i.value),c(i)){if(e.length>0)return e.join("");break}}return""}(t)}if(!r||"auto"!==r.expandTo||r.module!==x||!function(t){return t.length&&c(t[0])&&h(u(t))}(t))return t;r.paragraphLoop=!0;var i=0,a=l(t,function(t){return c(t)&&1===++i?"start":h(t)&&0===--i?"end":null}),o=a[0],s=u(a),f=N(o),p=N(s);return r.hasPageBreakBeginning=O(o),r.hasPageBreak=O(s),A(o)&&(f=0),A(s)&&(p=0),t.slice(f,t.length-p)}},{key:"resolve",value:function(t,e){if(!f(t,x))return null;var n=e.scopeManager,i=n.getValueAsync(t.value,{part:t}),a=[];function o(i,o,s){var l=n.createSubScopeManager(i,t.value,o,t,s);a.push(e.resolve(r(r({},e),{},{compiled:t.subparsed,tags:{},scopeManager:l})))}var s=[];return i.then(function(r){return null!=r||(r=e.nullGetter(t)),new Promise(function(t){if(r instanceof Promise)return r.then(function(e){e instanceof Array?Promise.all(e).then(t):t(e)});r instanceof Array?Promise.all(r).then(t):t(r)}).then(function(e){return n.loopOverValue(e,o,t.inverted),Promise.all(a).then(function(t){return t.map(function(t){var e=t.resolved,r=t.errors;return p(s,r),e})}).then(function(t){if(s.length>0)throw s;return t})})})}},{key:"render",value:function(t,e){if("p:xfrm"===t.tag&&(this.inXfrm="start"===t.position),"a:ext"===t.tag&&this.inXfrm)return this.lastExt=t,t;if(!f(t,x))return null;var n=[],i=[],a=0,o=this,s=t.subparsed[0],l=0;"a:tr"===(null==s?void 0:s.tag)&&(l=+y(s.value,"h")),a-=l;var u=0,c=_(t),h=e.scopeManager.getValue(t.value,{part:t});null!=h||(h=e.nullGetter(t));var d=e.scopeManager.loopOverValue(h,function(s,f,h){a+=l;for(var d=e.scopeManager.createSubScopeManager(s,t.value,f,t,h),g=0,w=t.subparsed;g<w.length;g++){var E=w[g];if(v("a16:rowId",E)){var x=+y(E.value,"val")+u;u=1,E.value=b(E.value,"val",x)}}var _=e.render(r(r({},e),{},{compiled:t.subparsed,tags:{},scopeManager:d}));t.hasPageBreak&&f===h-1&&c&&S(_);var T=d.scopePathItem.some(function(t){return 0!==t});T?(1===t.sectPrCount&&(_.parts=_.parts.filter(function(t){return!m(t,"<w:headerReference")&&!m(t,"<w:footerReference")})),t.addContinuousType&&(_.parts=function(t){for(var e=!1,r=!1,n=[],i=0;i<t.length;i++){var a=t[i];!1===e&&m(a,"<w:sectPr")&&(r=!0),r&&(m(a,"<w:type")&&(e=!0),!1===e&&m(a,"</w:sectPr")&&n.push('<w:type w:val="continuous"/>')),n.push(a)}return n}(_.parts))):t.addNextPage&&(_.parts=function(t,e){return p(["<w:p><w:pPr>".concat(e.map(function(t){return t.value}).join(""),"</w:pPr></w:p>")],t)}(_.parts,o.sects[t.addNextPage.index])),t.addNextPage&&S(_),t.hasPageBreakBeginning&&c&&function(t){t.parts.unshift('<w:p><w:r><w:br w:type="page"/></w:r></w:p>')}(_);for(var N=0,O=_.parts;N<O.length;N++){var A=O[N];n.push(A)}p(i,_.errors)},t.inverted);if(!1===d)return t.lastParagrapSectPr?t.paragraphLoop?{value:"<w:p><w:pPr>".concat(t.lastParagrapSectPr,"</w:pPr></w:p>")}:{value:"</w:t></w:r></w:p><w:p><w:pPr>".concat(t.lastParagrapSectPr,"</w:pPr><w:r><w:t>")}:{value:T(t)||"",errors:i};if(0!==a){var g=+y(this.lastExt.value,"cy");this.lastExt.value=b(this.lastExt.value,"cy",g+a)}return{value:e.joinUncorrupt(n,r(r({},e),{},{basePart:t})),errors:i}}}],e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();return ws=function(){return E(new C)}}function Qs(){if(_s)return xs;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}_s=1;var n=Ms(),i=Ao.isTextStart,a=Ao.isTextEnd,o=Ao.endsWith,s=Ao.startsWith,l=Ao.pushArray,u='<w:t xml:space="preserve">',c="</w:t>";function f(t,e){var r=t[e].value;return"</w:t>"===t[e+1].value||-1!==r.indexOf('xml:space="preserve"')?r:r.substr(0,r.length-1)+' xml:space="preserve">'}var p=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="SpacePreserveModule"},r=[{key:"postparse",value:function(t,e){var r=[],n=!1,o=0,s=0,u=t.reduce(function(t,u){return function(t){return i(t)&&"w:t"===t.tag}(u)&&(n=!0,s=r.length),n?(r.push(u),function(t,e){return t&&t.basePart&&e.length>1}(e,r)&&(o=e.basePart.endLindex,r[0].value=f(r,0)),function(t,e){return"placeholder"===t.type&&e.length>1}(u,r)&&(r[s].value=f(r,s),o=u.endLindex),a(u)&&u.lIndex>o&&(0!==o&&(r[s].value=f(r,s)),l(t,r),r=[],n=!1,o=0,s=0),t):(t.push(u),t)},[]);return l(u,r),u}},{key:"postrender",value:function(t){for(var e="",r=0,n=0,i=t.length;n<i;n++){var a=t[n];""!==a&&(o(e,u)&&s(a,c)&&(t[r]=e.substr(0,e.length-26)+"<w:t/>",a=a.substr(6)),e=a,r=n,t[n]=a)}return t}}],r&&e(t.prototype,r),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();return xs=function(){return n(new p)}}function Ks(){if(Ns)return Ts;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}Ns=1;var n=Us(),i=Ao.isContent,a=lo(),o=a.throwRawTagShouldBeOnlyTextInParagraph,s=a.getInvalidRawXMLValueException,l=Ms(),u="rawxml";function c(t){for(var e=t.part,r=t.left,n=t.right,a=t.postparsed,s=t.index,l=a.slice(r+1,n),u=0,c=l.length;u<c;u++)if(u!==s-r-1){var f=l[u];i(f)&&o({paragraphParts:l,part:e})}return e}var f=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="RawXmlModule",this.prefix="@"},r=[{key:"optionsTransformer",value:function(t,e){return this.fileTypeConfig=e.fileTypeConfig,t}},{key:"matchers",value:function(){return[[this.prefix,u]]}},{key:"postparse",value:function(t){return n.expandToOne(t,{moduleName:u,getInner:c,expandTo:this.fileTypeConfig.tagRawXml,error:{message:"Raw tag not in paragraph",id:"raw_tag_outerxml_invalid",explanation:function(t){return'The tag "'.concat(t.value,'" is not inside a paragraph, putting raw tags inside an inline loop is disallowed.')}}})}},{key:"render",value:function(t,e){if(t.module!==u)return null;var r,n=[];try{null!=(r=e.scopeManager.getValue(t.value,{part:t}))||(r=e.nullGetter(t))}catch(t){return n.push(t),{errors:n}}return"string"==typeof(r=r||"")?{value:r}:{errors:[s({tag:t.value,value:r,offset:t.offset})]}}}],r&&e(t.prototype,r),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,i}();return Ts=function(){return l(new f)}}function Js(){if(Os)return Ss;function t(t,e){for(var r=-1,n=0,i=t.length;n<i;n++)e[n]>=t[n].length||(-1===r||t[n][e[n]].offset<t[r][e[r]].offset)&&(r=n);return r}return Os=1,Ss=function(e){for(var r=0,n=0,i=e;n<i.length;n++){r+=i[n].length}e=e.filter(function(t){return t.length>0});for(var a=new Array(r),o=e.map(function(){return 0}),s=0;s<r;s++){var l=t(e,o);a[s]=e[l][o[l]],o[l]++}return a},Ss}function tl(){if(Cs)return As;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}Cs=1;var n=Js(),i=Ao.getLeft,a=Ao.getRight,o=Ao.pushArray,s=Ms(),l=Us().getExpandToDefault,u=lo(),c=u.getUnmatchedLoopException,f=u.getClosingTagNotMatchOpeningTag,p=u.getUnbalancedLoopException;function h(t){switch(t.location){case"start":return 1;case"end":return-1}}function d(t,e){return null!=t&&null!=e&&("start"===t.part.location&&"end"===e.part.location&&t.part.value===e.part.value||""===e.part.value)}function m(t){for(var e=0,r=[];e<t.length;){var n=t[e].part;if("end"===n.location){if(0===e)return t.splice(0,1),r.push(c(n)),{traits:t,errors:r};var i=e,a=e-1,o=1;if(d(t[a],t[i]))return t.splice(i,1),t.splice(a,1),{errors:r,traits:t};for(;o<50;){var s=t[a-o],l=t[i+o];if(d(s,t[i]))return t.splice(i,1),t.splice(a-o,1),{errors:r,traits:t};if(d(t[a],l))return t.splice(i+o,1),t.splice(a,1),{errors:r,traits:t};o++}return r.push(f({tags:[t[a].part,t[i].part]})),t.splice(i,1),t.splice(a,1),{traits:t,errors:r}}e++}for(var u=0;u<t.length;u++){var p=t[u].part;r.push(c(p))}return{traits:[],errors:r}}var g=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="ExpandPairTrait"},r=[{key:"optionsTransformer",value:function(t,e){return e.options.paragraphLoop&&o(e.fileTypeConfig.expandTags,e.fileTypeConfig.onParagraphLoop),this.expandTags=e.fileTypeConfig.expandTags,t}},{key:"postparse",value:function(t,e){var r=this,s=e.getTraits,u=e.postparse,c=e.fileType,f=s("expandPair",t);f=f.map(function(t){return t||[]});var d=function(t){var e={},r=[],n=[],i=[];for(o(i,t);i.length>0;){var a=m(i);o(r,a.errors),i=a.traits}if(r.length>0)return{pairs:n,errors:r};for(var s=0,l=0;l<t.length;l++){var u=t[l],c=h(u.part);if(s+=c,1===c)e[s]=u;else{var f=e[s+1];0===s&&n.push([f,u])}s=s>=0?s:0}return{pairs:n,errors:r}}(f=n(f)),g=d.pairs,v=d.errors,y=0,b=null,w=g.map(function(e){var n,o,s=e[0].part.expandTo;if("auto"===s&&"text"!==c){var u=l(t,e,r.expandTags);u.error&&v.push(u.error),s=u.value}if(!s||"text"===c){var f=e[0].offset,h=e[1].offset;return f<y&&!r.docxtemplater.options.syntax.allowUnbalancedLoops&&v.push(p(e,b)),b=e,y=h,[f,h]}try{n=i(t,s,e[0].offset)}catch(t){v.push(t)}try{o=a(t,s,e[1].offset)}catch(t){v.push(t)}return n<y&&!r.docxtemplater.options.syntax.allowUnbalancedLoops&&v.push(p(e,b)),y=o,b=e,[n,o]});if(v.length>0)return{postparsed:t,errors:v};var E,x=0,_=t.reduce(function(e,r,n){var i=x<g.length&&w[x][0]<=n&&n<=w[x][1],a=g[x],o=w[x];if(!i)return e.push(r),e;if(o[0]===n&&(E=[]),a[0].offset!==n&&a[1].offset!==n&&E.push(r),o[1]===n){var s=t[a[0].offset];s.subparsed=u(E,{basePart:s}),s.endLindex=a[1].part.lIndex,delete s.location,delete s.expandTo,e.push(s),x++;for(var l=w[x];l&&l[0]<n;)x++,l=w[x]}return e},[]);return{postparsed:_,errors:v}}}],r&&e(t.prototype,r),s&&e(t,s),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,s}();return As=function(){return s(new g)}}function el(){if(Ds)return Is;function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,r(i.key),i)}}function r(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,r||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}Ds=1;var n=Ms(),i=lo(),a=i.getScopeCompilationError,o=i.getCorruptCharactersException,s=Ao.utf8ToWord,l=Ao.hasCorruptCharacters,u=Ao.removeCorruptCharacters,c=js(),f=[c.settingsContentType,c.coreContentType,c.appContentType,c.customContentType],p={docx:"w",pptx:"a"},h=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="Render",this.recordRun=!1,this.recordedRun=[]},r=[{key:"optionsTransformer",value:function(t,e){return this.docxtemplater=e,this.brTag="docx"===e.fileType?"<w:r><w:br/></w:r>":"<a:br/>",this.prefix=p[e.fileType],this.runStartTag="".concat(this.prefix,":r"),this.runPropsStartTag="".concat(this.prefix,":rPr"),t}},{key:"set",value:function(t){t.compiled&&(this.compiled=t.compiled),null!=t.data&&(this.data=t.data)}},{key:"getRenderedMap",value:function(t){for(var e in this.compiled)t[e]={from:e,data:this.data};return t}},{key:"postparse",value:function(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];if("placeholder"===i.type){var o=i.value;try{e.cachedParsers[i.lIndex]=this.docxtemplater.parser(o,{tag:i})}catch(t){r.push(a({tag:o,rootError:t,offset:i.offset}))}}}return{postparsed:t,errors:r}}},{key:"render",value:function(t,e){var r=e.contentType,n=e.scopeManager,i=e.linebreaks,a=e.nullGetter,c=e.fileType,p=e.stripInvalidXMLChars;if(-1!==f.indexOf(r)&&(i=!1),i&&this.recordRuns(t),"placeholder"===t.type&&!t.module){var h;try{h=n.getValue(t.value,{part:t})}catch(t){return{errors:[t]}}if(null!=h||(h=a(t)),"string"==typeof h)if(p)h=u(h);else if(-1!==["docx","pptx","xlsx"].indexOf(c)&&l(h))return{errors:[o({tag:t.value,value:h,offset:t.offset})]};return"text"===c?{value:h}:{value:i&&"string"==typeof h?this.renderLineBreaks(h):s(h)}}}},{key:"recordRuns",value:function(t){t.tag===this.runStartTag?this.recordedRun="":t.tag===this.runPropsStartTag?("start"===t.position&&(this.recordRun=!0,this.recordedRun+=t.value),"end"!==t.position&&"selfclosing"!==t.position||(this.recordedRun+=t.value,this.recordRun=!1)):this.recordRun&&(this.recordedRun+=t.value)}},{key:"renderLineBreaks",value:function(t){for(var e=[],r=t.split("\n"),n=0,i=r.length;n<i;n++)e.push(s(r[n])),n<r.length-1&&e.push("</".concat(this.prefix,":t></").concat(this.prefix,":r>").concat(this.brTag,"<").concat(this.prefix,":r>").concat(this.recordedRun,"<").concat(this.prefix,":t").concat("docx"===this.docxtemplater.fileType?' xml:space="preserve"':"",">"));return e}}],r&&e(t.prototype,r),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();return Is=function(){return n(new h)}}!function(t){var e=["modules"];function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){i(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function i(t,e,r){return(e=u(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var c=Ao,f=Ls,p=f.object({allowUnopenedTag:f.boolean().optional(),allowUnclosedTag:f.boolean().optional(),allowUnbalancedLoops:f.boolean().optional(),changeDelimiterPrefix:f.string().optional().nullable()}),h=f.object({delimiters:f.object({start:f.string().nullable(),end:f.string().nullable()}).strict().optional(),fileTypeConfig:f.object({}).optional(),paragraphLoop:f.boolean().optional(),parser:f.function().optional(),errorLogging:f.union([f.boolean(),f.string()]).optional(),linebreaks:f.boolean().optional(),nullGetter:f.function().optional(),syntax:p.optional(),stripInvalidXMLChars:f.boolean().optional()}).strict(),d=function(){if(Lo)return Ro;Lo=1;var t=Ao.str2xml;return Ro={getRelsTypes:function(e){for(var r=e.files["_rels/.rels"],n=r?t(r.asText()):null,i=n?n.getElementsByTagName("Relationship"):[],a={},o=0;o<i.length;o++){var s=i[o];a[s.getAttribute("Target")]=s.getAttribute("Type")}return a}}}(),m=d.getRelsTypes,g=function(){if(Uo)return Mo;Uo=1;var t=Ao.str2xml,e="[Content_Types].xml";return Mo={collectContentTypes:function(t,r,n){for(var i={},a=0;a<t.length;a++){var o=t[a],s=o.getAttribute("ContentType"),l=o.getAttribute("PartName").substr(1);i[l]=s}for(var u=function(){var t=r[c],a=t.getAttribute("ContentType"),o=t.getAttribute("Extension");n.file(/./).map(function(t){var r=t.name;r.slice(r.length-o.length)!==o||i[r]||r===e||(i[r]=a)})},c=0;c<r.length;c++)u();return i},getContentTypes:function(r){var n=r.files[e],i=n?t(n.asText()):null;return{overrides:i?i.getElementsByTagName("Override"):null,defaults:i?i.getElementsByTagName("Default"):null,contentTypes:n,contentTypeXml:i}}},Mo}(),v=g.collectContentTypes,y=g.getContentTypes,b=Ms(),w=Us(),E=Fs(),x=Bs(),_=qs(),T=Hs().getTags,N=function(){if(es)return ts;es=1;var t=Ao.pushArray;function e(e,r){return r instanceof Error?t(Object.getOwnPropertyNames(r),["stack"]).reduce(function(t,e){return t[e]=r[e],"stack"===e&&(t[e]=r[e].toString()),t},{}):r}return ts=function(t,r){if(console.log(JSON.stringify({error:t},e,"json"===r?2:null)),t.properties&&t.properties.errors instanceof Array){var n=t.properties.errors.map(function(t){return t.properties.explanation}).join("\n");console.log("errorMessages",n)}}}(),S=lo(),O=S.throwMultiError,A=S.throwResolveBeforeCompile,C=S.throwRenderInvalidTemplate,I=S.throwRenderTwice,D=S.XTInternalError,k=S.XTTemplateError,P=S.throwFileTypeNotIdentified,R=S.throwFileTypeNotHandled,L=S.throwApiVersionError;c.getRelsTypes=m,c.traits=w,c.moduleWrapper=b,c.collectContentTypes=v,c.getContentTypes=y;var M=c.getDefaults,U=c.str2xml,z=c.xml2str,j=c.concatArrays,F=c.uniq,B=c.getDuplicates,q=c.stableSort,H=c.pushArray,V=c.utf8ToWord,X=c.invertMap,G=[3,47,1];function Z(t){var e=[];for(var r in t)e.push(r);for(var n=["[Content_Types].xml","_rels/.rels"],i=["word/","xl/","ppt/"],a=0;a<e.length;a++)for(var o=e[a],s=0;s<i.length;s++){var l=i[s];0===o.indexOf("".concat(l))&&n.push(o)}for(var u=0;u<e.length;u++){var c=e[u];-1===n.indexOf(c)&&n.push(c)}return n}function Y(t,e){!0!==t.hideDeprecations&&console.warn(e)}function $(t,e){if(!0!==t.hideDeprecations)return Y(t,'Deprecated method ".'.concat(e,'", view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ').concat((new Error).stack))}function W(t){t.modules=t.modules.filter(function(e){if(!e.supportedFileTypes)return!0;if(!Array.isArray(e.supportedFileTypes))throw new Error("The supportedFileTypes field of the module must be an array");var r=e.supportedFileTypes.includes(t.fileType);return r||e.on("detached"),r})}function Q(t){var e=t.compiled;t.errors=j(Object.keys(e).map(function(t){return e[t].allErrors})),0!==t.errors.length&&(t.options.errorLogging&&N(t.errors,t.options.errorLogging),O(t.errors))}var K=function(){function t(r){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.modules,o=void 0===a?[]:a,s=function(t,e){if(null==t)return{};var r,n,i=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(n=0;n<a.length;n++)r=a[n],-1===e.indexOf(r)&&{}.propertyIsEnumerable.call(t,r)&&(i[r]=t[r])}return i}(i,e);if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.targets=[],this.rendered=!1,this.scopeManagers={},this.compiled={},this.modules=[E()],this.xmlDocuments={},0===arguments.length)Y(this,"Deprecated docxtemplater constructor with no arguments, view upgrade guide : https://docxtemplater.com/docs/api/#upgrade-guide, stack : ".concat((new Error).stack)),this.hideDeprecations=!0,this.setOptions(s);else{if(this.hideDeprecations=!0,this.setOptions(s),n=r,"undefined"!=typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(n))throw new Error("You passed a Buffer to the Docxtemplater constructor. The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!r||!r.files||"function"!=typeof r.file)throw new Error("The first argument of docxtemplater's constructor must be a valid zip file (jszip v2 or pizzip v3)");if(!Array.isArray(o))throw new Error("The modules argument of docxtemplater's constructor must be an array");for(var l=0;l<o.length;l++){var u=o[l];this.attachModule(u)}this.loadZip(r),this.compile(),this.v4Constructor=!0}this.hideDeprecations=!1}return r=t,i=[{key:"verifyApiVersion",value:function(t){return t=t.split(".").map(function(t){return parseInt(t,10)}),3!==t.length&&L("neededVersion is not a valid version",{neededVersion:t,explanation:"the neededVersion must be an array of length 3"}),t[0]!==G[0]&&L("The major api version do not match, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:t,currentModuleApiVersion:G,explanation:"moduleAPIVersionMismatch : needed=".concat(t.join("."),", current=").concat(G.join("."))}),t[1]>G[1]&&L("The minor api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:t,currentModuleApiVersion:G,explanation:"moduleAPIVersionMismatch : needed=".concat(t.join("."),", current=").concat(G.join("."))}),t[1]===G[1]&&t[2]>G[2]&&L("The patch api version is not uptodate, you probably have to update docxtemplater with npm install --save docxtemplater",{neededVersion:t,currentModuleApiVersion:G,explanation:"moduleAPIVersionMismatch : needed=".concat(t.join("."),", current=").concat(G.join("."))}),!0}},{key:"setModules",value:function(t){for(var e=0,r=this.modules;e<r.length;e++)r[e].set(t)}},{key:"sendEvent",value:function(t){for(var e=0,r=this.modules;e<r.length;e++)r[e].on(t)}},{key:"attachModule",value:function(t){if(this.v4Constructor)throw new D("attachModule() should not be called manually when using the v4 constructor");$(this,"attachModule");var e=s(t);if("function"===e)throw new D("Cannot attach a class/function as a module. Most probably you forgot to instantiate the module by using `new` on the module.");if(!t||"object"!==e)throw new D("Cannot attachModule with a falsy value");if(t.requiredAPIVersion&&this.verifyApiVersion(t.requiredAPIVersion),!0===t.attached){if("function"!=typeof t.clone)throw new Error('Cannot attach a module that was already attached : "'.concat(t.name,'". The most likely cause is that you are instantiating the module at the root level, and using it for multiple instances of Docxtemplater'));t=t.clone()}t.attached=!0;var r=b(t);return this.modules.push(r),r.on("attached"),this.fileType&&W(this),this}},{key:"setOptions",value:function(t){var e,r;if(this.v4Constructor)throw new Error("setOptions() should not be called manually when using the v4 constructor");if(!t)throw new Error("setOptions should be called with an object as first parameter");var n=h.validate(t);if(!1===n.success)throw new Error(n.error);$(this,"setOptions"),this.options={};var i=M();for(var a in i){var o=i[a];this.options[a]=null!=t[a]?t[a]:this[a]||o,this[a]=this.options[a]}return(e=this.delimiters).start&&(e.start=V(this.delimiters.start)),(r=this.delimiters).end&&(r.end=V(this.delimiters.end)),this}},{key:"loadZip",value:function(t){if(this.v4Constructor)throw new Error("loadZip() should not be called manually when using the v4 constructor");if($(this,"loadZip"),t.loadAsync)throw new D("Docxtemplater doesn't handle JSZip version >=3, please use pizzip");this.zip=t,this.updateFileTypeConfig(),this.modules=j([this.fileTypeConfig.baseModules.map(function(t){return t()}),this.modules]);for(var e=0,r=this.modules;e<r.length;e++){var n=r[e];n.zip=this.zip,n.docxtemplater=this}return W(this),this}},{key:"precompileFile",value:function(t){var e=this.createTemplateClass(t);e.preparse(),this.compiled[t]=e}},{key:"compileFile",value:function(t){this.compiled[t].parse()}},{key:"getScopeManager",value:function(t,e,r){var n;return(n=this.scopeManagers)[t]||(n[t]=x({tags:r,parser:this.parser,cachedParsers:e.cachedParsers})),this.scopeManagers[t]}},{key:"resolveData",value:function(t){var e=this;$(this,"resolveData");var r=[];return Object.keys(this.compiled).length||A(),Promise.resolve(t).then(function(t){return e.data=t,e.setModules({data:e.data,Lexer:_}),e.mapper=e.modules.reduce(function(t,e){return e.getRenderedMap(t)},{}),Promise.all(Object.keys(e.mapper).map(function(t){var n=e.mapper[t],i=n.from,a=n.data;return Promise.resolve(a).then(function(n){var a=e.compiled[i];return a.filePath=t,a.scopeManager=e.getScopeManager(t,a,n),a.resolveTags(n).then(function(t){return a.scopeManager.finishedResolving=!0,t},function(t){H(r,t)})})})).then(function(t){return 0!==r.length&&(e.options.errorLogging&&N(r,e.options.errorLogging),O(r)),j(t)})})}},{key:"compile",value:function(){var t;if($(this,"compile"),this.updateFileTypeConfig(),function(t){var e=B(t.map(function(t){return t.name}));if(e.length>0)throw new D('Detected duplicate module "'.concat(e[0],'"'))}(this.modules),this.modules=(t=this.modules,q(t,function(t,e){return(e.priority||0)-(t.priority||0)})),Object.keys(this.compiled).length)return this;for(var e=this.options,r=0,n=this.modules;r<n.length;r++)e=n[r].optionsTransformer(e,this);this.options=e,this.options.xmlFileNames=F(this.options.xmlFileNames);for(var i=0,a=this.options.xmlFileNames;i<a.length;i++){var o=a[i],s=this.zip.files[o].asText();this.xmlDocuments[o]=U(s)}this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments}),this.getTemplatedFiles(),this.sendEvent("before-preparse");for(var l=0,u=this.templatedFiles;l<u.length;l++){var c=u[l];null!=this.zip.files[c]&&this.precompileFile(c)}this.sendEvent("after-preparse");for(var f=0,p=this.templatedFiles;f<p.length;f++){var h=p[f];null!=this.zip.files[h]&&this.compiled[h].parse({noPostParse:!0})}this.sendEvent("after-parse");for(var d=0,m=this.templatedFiles;d<m.length;d++){var g=m[d];null!=this.zip.files[g]&&this.compiled[g].postparse()}return this.sendEvent("after-postparse"),this.setModules({compiled:this.compiled}),Q(this),this}},{key:"updateFileTypeConfig",value:function(){this.relsTypes=m(this.zip);var e,r=y(this.zip),n=r.overrides,i=r.defaults,a=r.contentTypes,o=r.contentTypeXml;o&&(this.filesContentTypes=v(n,i,this.zip),this.invertedContentTypes=X(this.filesContentTypes),this.setModules({contentTypes:this.contentTypes,invertedContentTypes:this.invertedContentTypes})),this.zip.files.mimetype&&(e="odt");for(var s=0,l=this.modules;s<l.length;s++)e=l[s].getFileType({zip:this.zip,contentTypes:a,contentTypeXml:o,overrides:n,defaults:i,doc:this})||e;if(this.fileType=e,"odt"===e&&R(e),e||P(this.zip),function(t){for(var e=0,r=t.modules;e<r.length;e++)for(var n=0,i=r[e].xmlContentTypes||[];n<i.length;n++)for(var a=i[n],o=t.invertedContentTypes[a]||[],s=0;s<o.length;s++){var l=o[s];t.zip.files[l]&&t.options.xmlFileNames.push(l)}}(this),W(this),this.fileTypeConfig=this.options.fileTypeConfig||this.fileTypeConfig,!this.fileTypeConfig){if(!t.FileTypeConfig[this.fileType]){var u='Filetype "'.concat(this.fileType,'" is not supported'),c="filetype_not_supported";"xlsx"===this.fileType&&(u='Filetype "'.concat(this.fileType,'" is supported only with the paid XlsxModule'),c="xlsx_filetype_needs_xlsx_module");var f=new k(u);throw f.properties={id:c,explanation:u},f}this.fileTypeConfig=t.FileTypeConfig[this.fileType]()}return this}},{key:"renderAsync",value:function(t){var e=this;this.hideDeprecations=!0;var r=this.resolveData(t);return this.hideDeprecations=!1,r.then(function(){return e.render()})}},{key:"render",value:function(t){this.rendered&&I(),this.rendered=!0,0===Object.keys(this.compiled).length&&this.compile(),this.errors.length>0&&C(),arguments.length>0&&(this.data=t),this.setModules({data:this.data,Lexer:_}),this.mapper||(this.mapper=this.modules.reduce(function(t,e){return e.getRenderedMap(t)},{}));var e=[];for(var r in this.mapper){var n=this.mapper[r],i=n.from,o=n.data,s=this.compiled[i];s.scopeManager=this.getScopeManager(r,s,o),s.render(r),e.push([r,s.content,s]),delete s.content}for(var l=0;l<e.length;l++)for(var u=e[l],c=a(u,3),f=c[1],p=c[2],h=0,d=this.modules;h<d.length;h++){var m=d[h];if(m.preZip){var g=m.preZip(f,p);"string"==typeof g&&(u[1]=g)}}for(var v=0;v<e.length;v++){var y=a(e[v],2),b=y[0],w=y[1];this.zip.file(b,w,{createFolders:!0})}return Q(this),this.sendEvent("syncing-zip"),this.syncZip(),this.sendEvent("synced-zip"),this}},{key:"syncZip",value:function(){for(var t in this.xmlDocuments){this.zip.remove(t);var e=z(this.xmlDocuments[t]);this.zip.file(t,e,{createFolders:!0})}}},{key:"setData",value:function(t){return $(this,"setData"),this.data=t,this}},{key:"getZip",value:function(){return this.zip}},{key:"createTemplateClass",value:function(t){var e=this.zip.files[t].asText();return this.createTemplateClassFromContent(e,t)}},{key:"createTemplateClassFromContent",value:function(e,r){for(var n={filePath:r,contentType:this.filesContentTypes[r],relsType:this.relsTypes[r]},i=M(),a=H(Object.keys(i),["filesContentTypes","fileTypeConfig","fileType","modules"]),o=0;o<a.length;o++){var s=a[o];n[s]=this[s]}return new t.XmlTemplater(e,n)}},{key:"getFullText",value:function(t){return this.createTemplateClass(t||this.fileTypeConfig.textPath(this)).getFullText()}},{key:"getTemplatedFiles",value:function(){return this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip),H(this.templatedFiles,this.targets),this.templatedFiles=F(this.templatedFiles),this.templatedFiles}},{key:"getTags",value:function(){var t={headers:[],footers:[]};for(var e in this.compiled){var r=this.filesContentTypes[e];"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"===r&&(t.document={target:e,tags:T(this.compiled[e].postparsed)}),"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml"===r&&t.headers.push({target:e,tags:T(this.compiled[e].postparsed)}),"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml"===r&&t.footers.push({target:e,tags:T(this.compiled[e].postparsed)})}return t}},{key:"toBuffer",value:function(t){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Z},t),{},{type:"nodebuffer"}))}},{key:"toBlob",value:function(t){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Z},t),{},{type:"blob"}))}},{key:"toBase64",value:function(t){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Z},t),{},{type:"base64"}))}},{key:"toUint8Array",value:function(t){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Z},t),{},{type:"uint8array"}))}},{key:"toArrayBuffer",value:function(t){return this.zip.generate(n(n({compression:"DEFLATE",fileOrder:Z},t),{},{type:"arraybuffer"}))}}],i&&l(r.prototype,i),o&&l(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,o}();K.DocUtils=c,K.Errors=lo(),K.XmlTemplater=$s(),K.FileTypeConfig=function(){if(Ps)return ks;Ps=1;var t=Ws(),e=Qs(),r=Ks(),n=tl(),i=el();return ks={docx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(t){return t.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","cp:contentStatus","w:t","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["w:proofState","w:tc","w:tr","w:tbl","w:body","w:document","w:p","w:r","w:br","w:rPr","w:pPr","w:spacing","w:sdtContent","w:sdt","w:drawing","w:sectPr","w:type","w:headerReference","w:footerReference","w:bookmarkStart","w:bookmarkEnd","w:commentRangeStart","w:commentRangeEnd","w:commentReference"],droppedTagsInsidePlaceholder:["w:p","w:br","w:bookmarkStart","w:bookmarkEnd"],expandTags:[{contains:"w:tc",expand:"w:tr"}],onParagraphLoop:[{contains:"w:p",expand:"w:p",onlyTextInTag:!0}],tagRawXml:"w:p",baseModules:[t,e,n,r,i],tagShouldContain:[{tag:"w:sdtContent",shouldContain:["w:p","w:r","w:commentRangeStart","w:sdt"],value:"<w:p></w:p>"},{tag:"w:tc",shouldContain:["w:p"],value:"<w:p></w:p>"},{tag:"w:tr",shouldContain:["w:tc"],drop:!0},{tag:"w:tbl",shouldContain:["w:tr"],drop:!0}]}},pptx:function(){return{getTemplatedFiles:function(){return[]},textPath:function(t){return t.textTarget},tagsXmlTextArray:["Company","HyperlinkBase","Manager","cp:category","cp:keywords","dc:creator","dc:description","dc:subject","dc:title","a:t","m:t","vt:lpstr","vt:lpwstr"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:tbl","a:graphicData","a:p","a:r","a:rPr","p:txBody","a:txBody","a:off","a:ext","p:graphicFrame","p:xfrm","a16:rowId","a:endParaRPr"],droppedTagsInsidePlaceholder:["a:p","a:endParaRPr"],expandTags:[{contains:"a:tc",expand:"a:tr"}],onParagraphLoop:[{contains:"a:p",expand:"a:p",onlyTextInTag:!0}],tagRawXml:"p:sp",baseModules:[t,n,r,i],tagShouldContain:[{tag:"a:tbl",shouldContain:["a:tr"],dropParent:"p:graphicFrame"},{tag:"p:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"},{tag:"a:txBody",shouldContain:["a:p"],value:"<a:p></a:p>"}]}}}}(),K.XmlMatcher=Vs(),t.exports=K,t.exports.default=K}(sr);var rl=sr.exports,nl=pt(rl),il={},al={},ol=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,sl=new RegExp("[\\-\\.0-9"+ol.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),ll=new RegExp("^"+ol.source+sl.source+"*(?::"+ol.source+sl.source+"*)?$");function ul(){}function cl(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function fl(t,e,r,n,i,a){for(var o,s=++e,l=0;;){var u=t.charAt(s);switch(u){case"=":if(1===l)o=t.slice(e,s),l=3;else{if(2!==l)throw new Error("attribute equal must after attrName");l=3}break;case"'":case'"':if(3===l||1===l){if(1===l&&(a.warning('attribute value must after "="'),o=t.slice(e,s)),e=s+1,!((s=t.indexOf(u,e))>0))throw new Error("attribute value no end '"+u+"' match");c=t.slice(e,s).replace(/&#?\w+;/g,i),r.add(o,c,e-1),l=5}else{if(4!=l)throw new Error('attribute value must after "="');c=t.slice(e,s).replace(/&#?\w+;/g,i),r.add(o,c,e),a.warning('attribute "'+o+'" missed start quot('+u+")!!"),e=s+1,l=5}break;case"/":switch(l){case 0:r.setTagName(t.slice(e,s));case 5:case 6:case 7:l=7,r.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==l&&r.setTagName(t.slice(e,s)),s;case">":switch(l){case 0:r.setTagName(t.slice(e,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(c=t.slice(e,s)).slice(-1)&&(r.closed=!0,c=c.slice(0,-1));case 2:2===l&&(c=o),4==l?(a.warning('attribute "'+c+'" missed quot(")!!'),r.add(o,c.replace(/&#?\w+;/g,i),e)):("http://www.w3.org/1999/xhtml"===n[""]&&c.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),r.add(c,c,e));break;case 3:throw new Error("attribute value missed!!")}return s;case"":u=" ";default:if(u<=" ")switch(l){case 0:r.setTagName(t.slice(e,s)),l=6;break;case 1:o=t.slice(e,s),l=2;break;case 4:var c=t.slice(e,s).replace(/&#?\w+;/g,i);a.warning('attribute "'+c+'" missed quot(")!!'),r.add(o,c,e);case 5:l=6}else switch(l){case 2:r.tagName,"http://www.w3.org/1999/xhtml"===n[""]&&o.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),r.add(o,o,e),e=s,l=1;break;case 5:a.warning('attribute space is required"'+o+'"!!');case 6:l=1,e=s;break;case 3:l=4,e=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function pl(t,e,r){for(var n=t.tagName,i=null,a=t.length;a--;){var o=t[a],s=o.qName,l=o.value;if((p=s.indexOf(":"))>0)var u=o.prefix=s.slice(0,p),c=s.slice(p+1),f="xmlns"===u&&c;else c=s,u=null,f="xmlns"===s&&"";o.localName=c,!1!==f&&(null==i&&(i={},ml(r,r={})),r[f]=i[f]=l,o.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(f,l))}for(a=t.length;a--;){(u=(o=t[a]).prefix)&&("xml"===u&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(o.uri=r[u||""]))}var p;(p=n.indexOf(":"))>0?(u=t.prefix=n.slice(0,p),c=t.localName=n.slice(p+1)):(u=null,c=t.localName=n);var h=t.uri=r[u||""];if(e.startElement(h,c,n,t),!t.closed)return t.currentNSMap=r,t.localNSMap=i,!0;if(e.endElement(h,c,n),i)for(u in i)e.endPrefixMapping(u)}function hl(t,e,r,n,i){if(/^(?:script|textarea)$/i.test(r)){var a=t.indexOf("</"+r+">",e),o=t.substring(e+1,a);if(/[&<]/.test(o))return/^script$/i.test(r)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,n),i.characters(o,0,o.length),a)}return e+1}function dl(t,e,r,n){var i=n[r];return null==i&&((i=t.lastIndexOf("</"+r+">"))<e&&(i=t.lastIndexOf("</"+r)),n[r]=i),i<e}function ml(t,e){for(var r in t)e[r]=t[r]}function gl(t,e,r,n){if("-"===t.charAt(e+2))return"-"===t.charAt(e+3)?(i=t.indexOf("--\x3e",e+4))>e?(r.comment(t,e+4,i-e-4),i+3):(n.error("Unclosed comment"),-1):-1;if("CDATA["==t.substr(e+3,6)){var i=t.indexOf("]]>",e+9);return r.startCDATA(),r.characters(t,e+9,i-e-9),r.endCDATA(),i+3}var a=function(t,e){var r,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=e,i.exec(t);for(;r=i.exec(t);)if(n.push(r),r[1])return n}(t,e),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],l=o>3&&/^public$/i.test(a[2][0])&&a[3][0],u=o>4&&a[4][0],c=a[o-1];return r.startDTD(s,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),c.index+c[0].length}return-1}function vl(t,e,r){var n=t.indexOf("?>",e);if(n){var i=t.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return i?(i[0].length,r.processingInstruction(i[1],i[2]),n+2):-1}return-1}function yl(t){}function bl(t,e){return t.__proto__=e,t}ul.prototype={parse:function(t,e,r){var n=this.domBuilder;n.startDocument(),ml(e,e={}),function(t,e,r,n,i){function a(t){if(t>65535){var e=55296+((t-=65536)>>10),r=56320+(1023&t);return String.fromCharCode(e,r)}return String.fromCharCode(t)}function o(t){var e=t.slice(1,-1);return e in r?r[e]:"#"===e.charAt(0)?a(parseInt(e.substr(1).replace("x","0x"))):(i.error("entity not found:"+t),t)}function s(e){if(e>m){var r=t.substring(m,e).replace(/&#?\w+;/g,o);p&&l(m),n.characters(r,0,e-m),m=e}}function l(e,r){for(;e>=c&&(r=f.exec(t));)u=r.index,c=u+r[0].length,p.lineNumber++;p.columnNumber=e-u+1}var u=0,c=0,f=/.*(?:\r\n?|\n)|.*$/g,p=n.locator,h=[{currentNSMap:e}],d={},m=0;for(;;){try{var g=t.indexOf("<",m);if(g<0){if(!t.substr(m).match(/^\s*$/)){var v=n.doc,y=v.createTextNode(t.substr(m));v.appendChild(y),n.currentElement=y}return}switch(g>m&&s(g),t.charAt(g+1)){case"/":var b=t.indexOf(">",g+3),w=t.substring(g+2,b),E=h.pop();b<0?(w=t.substring(g+2).replace(/[\s<].*/,""),i.error("end tag name: "+w+" is not complete:"+E.tagName),b=g+1+w.length):w.match(/\s</)&&(w=w.replace(/[\s<].*/,""),i.error("end tag name: "+w+" maybe not complete"),b=g+1+w.length);var x=E.localNSMap,_=E.tagName==w;if(_||E.tagName&&E.tagName.toLowerCase()==w.toLowerCase()){if(n.endElement(E.uri,E.localName,w),x)for(var T in x)n.endPrefixMapping(T);_||i.fatalError("end tag name: "+w+" is not match the current start tagName:"+E.tagName)}else h.push(E);b++;break;case"?":p&&l(g),b=vl(t,g,n);break;case"!":p&&l(g),b=gl(t,g,n,i);break;default:p&&l(g);var N=new yl,S=h[h.length-1].currentNSMap,O=(b=fl(t,g,N,S,o,i),N.length);if(!N.closed&&dl(t,b,N.tagName,d)&&(N.closed=!0,r.nbsp||i.warning("unclosed xml attribute")),p&&O){for(var A=cl(p,{}),C=0;C<O;C++){var I=N[C];l(I.offset),I.locator=cl(p,{})}n.locator=A,pl(N,n,S)&&h.push(N),n.locator=p}else pl(N,n,S)&&h.push(N);"http://www.w3.org/1999/xhtml"!==N.uri||N.closed?b++:b=hl(t,b,N.tagName,o,n)}}catch(t){i.error("element parse error: "+t),b=-1}b>m?m=b:s(Math.max(g,m)+1)}}(t,e,r,n,this.errorHandler),n.endDocument()}},yl.prototype={setTagName:function(t){if(!ll.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},add:function(t,e,r){if(!ll.test(t))throw new Error("invalid attribute:"+t);this[this.length++]={qName:t,value:e,offset:r}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},bl({},bl.prototype)instanceof bl||(bl=function(t,e){function r(){}for(e in r.prototype=e,r=new r,t)r[e]=t[e];return r}),al.XMLReader=ul;var wl={};function El(t,e){for(var r in t)e[r]=t[r]}function xl(t,e){var r=t.prototype;if(Object.create){var n=Object.create(e.prototype);r.__proto__=n}if(!(r instanceof e)){function i(){}i.prototype=e.prototype,El(r,i=new i),t.prototype=r=i}r.constructor!=t&&("function"!=typeof t&&console.error("unknow Class:"+t),r.constructor=t)}var _l={},Tl=_l.ELEMENT_NODE=1,Nl=_l.ATTRIBUTE_NODE=2,Sl=_l.TEXT_NODE=3,Ol=_l.CDATA_SECTION_NODE=4,Al=_l.ENTITY_REFERENCE_NODE=5,Cl=_l.ENTITY_NODE=6,Il=_l.PROCESSING_INSTRUCTION_NODE=7,Dl=_l.COMMENT_NODE=8,kl=_l.DOCUMENT_NODE=9,Pl=_l.DOCUMENT_TYPE_NODE=10,Rl=_l.DOCUMENT_FRAGMENT_NODE=11,Ll=_l.NOTATION_NODE=12,Ml={},Ul={};Ml.INDEX_SIZE_ERR=(Ul[1]="Index size error",1),Ml.DOMSTRING_SIZE_ERR=(Ul[2]="DOMString size error",2);var zl=Ml.HIERARCHY_REQUEST_ERR=(Ul[3]="Hierarchy request error",3);Ml.WRONG_DOCUMENT_ERR=(Ul[4]="Wrong document",4),Ml.INVALID_CHARACTER_ERR=(Ul[5]="Invalid character",5),Ml.NO_DATA_ALLOWED_ERR=(Ul[6]="No data allowed",6),Ml.NO_MODIFICATION_ALLOWED_ERR=(Ul[7]="No modification allowed",7);var jl=Ml.NOT_FOUND_ERR=(Ul[8]="Not found",8);Ml.NOT_SUPPORTED_ERR=(Ul[9]="Not supported",9);var Fl=Ml.INUSE_ATTRIBUTE_ERR=(Ul[10]="Attribute in use",10);function Bl(t,e){if(e instanceof Error)var r=e;else r=this,Error.call(this,Ul[t]),this.message=Ul[t],Error.captureStackTrace&&Error.captureStackTrace(this,Bl);return r.code=t,e&&(this.message=this.message+": "+e),r}function ql(){}function Hl(t,e){this._node=t,this._refresh=e,Vl(this)}function Vl(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var r=t._refresh(t._node);xu(t,"length",r.length),El(r,t),t._inc=e}}function Xl(){}function Gl(t,e){for(var r=t.length;r--;)if(t[r]===e)return r}function Zl(t,e,r,n){if(n?e[Gl(e,n)]=r:e[e.length++]=r,t){r.ownerElement=t;var i=t.ownerDocument;i&&(n&&tu(i,t,n),function(t,e,r){t&&t._inc++;var n=r.namespaceURI;"http://www.w3.org/2000/xmlns/"==n&&(e._nsMap[r.prefix?r.localName:""]=r.value)}(i,t,r))}}function Yl(t,e,r){var n=Gl(e,r);if(!(n>=0))throw Bl(jl,new Error(t.tagName+"@"+r));for(var i=e.length-1;n<i;)e[n]=e[++n];if(e.length=i,t){var a=t.ownerDocument;a&&(tu(a,t,r),r.ownerElement=null)}}function $l(t){if(this._features={},t)for(var e in t)this._features=t[e]}function Wl(){}function Ql(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function Kl(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(Kl(t,e))return!0}while(t=t.nextSibling)}function Jl(){}function tu(t,e,r,n){t&&t._inc++,"http://www.w3.org/2000/xmlns/"==r.namespaceURI&&delete e._nsMap[r.prefix?r.localName:""]}function eu(t,e,r){if(t&&t._inc){t._inc++;var n=e.childNodes;if(r)n[n.length++]=r;else{for(var i=e.firstChild,a=0;i;)n[a++]=i,i=i.nextSibling;n.length=a}}}function ru(t,e){var r=e.previousSibling,n=e.nextSibling;return r?r.nextSibling=n:t.firstChild=n,n?n.previousSibling=r:t.lastChild=r,eu(t.ownerDocument,t),e}function nu(t,e,r){var n=e.parentNode;if(n&&n.removeChild(e),e.nodeType===Rl){var i=e.firstChild;if(null==i)return e;var a=e.lastChild}else i=a=e;var o=r?r.previousSibling:t.lastChild;i.previousSibling=o,a.nextSibling=r,o?o.nextSibling=i:t.firstChild=i,null==r?t.lastChild=a:r.previousSibling=a;do{i.parentNode=t}while(i!==a&&(i=i.nextSibling));return eu(t.ownerDocument||t,t),e.nodeType==Rl&&(e.firstChild=e.lastChild=null),e}function iu(){this._nsMap={}}function au(){}function ou(){}function su(){}function lu(){}function uu(){}function cu(){}function fu(){}function pu(){}function hu(){}function du(){}function mu(){}function gu(){}function vu(t,e){var r=[],n=9==this.nodeType?this.documentElement:this,i=n.prefix,a=n.namespaceURI;if(a&&null==i&&null==(i=n.lookupPrefix(a)))var o=[{namespace:a,prefix:null}];return bu(this,r,t,e,o),r.join("")}function yu(t,e,r){var n=t.prefix||"",i=t.namespaceURI;if(!n&&!i)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var a=r.length;a--;){var o=r[a];if(o.prefix==n)return o.namespace!=i}return!0}function bu(t,e,r,n,i){if(n){if(!(t=n(t)))return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case Tl:i||(i=[]),i.length;var a=t.attributes,o=a.length,s=t.firstChild,l=t.tagName;r="http://www.w3.org/1999/xhtml"===t.namespaceURI||r,e.push("<",l);for(var u=0;u<o;u++){"xmlns"==(c=a.item(u)).prefix?i.push({prefix:c.localName,namespace:c.value}):"xmlns"==c.nodeName&&i.push({prefix:"",namespace:c.value})}for(u=0;u<o;u++){var c;if(yu(c=a.item(u),0,i)){var f=c.prefix||"",p=c.namespaceURI,h=f?" xmlns:"+f:" xmlns";e.push(h,'="',p,'"'),i.push({prefix:f,namespace:p})}bu(c,e,r,n,i)}if(yu(t,0,i)){f=t.prefix||"",p=t.namespaceURI,h=f?" xmlns:"+f:" xmlns";e.push(h,'="',p,'"'),i.push({prefix:f,namespace:p})}if(s||r&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(e.push(">"),r&&/^script$/i.test(l))for(;s;)s.data?e.push(s.data):bu(s,e,r,n,i),s=s.nextSibling;else for(;s;)bu(s,e,r,n,i),s=s.nextSibling;e.push("</",l,">")}else e.push("/>");return;case kl:case Rl:for(s=t.firstChild;s;)bu(s,e,r,n,i),s=s.nextSibling;return;case Nl:return e.push(" ",t.name,'="',t.value.replace(/[<&"]/g,Ql),'"');case Sl:return e.push(t.data.replace(/[<&]/g,Ql));case Ol:return e.push("<![CDATA[",t.data,"]]>");case Dl:return e.push("\x3c!--",t.data,"--\x3e");case Pl:var d=t.publicId,m=t.systemId;if(e.push("<!DOCTYPE ",t.name),d)e.push(' PUBLIC "',d),m&&"."!=m&&e.push('" "',m),e.push('">');else if(m&&"."!=m)e.push(' SYSTEM "',m,'">');else{var g=t.internalSubset;g&&e.push(" [",g,"]"),e.push(">")}return;case Il:return e.push("<?",t.target," ",t.data,"?>");case Al:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function wu(t,e,r){var n;switch(e.nodeType){case Tl:(n=e.cloneNode(!1)).ownerDocument=t;case Rl:break;case Nl:r=!0}if(n||(n=e.cloneNode(!1)),n.ownerDocument=t,n.parentNode=null,r)for(var i=e.firstChild;i;)n.appendChild(wu(t,i,r)),i=i.nextSibling;return n}function Eu(t,e,r){var n=new e.constructor;for(var i in e){var a=e[i];"object"!=typeof a&&a!=n[i]&&(n[i]=a)}switch(e.childNodes&&(n.childNodes=new ql),n.ownerDocument=t,n.nodeType){case Tl:var o=e.attributes,s=n.attributes=new Xl,l=o.length;s._ownerElement=n;for(var u=0;u<l;u++)n.setAttributeNode(Eu(t,o.item(u),!0));break;case Nl:r=!0}if(r)for(var c=e.firstChild;c;)n.appendChild(Eu(t,c,r)),c=c.nextSibling;return n}function xu(t,e,r){t[e]=r}Ml.INVALID_STATE_ERR=(Ul[11]="Invalid state",11),Ml.SYNTAX_ERR=(Ul[12]="Syntax error",12),Ml.INVALID_MODIFICATION_ERR=(Ul[13]="Invalid modification",13),Ml.NAMESPACE_ERR=(Ul[14]="Invalid namespace",14),Ml.INVALID_ACCESS_ERR=(Ul[15]="Invalid access",15),Bl.prototype=Error.prototype,El(Ml,Bl),ql.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var r=[],n=0;n<this.length;n++)bu(this[n],r,t,e);return r.join("")}},Hl.prototype.item=function(t){return Vl(this),this[t]},xl(Hl,ql),Xl.prototype={length:0,item:ql.prototype.item,getNamedItem:function(t){for(var e=this.length;e--;){var r=this[e];if(r.nodeName==t)return r}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new Bl(Fl);var r=this.getNamedItem(t.nodeName);return Zl(this._ownerElement,this,t,r),r},setNamedItemNS:function(t){var e,r=t.ownerElement;if(r&&r!=this._ownerElement)throw new Bl(Fl);return e=this.getNamedItemNS(t.namespaceURI,t.localName),Zl(this._ownerElement,this,t,e),e},removeNamedItem:function(t){var e=this.getNamedItem(t);return Yl(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var r=this.getNamedItemNS(t,e);return Yl(this._ownerElement,this,r),r},getNamedItemNS:function(t,e){for(var r=this.length;r--;){var n=this[r];if(n.localName==e&&n.namespaceURI==t)return n}return null}},$l.prototype={hasFeature:function(t,e){var r=this._features[t.toLowerCase()];return!(!r||e&&!(e in r))},createDocument:function(t,e,r){var n=new Jl;if(n.implementation=this,n.childNodes=new ql,n.doctype=r,r&&n.appendChild(r),e){var i=n.createElementNS(t,e);n.appendChild(i)}return n},createDocumentType:function(t,e,r){var n=new cu;return n.name=t,n.nodeName=t,n.publicId=e,n.systemId=r,n}},Wl.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return nu(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return ru(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return Eu(this.ownerDocument||this,this,t)},normalize:function(){for(var t=this.firstChild;t;){var e=t.nextSibling;e&&e.nodeType==Sl&&t.nodeType==Sl?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){for(var e=this;e;){var r=e._nsMap;if(r)for(var n in r)if(r[n]==t)return n;e=e.nodeType==Nl?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){for(var e=this;e;){var r=e._nsMap;if(r&&t in r)return r[t];e=e.nodeType==Nl?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){return null==this.lookupPrefix(t)}},El(_l,Wl),El(_l,Wl.prototype),Jl.prototype={nodeName:"#document",nodeType:kl,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==Rl){for(var r=t.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,e),r=n}return t}return null==this.documentElement&&t.nodeType==Tl&&(this.documentElement=t),nu(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),ru(this,t)},importNode:function(t,e){return wu(this,t,e)},getElementById:function(t){var e=null;return Kl(this.documentElement,function(r){if(r.nodeType==Tl&&r.getAttribute("id")==t)return e=r,!0}),e},createElement:function(t){var e=new iu;return e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.childNodes=new ql,(e.attributes=new Xl)._ownerElement=e,e},createDocumentFragment:function(){var t=new du;return t.ownerDocument=this,t.childNodes=new ql,t},createTextNode:function(t){var e=new su;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new lu;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new uu;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var r=new mu;return r.ownerDocument=this,r.tagName=r.target=t,r.nodeValue=r.data=e,r},createAttribute:function(t){var e=new au;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new hu;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var r=new iu,n=e.split(":"),i=r.attributes=new Xl;return r.childNodes=new ql,r.ownerDocument=this,r.nodeName=e,r.tagName=e,r.namespaceURI=t,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=e,i._ownerElement=r,r},createAttributeNS:function(t,e){var r=new au,n=e.split(":");return r.ownerDocument=this,r.nodeName=e,r.name=e,r.namespaceURI=t,r.specified=!0,2==n.length?(r.prefix=n[0],r.localName=n[1]):r.localName=e,r}},xl(Jl,Wl),iu.prototype={nodeType:Tl,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var r=this.ownerDocument.createAttribute(t);r.value=r.nodeValue=""+e,this.setAttributeNode(r)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===Rl?this.insertBefore(t,null):function(t,e){var r=e.parentNode;if(r){var n=t.lastChild;r.removeChild(e),n=t.lastChild}return n=t.lastChild,e.parentNode=t,e.previousSibling=n,e.nextSibling=null,n?n.nextSibling=e:t.firstChild=e,t.lastChild=e,eu(t.ownerDocument,t,e),e}(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);r&&this.removeAttributeNode(r)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var r=this.getAttributeNodeNS(t,e);return r&&r.value||""},setAttributeNS:function(t,e,r){var n=this.ownerDocument.createAttributeNS(t,e);n.value=n.nodeValue=""+r,this.setAttributeNode(n)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new Hl(this,function(e){var r=[];return Kl(e,function(n){n===e||n.nodeType!=Tl||"*"!==t&&n.tagName!=t||r.push(n)}),r})},getElementsByTagNameNS:function(t,e){return new Hl(this,function(r){var n=[];return Kl(r,function(i){i===r||i.nodeType!==Tl||"*"!==t&&i.namespaceURI!==t||"*"!==e&&i.localName!=e||n.push(i)}),n})}},Jl.prototype.getElementsByTagName=iu.prototype.getElementsByTagName,Jl.prototype.getElementsByTagNameNS=iu.prototype.getElementsByTagNameNS,xl(iu,Wl),au.prototype.nodeType=Nl,xl(au,Wl),ou.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(Ul[zl])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,r){r=this.data.substring(0,t)+r+this.data.substring(t+e),this.nodeValue=this.data=r,this.length=r.length}},xl(ou,Wl),su.prototype={nodeName:"#text",nodeType:Sl,splitText:function(t){var e=this.data,r=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},xl(su,ou),lu.prototype={nodeName:"#comment",nodeType:Dl},xl(lu,ou),uu.prototype={nodeName:"#cdata-section",nodeType:Ol},xl(uu,ou),cu.prototype.nodeType=Pl,xl(cu,Wl),fu.prototype.nodeType=Ll,xl(fu,Wl),pu.prototype.nodeType=Cl,xl(pu,Wl),hu.prototype.nodeType=Al,xl(hu,Wl),du.prototype.nodeName="#document-fragment",du.prototype.nodeType=Rl,xl(du,Wl),mu.prototype.nodeType=Il,xl(mu,Wl),gu.prototype.serializeToString=function(t,e,r){return vu.call(t,e,r)},Wl.prototype.toString=vu;try{if(Object.defineProperty){function yf(t){switch(t.nodeType){case Tl:case Rl:var e=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&e.push(yf(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}}Object.defineProperty(Hl.prototype,"length",{get:function(){return Vl(this),this.$$length}}),Object.defineProperty(Wl.prototype,"textContent",{get:function(){return yf(this)},set:function(t){switch(this.nodeType){case Tl:case Rl:for(;this.firstChild;)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),xu=function(t,e,r){t["$$"+e]=r}}}catch(bf){}function _u(t){this.options=t||{locator:{}}}function Tu(){this.cdata=!1}function Nu(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function Su(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function Ou(t,e,r){return"string"==typeof t?t.substr(e,r):t.length>=e+r||e?new java.lang.String(t,e,r)+"":t}function Au(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}wl.DOMImplementation=$l,wl.XMLSerializer=gu,_u.prototype.parseFromString=function(t,e){var r=this.options,n=new Cu,i=r.domBuilder||new Tu,a=r.errorHandler,o=r.locator,s=r.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return o&&i.setDocumentLocator(o),n.errorHandler=function(t,e,r){if(!t){if(e instanceof Tu)return e;t=e}var n={},i=t instanceof Function;function a(e){var a=t[e];!a&&i&&(a=2==t.length?function(r){t(e,r)}:t),n[e]=a&&function(t){a("[xmldom "+e+"]\t"+t+Su(r))}||function(){}}return r=r||{},a("warning"),a("error"),a("fatalError"),n}(a,i,o),n.domBuilder=r.domBuilder||i,/\/x?html?$/.test(e)&&(l.nbsp="",l.copy="",s[""]="http://www.w3.org/1999/xhtml"),s.xml=s.xml||"http://www.w3.org/XML/1998/namespace",t?n.parse(t,s,l):n.errorHandler.error("invalid doc source"),i.doc},Tu.prototype={startDocument:function(){this.doc=(new Iu).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,r,n){var i=this.doc,a=i.createElementNS(t,r||e),o=n.length;Au(this,a),this.currentElement=a,this.locator&&Nu(this.locator,a);for(var s=0;s<o;s++){t=n.getURI(s);var l=n.getValue(s),u=(r=n.getQName(s),i.createAttributeNS(t,r));this.locator&&Nu(n.getLocator(s),u),u.value=u.nodeValue=l,a.setAttributeNode(u)}},endElement:function(t,e,r){var n=this.currentElement;n.tagName,this.currentElement=n.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var r=this.doc.createProcessingInstruction(t,e);this.locator&&Nu(this.locator,r),Au(this,r)},ignorableWhitespace:function(t,e,r){},characters:function(t,e,r){if(t=Ou.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(t);else n=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(t)&&this.doc.appendChild(n),this.locator&&Nu(this.locator,n)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,r){t=Ou.apply(this,arguments);var n=this.doc.createComment(t);this.locator&&Nu(this.locator,n),Au(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,r){var n=this.doc.implementation;if(n&&n.createDocumentType){var i=n.createDocumentType(t,e,r);this.locator&&Nu(this.locator,i),Au(this,i)}},warning:function(t){console.warn("[xmldom warning]\t"+t,Su(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,Su(this.locator))},fatalError:function(t){throw console.error("[xmldom fatalError]\t"+t,Su(this.locator)),t}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){Tu.prototype[t]=function(){return null}});var Cu=al.XMLReader,Iu=il.DOMImplementation=wl.DOMImplementation;il.XMLSerializer=wl.XMLSerializer,il.DOMParser=_u;var Du=rl.DocUtils;Du.convertPixelsToEmus=function(t){return Math.round(9525*t)};var ku=Du,Pu=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var Ru=ku,Lu=/[^.]+\.([^.]+)/,Mu={getPrefix:function(t){return"docx"===t?"word":"ppt"},getFileTypeName:function(t){return"docx"===t?"document":"presentation"},getRelsFileName:function(t){return t.replace(/^.*?([a-zA-Z0-9]+)\.xml$/,"$1")+".xml.rels"},getRelsFilePath:function(t,e){return("pptx"===e?"ppt/slides":"word")+"/_rels/"+Mu.getRelsFileName(t)}},Uu=function(){function t(e,r,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.fileName=r,this.prefix=Mu.getPrefix(i),this.zip=e,this.xmlDocuments=n,this.fileTypeName=Mu.getFileTypeName(i),this.mediaPrefix="pptx"===i?"../media":"media";var a=Mu.getRelsFilePath(r,i);this.relsDoc=n[a]||this.createEmptyRelsDoc(n,a)}return Pu(t,[{key:"createEmptyRelsDoc",value:function(t,e){var r=this.prefix+"/_rels/"+this.fileTypeName+".xml.rels",n=t[r];if(!n){var i=new Error("Could not copy from empty relsdoc");throw i.properties={mainRels:r,relsFileName:e,files:Object.keys(this.zip.files)},i}for(var a=Ru.str2xml(Ru.xml2str(n)),o=a.getElementsByTagName("Relationships")[0],s=o.getElementsByTagName("Relationship"),l=0,u=s.length;l<u;l++)o.removeChild(s[l]);return t[e]=a,a}},{key:"loadImageRels",value:function(){var t=this.relsDoc.getElementsByTagName("Relationship");return Array.prototype.reduce.call(t,function(t,e){var r=e.getAttribute("Id");return/^rId[0-9]+$/.test(r)?Math.max(t,parseInt(r.substr(3),10)):t},0)}},{key:"addExtensionRels",value:function(t,e){var r=this.xmlDocuments["[Content_Types].xml"],n=r.getElementsByTagName("Default");if(!Array.prototype.some.call(n,function(t){return t.getAttribute("Extension")===e})){var i=r.getElementsByTagName("Types")[0],a=r.createElement("Default");a.namespaceURI=null,a.setAttribute("ContentType",t),a.setAttribute("Extension",e),i.appendChild(a)}}},{key:"addImageRels",value:function(t,e,r){null==r&&(r=0);var n=0===r?t:t+"("+r+")",i=this.prefix+"/media/"+n;if(null!=this.zip.files[i])return this.addImageRels(t,e,r+1);var a={name:i,data:e,options:{binary:!0}};this.zip.file(a.name,a.data,a.options);var o=n.replace(Lu,"$1");this.addExtensionRels("image/"+o,o);var s=this.relsDoc.getElementsByTagName("Relationships")[0],l=this.relsDoc.createElement("Relationship");l.namespaceURI=null;var u=this.loadImageRels()+1;return l.setAttribute("Id","rId"+u),l.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),l.setAttribute("Target",this.mediaPrefix+"/"+n),s.appendChild(l),u}}]),t}(),zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var Fu={getImageXml:function(t,e){return('<w:drawing>\n\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t<wp:extent cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t<wp:effectExtent l="0" t="0" r="0" b="0"/>\n\t\t\t<wp:docPr id="2" name="Image 2" descr="image"/>\n\t\t\t<wp:cNvGraphicFramePr>\n\t\t\t\t<a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/>\n\t\t\t</wp:cNvGraphicFramePr>\n\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture 1" descr="image"/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+t+'">\n\t\t\t\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t\t\t\t</a:extLst>\n\t\t\t\t\t\t\t</a:blip>\n\t\t\t\t\t\t\t<a:srcRect/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln>\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t</pic:pic>\n\t\t\t\t</a:graphicData>\n\t\t\t</a:graphic>\n\t\t</wp:inline>\n\t</w:drawing>\n\t\t').replace(/\t|\n/g,"")},getImageXmlCentered:function(t,e){return('<w:p>\n\t\t\t<w:pPr>\n\t\t\t\t<w:jc w:val="center"/>\n\t\t\t</w:pPr>\n\t\t\t<w:r>\n\t\t\t\t<w:rPr/>\n\t\t\t\t<w:drawing>\n\t\t\t\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t\t\t<wp:extent cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t<wp:docPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+t+'"/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln w="9525">\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t\t</pic:pic>\n\t\t\t\t\t\t</a:graphicData>\n\t\t\t\t\t</a:graphic>\n\t\t\t\t\t</wp:inline>\n\t\t\t\t</w:drawing>\n\t\t\t</w:r>\n\t\t</w:p>\n\t\t').replace(/\t|\n/g,"")},getPptxImageXml:function(t,e,r){return('<p:pic>\n\t\t\t<p:nvPicPr>\n\t\t\t\t<p:cNvPr id="6" name="Picture 2"/>\n\t\t\t\t<p:cNvPicPr>\n\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t</p:cNvPicPr>\n\t\t\t\t<p:nvPr/>\n\t\t\t</p:nvPicPr>\n\t\t\t<p:blipFill>\n\t\t\t\t<a:blip r:embed="rId'+t+'" cstate="print">\n\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t</a:extLst>\n\t\t\t\t</a:blip>\n\t\t\t\t<a:srcRect/>\n\t\t\t\t<a:stretch>\n\t\t\t\t\t<a:fillRect/>\n\t\t\t\t</a:stretch>\n\t\t\t</p:blipFill>\n\t\t\t<p:spPr bwMode="auto">\n\t\t\t\t<a:xfrm>\n\t\t\t\t\t<a:off x="'+r.x+'" y="'+r.y+'"/>\n\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t</a:xfrm>\n\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t<a:avLst/>\n\t\t\t\t</a:prstGeom>\n\t\t\t\t<a:noFill/>\n\t\t\t\t<a:ln>\n\t\t\t\t\t<a:noFill/>\n\t\t\t\t</a:ln>\n\t\t\t\t<a:effectLst/>\n\t\t\t\t<a:extLst>\n\t\t\t\t\t<a:ext uri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}">\n\t\t\t\t\t\t<a14:hiddenFill xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="accent1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t</a14:hiddenFill>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{91240B29-F687-4F45-9708-019B960494DF}">\n\t\t\t\t\t\t<a14:hiddenLine xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" w="9525">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="tx1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t</a14:hiddenLine>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{AF507438-7753-43E0-B8FC-AC1667EBCBE1}">\n\t\t\t\t\t\t<a14:hiddenEffects xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:effectLst>\n\t\t\t\t\t\t\t\t<a:outerShdw dist="35921" dir="2700000" algn="ctr" rotWithShape="0">\n\t\t\t\t\t\t\t\t\t<a:schemeClr val="bg2"/>\n\t\t\t\t\t\t\t\t</a:outerShdw>\n\t\t\t\t\t\t\t</a:effectLst>\n\t\t\t\t\t\t</a14:hiddenEffects>\n\t\t\t\t\t</a:ext>\n\t\t\t\t</a:extLst>\n\t\t\t</p:spPr>\n\t\t</p:pic>\n\t\t').replace(/\t|\n/g,"")}},Bu=rl.DocUtils,qu=il.DOMParser;var Hu=Uu,Vu="open-xml-templating/docxtemplater-image-module";function Xu(t){return t.part}function Gu(t){var e=t.part,r=t.left,n=t.right,i=t.postparsed.slice(r+1,n).reduce(function(t,e){return t+e.value},""),a=(new qu).parseFromString("<xml>"+i+"</xml>");e.offset={x:0,y:0},e.ext={cx:0,cy:0};var o=a.getElementsByTagName("a:off"),s=a.getElementsByTagName("a:ext");return s.length>0&&(e.ext.cx=parseInt(s[s.length-1].getAttribute("cx"),10),e.ext.cy=parseInt(s[s.length-1].getAttribute("cy"),10)),o.length>0&&(e.offset.x=parseInt(o[o.length-1].getAttribute("x"),10),e.offset.y=parseInt(o[o.length-1].getAttribute("y"),10)),e}var Zu=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.name="ImageModule",this.options=e||{},this.imgManagers={},null==this.options.centered&&(this.options.centered=!1),null==this.options.getImage)throw new Error("You should pass getImage");if(null==this.options.getSize)throw new Error("You should pass getSize");this.imageNumber=1}return ju(t,[{key:"optionsTransformer",value:function(t,e){var r=e.zip.file(/\.xml\.rels/).concat(e.zip.file(/\[Content_Types\].xml/)).map(function(t){return t.name});return this.fileTypeConfig=e.fileTypeConfig,this.fileType=e.fileType,this.zip=e.zip,t.xmlFileNames=t.xmlFileNames.concat(r),t}},{key:"set",value:function(t){t.zip&&(this.zip=t.zip),t.xmlDocuments&&(this.xmlDocuments=t.xmlDocuments)}},{key:"parse",value:function(t){var e=Vu,r="placeholder";return this.options.setParser?this.options.setParser(t):"%%"===t.substring(0,2)?{type:r,value:t.substr(2),module:e,centered:!0}:"%"===t.substring(0,1)?{type:r,value:t.substr(1),module:e,centered:!1}:null}},{key:"postparse",value:function(t){var e=void 0,r=void 0;return"pptx"===this.fileType?(e="p:sp",r=Gu):(e=this.options.centered?"w:p":"w:t",r=Xu),Bu.traits.expandToOne(t,{moduleName:Vu,getInner:r,expandTo:e})}},{key:"render",value:function(t,e){if("placeholder"===!t.type||t.module!==Vu)return null;var r=e.scopeManager.getValue(t.value,{part:t});if(!r)return{value:this.fileTypeConfig.tagTextXml};if("object"===(void 0===r?"undefined":zu(r)))return this.getRenderedPart(t,r.rId,r.sizePixel);var n=new Hu(this.zip,e.filePath,this.xmlDocuments,this.fileType),i=this.options.getImage(r,t.value),a=n.addImageRels(this.getNextImageName(),i),o=this.options.getSize(i,r,t.value);return this.getRenderedPart(t,a,o)}},{key:"resolve",value:function(t,e){var r=this,n=new Hu(this.zip,e.filePath,this.xmlDocuments,this.fileType);if("placeholder"===!t.type||t.module!==Vu)return null;var i=e.scopeManager.getValue(t.value,{part:t});return i?new Promise(function(e){e(r.options.getImage(i,t.value))}).then(function(e){var a=n.addImageRels(r.getNextImageName(),e);return new Promise(function(n){n(r.options.getSize(e,i,t.value))}).then(function(t){return{rId:a,sizePixel:t}})}):{value:this.fileTypeConfig.tagTextXml}}},{key:"getRenderedPart",value:function(t,e,r){if((n=e)!=n)throw new Error("rId is NaN, aborting");var n,i=[Bu.convertPixelsToEmus(r[0]),Bu.convertPixelsToEmus(r[1])],a=this.options.centered||t.centered;return{value:"pptx"===this.fileType?this.getRenderedPartPptx(t,e,i,a):this.getRenderedPartDocx(e,i,a)}}},{key:"getRenderedPartPptx",value:function(t,e,r,n){var i={x:parseInt(t.offset.x,10),y:parseInt(t.offset.y,10)},a=parseInt(t.ext.cx,10)||1,o=parseInt(t.ext.cy,10)||1,s=parseInt(r[0],10)||1,l=parseInt(r[1],10)||1;return n&&(i.x=Math.round(i.x+a/2-s/2),i.y=Math.round(i.y+o/2-l/2)),Fu.getPptxImageXml(e,[s,l],i)}},{key:"getRenderedPartDocx",value:function(t,e,r){return r?Fu.getImageXmlCentered(t,e):Fu.getImageXml(t,e)}},{key:"getNextImageName",value:function(){var t="image_generated_"+this.imageNumber+".png";return this.imageNumber++,t}}]),t}(),Yu=pt(Zu),$u=new TextDecoder,Wu=(t,e=0,r=t.length)=>$u.decode(t.slice(e,r)),Qu=(t,e=0,r=t.length)=>t.slice(e,r).reduce((t,e)=>t+`0${e.toString(16)}`.slice(-2),""),Ku=(t,e)=>new DataView(t.buffer,t.byteOffset+e),Ju=(t,e=0)=>Ku(t,e).getInt16(0,!0),tc=(t,e=0)=>Ku(t,e).getUint16(0,!1),ec=(t,e=0)=>Ku(t,e).getUint16(0,!0),rc=(t,e=0)=>{const r=Ku(t,e);return r.getUint16(0,!0)+(r.getUint8(2)<<16)},nc=(t,e=0)=>Ku(t,e).getInt32(0,!0),ic=(t,e=0)=>Ku(t,e).getUint32(0,!1),ac=(t,e=0)=>Ku(t,e).getUint32(0,!0),oc=(t,e,r)=>Ku(t,e).getBigUint64(0,!r),sc={readUInt16BE:tc,readUInt16LE:ec,readUInt32BE:ic,readUInt32LE:ac};function lc(t,e,r=0,n=!1){return sc[`readUInt${e}${n?"BE":"LE"}`](t,r)}function uc(t,e){if(t.length-e<4)return;const r=ic(t,e);return t.length-e<r?void 0:{name:Wu(t,4+e,8+e),offset:e,size:r}}function cc(t,e,r){for(;r<t.length;){const n=uc(t,r);if(!n)break;if(n.name===e)return n;r+=n.size>0?n.size:8}}var fc={validate:t=>"BM"===Wu(t,0,2),calculate:t=>({height:Math.abs(nc(t,22)),width:ac(t,18)})};function pc(t,e){const r=t[e];return 0===r?256:r}function hc(t,e){const r=6+16*e;return{height:pc(t,r+1),width:pc(t,r)}}var dc={validate(t){const e=ec(t,0),r=ec(t,4);if(0!==e||0===r)return!1;return 1===ec(t,2)},calculate(t){const e=ec(t,4),r=hc(t,0);if(1===e)return r;const n=[];for(let r=0;r<e;r+=1)n.push(hc(t,r));return{width:r.width,height:r.height,images:n}}},mc={validate(t){const e=ec(t,0),r=ec(t,4);if(0!==e||0===r)return!1;return 2===ec(t,2)},calculate:t=>dc.calculate(t)},gc={validate:t=>542327876===ac(t,0),calculate:t=>({height:ac(t,12),width:ac(t,16)})},vc=/^GIF8[79]a/,yc={validate:t=>vc.test(Wu(t,0,6)),calculate:t=>({height:ec(t,8),width:ec(t,6)})},bc={avif:"avif",mif1:"heif",msf1:"heif",heic:"heic",heix:"heic",hevc:"heic",hevx:"heic"},wc={validate(t){if("ftyp"!==Wu(t,4,8))return!1;const e=cc(t,"ftyp",0);if(!e)return!1;return Wu(t,e.offset+8,e.offset+12)in bc},calculate(t){const e=cc(t,"meta",0),r=e&&cc(t,"iprp",e.offset+12),n=r&&cc(t,"ipco",r.offset+8);if(!n)throw new TypeError("Invalid HEIF, no ipco box found");const i=Wu(t,8,12),a=[];let o=n.offset+8;for(;o<n.offset+n.size;){const e=cc(t,"ispe",o);if(!e)break;const r=ic(t,e.offset+12),i=ic(t,e.offset+16),s=cc(t,"clap",o);let l=r,u=i;if(s&&s.offset<n.offset+n.size){l=r-ic(t,s.offset+12)}a.push({height:u,width:l}),o=e.offset+e.size}if(0===a.length)throw new TypeError("Invalid HEIF, no sizes found");return{width:a[0].width,height:a[0].height,type:i,...a.length>1?{images:a}:{}}}},Ec={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function xc(t,e){const r=e+4;return[Wu(t,e,r),ic(t,r)]}function _c(t){const e=Ec[t];return{width:e,height:e,type:t}}var Tc={validate:t=>"icns"===Wu(t,0,4),calculate(t){const e=t.length,r=ic(t,4);let n=8;const i=[];for(;n<r&&n<e;){const e=xc(t,n),r=_c(e[0]);i.push(r),n+=e[1]}if(0===i.length)throw new TypeError("Invalid ICNS, no sizes found");return{width:i[0].width,height:i[0].height,...i.length>1?{images:i}:{}}}},Nc={validate:t=>4283432785===ic(t,0),calculate:t=>({height:ic(t,12),width:ic(t,8)})},Sc={validate(t){if("jP  "!==Wu(t,4,8))return!1;const e=cc(t,"ftyp",0);if(!e)return!1;return"jp2 "===Wu(t,e.offset+8,e.offset+12)},calculate(t){const e=cc(t,"jp2h",0),r=e&&cc(t,"ihdr",e.offset+8);if(r)return{height:ic(t,r.offset+8),width:ic(t,r.offset+12)};throw new TypeError("Unsupported JPEG 2000 format")}};function Oc(t){return"45786966"===Qu(t,2,6)}function Ac(t,e){return{height:tc(t,e),width:tc(t,e+2)}}function Cc(t,e){const r=t.slice(2,e),n=Qu(r,6,8),i="4d4d"===n;if(i||"4949"===n)return function(t,e){const r=lc(t,16,14,e);for(let n=0;n<r;n++){const r=16+12*n,i=r+12;if(r>t.length)return;const a=t.slice(r,i);if(274===lc(a,16,0,e)){if(3!==lc(a,16,2,e))return;if(1!==lc(a,32,4,e))return;return lc(a,16,8,e)}}}(r,i)}function Ic(t,e){if(e>t.length)throw new TypeError("Corrupt JPG, exceeded buffer limits")}var Dc={validate:t=>"ffd8"===Qu(t,0,2),calculate(t){let e,r,n=t.slice(4);for(;n.length;){const t=tc(n,0);if(Ic(n,t),255===n[t]){if(Oc(n)&&(e=Cc(n,t)),r=n[t+1],192===r||193===r||194===r){const r=Ac(n,t+5);return e?{height:r.height,orientation:e,width:r.width}:r}n=n.slice(t+2)}else n=n.slice(1)}throw new TypeError("Invalid JPG, no size found")}},kc=class{constructor(t,e){this.input=t,this.endianness=e,this.byteOffset=2,this.bitOffset=0}getBits(t=1){let e=0,r=0;for(;r<t;){if(this.byteOffset>=this.input.length)throw new Error("Reached end of input");const n=this.input[this.byteOffset],i=8-this.bitOffset,a=Math.min(t-r,i);if("little-endian"===this.endianness){const t=(1<<a)-1;e|=(n>>this.bitOffset&t)<<r}else{e=e<<a|(n&(1<<a)-1<<8-this.bitOffset-a)>>8-this.bitOffset-a}r+=a,this.bitOffset+=a,8===this.bitOffset&&(this.byteOffset++,this.bitOffset=0)}return e}};function Pc(t,e){if(e)return 8*(1+t.getBits(5));const r=[9,13,18,30][t.getBits(2)];return 1+t.getBits(r)}var Rc={validate:t=>"ff0a"===Qu(t,0,2),calculate(t){const e=new kc(t,"little-endian"),r=1===e.getBits(1),n=Pc(e,r),i=e.getBits(3),a=function(t,e,r,n){return e&&0===r?8*(1+t.getBits(5)):0===r?Pc(t,!1):Math.floor(n*[1,1.2,4/3,1.5,16/9,5/4,2][r-1])}(e,r,i,n);return{width:a,height:n}}};function Lc(t){const e=cc(t,"jxlc",0);if(e)return t.slice(e.offset+8,e.offset+e.size);const r=function(t){const e=[];let r=0;for(;r<t.length;){const n=cc(t,"jxlp",r);if(!n)break;e.push(t.slice(n.offset+12,n.offset+n.size)),r=n.offset+n.size}return e}(t);return r.length>0?function(t){const e=t.reduce((t,e)=>t+e.length,0),r=new Uint8Array(e);let n=0;for(const e of t)r.set(e,n),n+=e.length;return r}(r):void 0}var Mc={validate:t=>{if("JXL "!==Wu(t,4,8))return!1;const e=cc(t,"ftyp",0);if(!e)return!1;return"jxl "===Wu(t,e.offset+8,e.offset+12)},calculate(t){const e=Lc(t);if(e)return Rc.calculate(e);throw new Error("No codestream found in JXL container")}},Uc={validate:t=>{const e=Wu(t,1,7);return["KTX 11","KTX 20"].includes(e)},calculate:t=>{const e=49===t[5]?"ktx":"ktx2",r="ktx"===e?36:20;return{height:ac(t,r+4),width:ac(t,r),type:e}}},zc="CgBI",jc={validate(t){if("PNG\r\n\n"===Wu(t,1,8)){let e=Wu(t,12,16);if(e===zc&&(e=Wu(t,28,32)),"IHDR"!==e)throw new TypeError("Invalid PNG");return!0}return!1},calculate:t=>Wu(t,12,16)===zc?{height:ic(t,36),width:ic(t,32)}:{height:ic(t,20),width:ic(t,16)}},Fc={P1:"pbm/ascii",P2:"pgm/ascii",P3:"ppm/ascii",P4:"pbm",P5:"pgm",P6:"ppm",P7:"pam",PF:"pfm"},Bc={default:t=>{let e=[];for(;t.length>0;){const r=t.shift();if("#"!==r[0]){e=r.split(" ");break}}if(2===e.length)return{height:Number.parseInt(e[1],10),width:Number.parseInt(e[0],10)};throw new TypeError("Invalid PNM")},pam:t=>{const e={};for(;t.length>0;){const r=t.shift();if(r.length>16||r.charCodeAt(0)>128)continue;const[n,i]=r.split(" ");if(n&&i&&(e[n.toLowerCase()]=Number.parseInt(i,10)),e.height&&e.width)break}if(e.height&&e.width)return{height:e.height,width:e.width};throw new TypeError("Invalid PAM")}},qc={validate:t=>Wu(t,0,2)in Fc,calculate(t){const e=Wu(t,0,2),r=Fc[e],n=Wu(t,3).split(/[\r\n]+/);return(Bc[r]||Bc.default)(n)}},Hc={validate:t=>"8BPS"===Wu(t,0,4),calculate:t=>({height:ic(t,14),width:ic(t,18)})},Vc=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/,Xc={height:/\sheight=(['"])([^%]+?)\1/,root:Vc,viewbox:/\sviewBox=(['"])(.+?)\1/i,width:/\swidth=(['"])([^%]+?)\1/},Gc=2.54,Zc={in:96,cm:96/Gc,em:16,ex:8,m:96/Gc*100,mm:96/Gc/10,pc:96/72/12,pt:96/72,px:1},Yc=new RegExp(`^([0-9.]+(?:e\\d+)?)(${Object.keys(Zc).join("|")})?$`);function $c(t){const e=Yc.exec(t);if(e)return Math.round(Number(e[1])*(Zc[e[2]]||1))}function Wc(t){const e=t.split(" ");return{height:$c(e[3]),width:$c(e[2])}}var Qc={validate:t=>Vc.test(Wu(t,0,1e3)),calculate(t){const e=Wu(t).match(Xc.root);if(e){const t=function(t){const e=t.match(Xc.width),r=t.match(Xc.height),n=t.match(Xc.viewbox);return{height:r&&$c(r[2]),viewbox:n&&Wc(n[2]),width:e&&$c(e[2])}}(e[0]);if(t.width&&t.height)return function(t){return{height:t.height,width:t.width}}(t);if(t.viewbox)return function(t,e){const r=e.width/e.height;return t.width?{height:Math.floor(t.width/r),width:t.width}:t.height?{height:t.height,width:Math.floor(t.height*r)}:{height:e.height,width:e.width}}(t,t.viewbox)}throw new TypeError("Invalid SVG")}},Kc={validate:t=>0===ec(t,0)&&0===ec(t,4),calculate:t=>({height:ec(t,14),width:ec(t,12)})},Jc={WIDTH:256,HEIGHT:257,COMPRESSION:259},tf={SHORT:3,LONG:4,LONG8:16},ef={STANDARD:12,BIG:20},rf={STANDARD:2,BIG:8};function nf(t,e,r,n){switch(e){case tf.SHORT:return lc(t,16,r,n);case tf.LONG:return lc(t,32,r,n);case tf.LONG8:{const e=Number(oc(t,r,n));if(e>Number.MAX_SAFE_INTEGER)throw new TypeError("Value too large");return e}default:return 0}}function af(t,e){const r=e?ef.BIG:ef.STANDARD;if(t.length>r)return t.slice(r)}var of=new Set(["49492a00","4d4d002a","49492b00","4d4d002b"]),sf={validate:t=>{const e=Qu(t,0,4);return of.has(e)},calculate(t){const e=function(t){const e=Wu(t,0,2);return{isBigEndian:"MM"===e,isBigTiff:43===lc(t,16,2,"MM"===e)}}(t);e.isBigTiff&&function(t,e){const r=lc(t,16,4,e),n=lc(t,16,6,e);if(8!==r||0!==n)throw new TypeError("Invalid BigTIFF header")}(t,e.isBigEndian);const r=function(t,{isBigEndian:e,isBigTiff:r}){const n=r?Number(oc(t,8,e)):lc(t,32,4,e),i=r?rf.BIG:rf.STANDARD;return t.slice(n+i)}(t,e),n=function(t,{isBigEndian:e,isBigTiff:r}){const n={};let i=t;for(;i?.length;){const t=lc(i,16,0,e),a=lc(i,16,2,e),o=r?Number(oc(i,4,e)):lc(i,32,4,e);if(0===t)break;if(1===o&&(a===tf.SHORT||a===tf.LONG||r&&a===tf.LONG8)){const o=r?12:8;n[t]=nf(i,a,o,e)}i=af(i,r)}return n}(r,e),i={height:n[Jc.HEIGHT],width:n[Jc.WIDTH],type:e.isBigTiff?"bigtiff":"tiff"};if(n[Jc.COMPRESSION]&&(i.compression=n[Jc.COMPRESSION]),!i.width||!i.height)throw new TypeError("Invalid Tiff. Missing tags");return i}};var lf={validate(t){const e="RIFF"===Wu(t,0,4),r="WEBP"===Wu(t,8,12),n="VP8"===Wu(t,12,15);return e&&r&&n},calculate(t){const e=Wu(t,12,16),r=t.slice(20,30);if("VP8X"===e){const t=r[0];if(!(192&t)&&!(1&t))return function(t){return{height:1+rc(t,7),width:1+rc(t,4)}}(r);throw new TypeError("Invalid WebP")}if("VP8 "===e&&47!==r[0])return function(t){return{height:16383&Ju(t,8),width:16383&Ju(t,6)}}(r);const n=Qu(r,3,6);if("VP8L"===e&&"9d012a"!==n)return function(t){return{height:1+((15&t[4])<<10|t[3]<<2|(192&t[2])>>6),width:1+((63&t[2])<<8|t[1])}}(r);throw new TypeError("Invalid WebP")}},uf=new Map([["bmp",fc],["cur",mc],["dds",gc],["gif",yc],["heif",wc],["icns",Tc],["ico",dc],["j2c",Nc],["jp2",Sc],["jpg",Dc],["jxl",Mc],["jxl-stream",Rc],["ktx",Uc],["png",jc],["pnm",qc],["psd",Hc],["svg",Qc],["tga",Kc],["tiff",sf],["webp",lf]]),cf=Array.from(uf.keys()),ff=new Map([[0,"heif"],[56,"psd"],[66,"bmp"],[68,"dds"],[71,"gif"],[73,"tiff"],[77,"tiff"],[82,"webp"],[105,"icns"],[137,"png"],[255,"jpg"]]);var pf={disabledTypes:[]};function hf(t){const e=function(t){const e=t[0],r=ff.get(e);return r&&uf.get(r).validate(t)?r:cf.find(e=>uf.get(e).validate(t))}(t);if(void 0!==e){if(pf.disabledTypes.indexOf(e)>-1)throw new TypeError(`disabled file type: ${e}`);const r=uf.get(e).calculate(t);if(void 0!==r){if(r.type=r.type??e,r.images&&r.images.length>1){const t=r.images.reduce((t,e)=>e.width*e.height>t.width*t.height?e:t,r.images[0]);r.width=t.width,r.height=t.height}return r}}throw new TypeError(`unsupported file type: ${e}`)}return async(e,r,n,i={})=>{let a=J(i,"widthMaxDef",null);et(a)||(a=1e3);let o=J(i,"heightMaxDef",null);et(o)||(o=1e3);let s=t.readFileSync(r),l=new or(s),u=new Yu({centered:!1,fileType:"tmerx",getImage:function(e,r){return t.readFileSync(e)},getSize:function(t,e,r){let n=J(i,`kpWidthMax.${r}`,null);et(n)||(n=a),n=ft(n);let s=J(i,`kpHeightMax.${r}`,null);et(s)||(s=o),s=ft(s);let l=hf(t),{width:u,height:c}=l,f=1;return(u>n||c>s)&&(f=Math.min(n/u,s/c),u*=f,c*=f),[u,c]}}),c=new nl(l,{modules:[u],delimiters:{start:"[[",end:"]]"}});c.setData(e);try{c.render()}catch(t){console.error(t)}let f=c.getZip().generate({type:"nodebuffer"});t.writeFileSync(n,f)}});
//# sourceMappingURL=w-tmper-docx.umd.js.map
